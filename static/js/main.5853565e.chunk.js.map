{"version":3,"sources":["components/ChartSelector/ChartSelector.module.scss","components/ParsingOptions/ParsingOptions.module.scss","components/DataLoader/loaders/LoadProject.module.scss","components/DataLoader/loaders/UploadFile.module.scss","components/InlineColorPicker/InlineColorPicker.module.scss","components/DataLoader/loaders/SparqlFetch.module.scss","components/ChartOptions/ChartOptions.module.scss","components/DataMapping/DataMapping.module.scss","components/DataGrid/DataGrid.module.scss","components/Header/Header.module.scss","components/Section/Section.module.scss","components/Footer/Footer.module.scss","components/DataSamples/DataSamples.module.scss","components/DataLoader/loaders/UrlFetch.module.scss","components/CopyToClipboardButton/style.module.css","components/DataLoader/DataLoader.module.scss","components/CustomChartLoader/CustomChartLoader.module.scss","HeaderItems.js","components/Header/Header.js","components/Section/Section.js","components/Footer/Footer.js","components/ScreenSizeAlert/ScreenSizeAlert.js","worker/index.js","hooks/useWindowSize.js","constants.js","worker/worker.js","hooks/useDataLoaderUtils/parser.js","hooks/useDataLoaderUtils/stack.js","hooks/useDataLoader.js","components/DataGrid/DataGrid.js","components/DataSamples/DataSamples.js","components/JsonViewer/JsonViewer.js","components/ParsingOptions/SeparatorSelector.js","components/ParsingOptions/ThousandsSeparatorSelector.js","components/ParsingOptions/DecimalsSeparatorSelector.js","components/ParsingOptions/DateLocaleSelector.js","components/ParsingOptions/StackSelector.js","components/DataLoader/loaders/UrlFetch.js","components/DataLoader/loaders/SparqlFetch.js","components/ParsingOptions/ParsingOptions.js","charts.js","components/DataLoader/loaders/LoadProject.js","components/DataLoader/loaders/Paste.js","components/DataLoader/loaders/UploadFile.js","components/DataLoader/loading.js","components/WarningMessage/WarningMessage.js","components/DataLoader/DataMismatchModal.js","components/CopyToClipboardButton/CopyToClipboardButton.js","hooks/useCopyToClipboard.js","components/DataLoader/DataLoader.js","components/ChartSelector/ChartSelector.js","components/DataMapping/ColumnCard.js","components/DataMapping/DataTypeIcon.js","components/DataMapping/asterisk.svg","components/DataMapping/RequiredIcon.js","components/DataMapping/ChartDimensionItem.js","components/DataMapping/ChartDimensionCard.js","components/DataMapping/DataMapping.js","components/ChartOptions/ChartOptionTypes/ChartOptionSelect.js","components/ChartOptions/ChartOptionTypes/ChartOptionNumber.js","components/ChartOptions/ChartOptionTypes/ChartOptionText.js","components/InlineColorPicker/InlineColorPicker.js","components/ChartOptions/ChartOptionTypes/ChartOptionColor.js","components/ChartOptions/ChartOptionTypes/ColorSchemePreview.js","components/ChartOptions/ChartOptionTypes/ColorSchemesDropDown.js","components/ChartOptions/ChartOptionTypes/ColorScaleUtils.js","hooks/usePrevious.js","components/ChartOptions/ChartOptionTypes/ChartOptionColorScale.js","components/ChartOptions/ChartOptionTypes/ChartOptionColorScaleDefault.js","components/ChartOptions/ChartOptionTypes/ChartOptionColorScaleWrapper.js","components/ChartOptions/ChartOptionTypes/ChartOptionBoolean.js","components/ChartOptions/ChartOptions.js","gaEvents.js","components/ChartPreview/ChartPreview.js","hooks/useDebounce.js","components/ChartPreviewWIthOptions/ChartPreviewWithOptions.js","components/Exporter/Exporter.js","hooks/rawRequire.js","hooks/useCustomCharts.js","hooks/useSafeCustomCharts.js","components/CustomChartLoader/CustomChartLoader.js","components/CustomChartWarnModal/CustomChartWarnModal.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","headerItems","label","slug","href","Header","menuItems","Navbar","bg","expand","sticky","className","styles","navbar","Brand","Toggle","Collapse","id","Nav","map","d","i","Link","role","target","rel","Section","props","Container","fluid","section","join","Row","Col","title","loading","Spinner","animation","variant","style","width","height","borderWidth","marginLeft","children","Footer","backgroundColor","footer","xs","sm","span","order","lg","offset","md","xl","ScreenSizeAlert","parsingWorker","mappingWorker","size","useState","undefined","windowSize","setWindowSize","useEffect","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","useWindowSize","showModal","setShowModal","modalWasClosed","setModalWasClosed","handleClose","Modal","show","onHide","backdrop","keyboard","centered","closeButton","Title","as","Body","Button","onClick","DateIcon","BsClock","NumberIcon","BsHash","StringIcon","BsType","dataTypeIcons","date","number","string","localeList","arEG","caES","csCZ","daDK","deCH","deDE","enCA","enGB","enUS","esES","esMX","faIR","fiFI","frCA","frFR","heIL","huHU","itIT","jaJP","koKR","mkMK","nbNO","nlNL","plPL","ptBR","ruRU","svSE","ukUA","zhCN","zhTW","separatorsLabels","separatorsList","Object","keys","AGGREGATIONS_LABELS","SCALES_LABELS","COLOR_SCHEMES_LABELS","Worker","SparqlMarker","Symbol","PARSERS","dataType","parse","data","opts","Error","dataString","trimmedDataString","trim","replace","JSON","separator","dsvFormat","candidates","parsed","length","push","score","e","sort","a","b","parseAndCheckData","parser","extra","parseData","isScalarType","item","includes","stackData","column","flatMap","record","key","others","omit","value","prop","DATA_LOADER_MODE","__cache","useDataLoader","userInput","setUserInput","dataSource","setDataSource","userData","setUserData","userDataType","setUserDataType","parseError","setParserError","unstackedInfo","setUnstackedInfo","setSeparator","thousandsSeparator","setThousandsSeparator","decimalsSeparator","setDecimalsSeparator","navigator","language","locale","setLocale","stackDimension","setStackDimension","setData","unstackedData","unstackedColumns","setLoading","mode","setMode","replaceRequiresConfirmation","setReplaceRequiresConfirmation","columnsTypes","dataTypes","parseDatasetAsyncAndSetData","useCallback","parsingOptions","Comlink","parseDataset","parseDatasetInWorker","dateLocale","get","then","resultData","catch","err","console","log","finally","parseDatasetSyncAndSetData","Promise","resolve","reject","parseDatasetAuto","parseDatasetAndSetData","reset","hydrateFromSavedProject","project","handleReplacingData","decimal","group","newDataInferred","errors","replacedData","oldColNames","newColNames","missingCols","difference","nextDataTypes","newData","stackedData","handleNewUserData","nextUserData","error","setUserDataAndDetect","str","source","options","parsedUserData","jsonPath","jsonData","Array","isArray","setJsonData","path","normalized","element","iterateElement","tmp","forEach","outElement","property","valueType","filter","nestedProperty","nestedValue","startDataReplace","cancelDataReplace","commitDataReplace","newSeparator","newThousandsSeparator","newDecimalSeparator","newLocale","dataset","coerceTypes","nextTypes","loadSample","rawData","sampleSeparator","type","handleInlineEdit","newDataset","handleStackOperation","resetDataLoader","dataLoaderMode","DATE_FORMATS","dateFormats","DateFormatSelector","React","forwardRef","ref","currentFormat","onChange","classNames","S","dateFmt","selected","stopPropagation","preventDefault","dateFormat","DataTypeSelector","typeDescriptor","currentType","onTypeChange","currentTypeComplete","dataTypeIconDomRef","useRef","showPicker","setShowPicker","handleTypeChange","newType","datatype","isEqual","handleTypeChangeDate","handleTargetClick","Icon","Overlay","current","placement","rootClose","rootCloseEvent","container","document","body","scheduleUpdate","arrowProps","outOfBoundaries","OverlayTrigger","overlay","trigger","triggerHandler","marginRight","fill","HeaderRenderer","sortColumn","sortDirection","_raw_datatype","_raw_coerceType","name","DataGrid","userDataset","onDataUpdate","setSort","keyedErrors","useMemo","keyBy","containerEl","idColumnWidth","Math","floor","log10","equalDinstribution","getBoundingClientRect","columnWidth","max","columns","headerRenderer","frozen","sortable","k","editable","formatter","row","_errors","toString","nextType","resizable","sortedDataset","datasetWithIds","_id","_stage3","sortColumnType","getTypeName","valueOf","localeCompare","reverse","handleSort","columnKey","direction","minColumnWidth","rows","rowHeight","onSort","onColumnResize","onRowsUpdate","update","action","fromRow","cellKey","updated","samplesList","category","url","delimiter","sourceName","sourceURL","DataSamples","onSampleReady","setLoadingError","select","sample","fetch","response","message","text","marginBottom","Card","JsonViewerRecursive","contextName","nestingLevel","context","selectFilter","onSelect","isSelectable","contextType","mouseOver","setMouseOver","classes","handleSelect","handleMouseOver","handleMouseOut","onMouseOver","onMouseOut","JsonViewer","SeparatorSelector","inputValue","handleChange","nextValue","formatValue","Dropdown","Menu","Item","ThousandsSeparatorSelector","DecimalsSeparatorSelector","DateLocaleSelector","StackSelector","list","nextDimension","disabled","fetchData","UrlFetch","initialState","setUrl","fetchUrl","handleSubmit","onSubmit","DEFAULT_PREFIXES","wd","wds","wdv","wdt","wikibase","p","ps","pq","rdfs","bd","wdref","psv","psn","pqv","pqn","pr","prv","prn","wdno","wdata","schema","rdf","owl","skos","xsd","prov","bds","gas","hint","sparqlGenerator","Generator","client","SimpleClient","endpointUrl","query","stringify","json","results","bindingsToJson","head","vars","bindings","SparqlFetch","parsedQuery","setParsedQuery","editorDomRef","initialQuery","onQueryParsed","evt","detail","queryType","onParserFailure","result","node","render","html","varNames","binding","variable","term","dataRefreshWorkers","fetchDataFromUrl","fetchDataFromSparql","dataRefreshCaptions","ParsingOptions","refreshData","dataRefreshImpl","onDataRefreshed","nextSeparator","nextLocale","color","dimensions","nextStackDimension","charts","alluvialdiagram","arcdiagram","barchart","barchartmultiset","barchartstacked","beeswarm","boxplot","bubblechart","bumpchart","calendarHeatmap","chorddiagram","circlepacking","circularDendrogram","contourPlot","convexHull","dendrogram","ganttChart","hexagonalBinning","horizongraph","linechart","matrixplot","parallelcoordinates","piechart","radarchart","sankeydiagram","slopechart","streamgraph","sunburst","treemap","violinplot","voronoidiagram","voronoitreemap","LoadProject","onProjectSelected","onDrop","acceptedFiles","reader","FileReader","deserializeProject","readAsText","useDropzone","accept","maxFiles","getRootProps","getInputProps","isDragReject","isDragAccept","dropzone","Paste","border","borderRadius","padding","minHeight","UploadFile","Loading","WarningMessage","Alert","DataMismatchModal","startsWith","split","CopyToClipboardButton","content","copyToClipboard","btn","createElement","display","appendChild","clipboard","ClipboardJS","focus","click","destroy","removeChild","pending","setPending","handleCopy","setTimeout","DataLoader","mainContent","hydrateFromProject","loadingError","initialOptionState","setInitialOptionState","loader","rawInput","icon","BsClipboard","allowedForReplace","BsUpload","BsGift","BsCloud","BsSearch","BsFolder","optionIndex","setOptionIndex","selectedOption","ctx","reloadRAW","location","pathname","copyToClipboardButton","tsvFormat","opt","classnames","active","c","dataSourceIndex","findIndex","successRows","parsingErrors","memo","filterCharts","metadata","categories","indexOf","ChartSelector","availableCharts","currentChart","setCurrentChart","onRemoveCustomChart","onAddChartClick","setFilter","handleFilterChange","nextFilter","nextCharts","charAt","toUpperCase","slice","uniq","flat","Img","src","thumbnail","Subtitle","Text","description","code","tutorial","customChart","rawCustomChart","backgroundImage","whiteSpace","position","top","right","maxWidth","overflow","textOverflow","ColumnCard","dimensionName","dimensionType","commitLocalMapping","rollbackLocalMapping","useDrag","collect","monitor","isDragging","end","dropResult","didDrop","drag","dimType","DataTypeIcon","_path","Tooltip","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgAsterisk","_ref","svgRef","titleId","xmlns","viewBox","ForwardRef","RequiredIcon","ChartDimensionItem","draggingColumn","index","isValid","columnId","dimension","aggregators","relatedAggregation","onMove","onChangeAggregation","onDeleteItem","onChangeDimension","replaceDimension","onInsertColumn","localMappding","useDrop","isOver","getItem","hover","multiple","hoverIndex","dimensionId","dragIndex","hoverBoundingRect","hoverMiddleY","bottom","hoverClientY","getClientOffset","y","drop","opacity","aggregation","aggregatorName","getAggregatorNames","emptyList","ChartDimensionCard","mapping","setMapping","draggingId","setDraggingId","defaulAggregation","getDefaultDimensionAggregation","columnDataType","validTypes","ids","concat","uniqueId","mappedType","config","setAggregation","newAggregations","idsMappedHere","columnsMappedHere","aggregationsMappedHere","nextConfig","col","j","newCol","arrayMove","nextId","arrayInsert","t","required","renderId","removeIndex","arrayReplace","arr","handleReplaceLocalMapping","prev","fromDimension","toDimension","fromIndex","toIndex","removedItem","newAggregation","moveFn","prevToMapping","toDimensionMapping","obj","DataMapping","setLocalMapping","updateMapping","mappingConf","isLocal","lastMapping","useImperativeHandle","clearLocalMapping","DndProvider","backend","HTML5Backend","columnName","ChartOptionSelect","defaultValue","default","stringValue","Number","option","isObject","ChartOptionNumber","isEnabled","step","min","n","parseFloat","isNaN","placeholder","ChartOptionText","InlineColorPicker","maybeColor","displayColorPicker","setDisplayColorPicker","swatch","background","popover","cover","disableAlpha","onChangeComplete","hex","ChartOptionColor","ColorSchemePreview","samples","scale","numSamples","ticks","domain","flex","ColorSchemesDropDown","interpolators","interpolator","setInterpolator","colorDataset","colorDataType","scaleType","currentFinalScale","paddingRight","intrplr","colorPresets","getPresetScale","getColorDomain","ResetBtn","resetScale","InvertBtn","invertScale","LockBtn","handleChangeLocked","locked","usePrevious","getDatePickerValue","userValue","userDomain","getValueType","toISOString","substring","ChartOptionColorScale","mappingValue","chart","mappedData","hasAnyMapping","initialValue","__loaded","setScaleType","defaultColor","colorFromDefault","setLocked","availableScaleTypes","getAvailableScaleTypes","setInterpolators","userRange","range","userValues","setUserValues","getCurrentFinalScale","userValuesForFinalScale","x","getColorScale","getDefaultUserValues","getInitialScaleValues","getUserValuesForFinalScale","values","currentUserValues","valuesForFinalScale","getDefaultColorScale","handleChangeValues","nextUserValues","userScaleValues","setUserValueRange","newUserValues","setUserValueDomain","handleChangeScaleType","nextScaleType","nextInterpolators","nextInterpolator","handleSetInterpolator","customUserValues","byDomain","v","nextLocked","reversedValues","invertedValues","prevMappingValue","marginTop","s","Date","ChartOptionColorScaleDefault","colorFromValue","setDefaultColor","handleChangeDefaultColor","nextDefaultColor","outScaleParams","ChartOptionColorScaleWrapper","ChartOptionBoolean","optionId","Form","Check","checked","CHART_OPTION_COMPONENTS","colorScale","boolean","getPartialMapping","repeatIndex","nv","getPartialMappedData","datum","getDefaultForRepeat","def","repeatDefault","WrapControlComponent","setVisualOptions","Component","remainingOptions","visualOptions","domainFromChart","handleControlChange","newValue","Fragment","ChartOptions","optionsConfig","getOptionsConfig","groups","collapseStatus","setCollapseStatus","enabledOptions","getEnabledOptions","optionsDefinitionsByGroup","reduce","acc","containerOptions","defaultOptionsValues","getDefaultOptionsValues","getContainerOptions","groupName","groupname","repeatFor","showLegend","prevChartIdRendered","ChartPreview","setError","setRawViz","domRef","vizOptionsDebounced","delay","debouncedValue","setDebouncedValue","handler","clearTimeout","useDebounce","currentlyMapped","requiredVariables","errorMessage","curr","firstChild","multivaluesVariables","minValues","chartMetadata","variableObj","find","viz","rawChart","rawViz","renderToDOM","gtag","event_category","ChartPreviewWithOptions","setMappingLoading","setMappedData","chartName","mapData","mapDataInWorker","downloadBlob","filename","download","Exporter","exportProject","downloadSvg","svgString","XMLSerializer","serializeToString","_node","DOMURL","URL","webkitURL","svg","Blob","createObjectURL","revokeObjectURL","downloadImage","format","canvas","clientHeight","clientWidth","getContext","img","Image","onload","drawImage","toDataURL","downloadProject","blob","setCurrentFormat","currentFile","setCurrentFile","downloadViz","_chartImplementation","event_label","InputGroup","DropdownButton","Append","NPM_CDN","queue","cacheChartsPkg","LRU","cacheDependenciesTree","DEPENDENCIES_ALIAS","d3","rawgraphsCore","requireDependency","sUrl","has","requireFromUrl","set","defineDOM","params","factory","dependencies","rutimeDepenciesPromises","dep","all","rutimeDepencies","outFactory","requireDependencyWebWorker","requireFromUrlWebWorker","defineWebWorker","define","scriptTag","async","promiseFinalExports","pop","remove","once","append","isRawChartLike","requireRawChartsFromUrl","daExports","self","importScripts","amd","STORE_NS","getNextCustomChartsAndReleased","prevCharts","newChartsToInject","newIds","releasedCustomCharts","prevChart","shouldBeReleased","storeCustomCharts","nextCustomCharts","toStoreCustomCharts","localStorage","setItem","caches","open","cache","nextHashses","Boolean","cacheKeys","currentHashses","toRemoveHashes","hash","delete","makeFileHash","file","event","sha3_512","readAsArrayBuffer","loadStoredCustomCharts","storedCustomCharts","match","m","packs","packsToLoad","nChars","o","loadedChartsById","exportCustomChart","HOSTS_WHITELIST","isUrlAllowed","hostname","UserAbortError","args","isAbortByUser","useSafeCustomCharts","storage","customCharts","setCustomCharts","loadCustomChartsFromUrlAsSource","loadCustomChartsFromUrl","loadCustomChartsFromNpm","uploadCustomCharts","fileHash","put","Response","importCustomChartFromProject","projectChart","File","newChart","removeCustomChart","useCustomCharts","unsafeUploadCustomCharts","unsafeLoadCustomChartsFromNpm","unsafeLoadCustomChartsFromUrl","unsafeImportCustomChartFromProject","methods","toConfirmCustomChart","setToConfirmCustomChartLoad","parsedUrl","String","inputName","askConfirm","confirmCustomChartLoad","abortCustomChartLoad","LoadFromFile","load","dropin","LoadFromString","setValue","CustomChartLoaderForm","onClose","setType","handleError","changeImportType","loadingOption","pkg","CustomChartLoader","isOpen","contentClassName","CustomChartWarnModal","App","baseCharts","dataLoader","mappingLoading","dataMappingRef","columnNames","prevColumnNames","lasImportProjectRef","importProject","projectUrl","projectUrlStr","URLSearchParams","search","r","ok","projectStr","lastImportProject","currentCustom","handleChartChange","nextChart","serializeProject","fromUrl","nextCurrentChart","history","replaceState","patchedOptions","isPlainObject","isModalCustomChartOpen","setModalCustomChartOpen","toggleModalCustomChart","HeaderItems","buttonText","buttonStyle","fontSize","buttonClasses","acceptOnScroll","ReactDOM","StrictMode","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5853565e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"thumbnail\":\"ChartSelector_thumbnail__1xQ_-\",\"currentChart\":\"ChartSelector_currentChart__NKILM\",\"disabled\":\"ChartSelector_disabled__MRXKu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"parsingOptions\":\"ParsingOptions_parsingOptions__K4kyV\",\"refresh-button\":\"ParsingOptions_refresh-button__3TkLa\",\"separator-preview\":\"ParsingOptions_separator-preview__1UuQv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropzone\":\"LoadProject_dropzone__6a5Ft\",\"reject\":\"LoadProject_reject__1NjN5\",\"accept\":\"LoadProject_accept__1a3qM\",\"browse-button\":\"LoadProject_browse-button__Kvg8t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropzone\":\"UploadFile_dropzone__1h-vB\",\"reject\":\"UploadFile_reject__2Kpgt\",\"accept\":\"UploadFile_accept__3mK1X\",\"browse-button\":\"UploadFile_browse-button__2AUZ1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"swatch\":\"InlineColorPicker_swatch__11WDP\",\"color\":\"InlineColorPicker_color__12j-E\",\"popover\":\"InlineColorPicker_popover__3Hchl\",\"cover\":\"InlineColorPicker_cover__2KTIs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"url-input\":\"SparqlFetch_url-input__1OTEr\",\"query-input-here\":\"SparqlFetch_query-input-here__1GTNa\",\"base-iri-input-here\":\"SparqlFetch_base-iri-input-here__1MbOa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chart-options\":\"ChartOptions_chart-options__3l80N\",\"chart-option\":\"ChartOptions_chart-option__AxfdW\",\"color-swatch\":\"ChartOptions_color-swatch__2yOSf\",\"color-scale-item\":\"ChartOptions_color-scale-item__3Rhfd\",\"ordinal\":\"ChartOptions_ordinal__2mFUI\",\"not-ordinal\":\"ChartOptions_not-ordinal__3DrFs\",\"color-swatches-list\":\"ChartOptions_color-swatches-list__2EQnZ\",\"options-group\":\"ChartOptions_options-group__3Zauh\",\"group-header\":\"ChartOptions_group-header__1X0bJ\",\"collapsed\":\"ChartOptions_collapsed__pl7d6\",\"collapse-button\":\"ChartOptions_collapse-button__rUqFX\",\"color-scheme-dropdown-item\":\"ChartOptions_color-scheme-dropdown-item__1zRUD\",\"scheme-preview\":\"ChartOptions_scheme-preview__f1lz2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"column-card\":\"DataMapping_column-card__2VBWp\",\"column-title\":\"DataMapping_column-title__2yLXi\",\"data-type-icon\":\"DataMapping_data-type-icon__fdfcN\",\"chart-dimension\":\"DataMapping_chart-dimension__2tNga\",\"chart-dimension-header\":\"DataMapping_chart-dimension-header__3FrwJ\",\"accepted-type-icon\":\"DataMapping_accepted-type-icon__3XRr1\",\"dimension-required\":\"DataMapping_dimension-required__1FreW\",\"assigned-column\":\"DataMapping_assigned-column__3S8Vu\",\"column-valid\":\"DataMapping_column-valid__1wlKa\",\"column-invalid\":\"DataMapping_column-invalid__3g-BT\",\"remove-assigned\":\"DataMapping_remove-assigned__3VE_f\",\"dropzone\":\"DataMapping_dropzone__2L06t\",\"active\":\"DataMapping_active__NdQHM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"data-type-selector\":\"DataGrid_data-type-selector__2on-B\",\"data-type-selector-item\":\"DataGrid_data-type-selector-item__3xB1K\",\"selected\":\"DataGrid_selected__iVbJn\",\"date-format-preview\":\"DataGrid_date-format-preview__f5V3s\",\"data-type-selector-trigger\":\"DataGrid_data-type-selector-trigger__1yAyi\",\"date-format-selector\":\"DataGrid_date-format-selector__19SHO\",\"date-format-selector-entry\":\"DataGrid_date-format-selector-entry__3kPs-\",\"parent-type-selector\":\"DataGrid_parent-type-selector__8RCk2\",\"column-name\":\"DataGrid_column-name__q_QPq\",\"has-error\":\"DataGrid_has-error__jgPR1\",\"raw-col-header\":\"DataGrid_raw-col-header__2fXsy\",\"unsorted\":\"DataGrid_unsorted__2dx3u\",\"acs\":\"DataGrid_acs__-kgxx\",\"desc\":\"DataGrid_desc__2WpaO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navbar\":\"Header_navbar__359Kr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"section\":\"Section_section__2mYr1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"footer\":\"Footer_footer__7dIj9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dataset-source\":\"DataSamples_dataset-source__1NwGz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"url-input\":\"UrlFetch_url-input__3vKK2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"copy-to-clipboard-button\":\"style_copy-to-clipboard-button__29IxT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-option\":\"DataLoader_loading-option__Spa1h\",\"disabled\":\"DataLoader_disabled__3RVvn\",\"active\":\"DataLoader_active__-mHU8\",\"start-over\":\"DataLoader_start-over__3fWNA\",\"cancel\":\"DataLoader_cancel__22q8c\",\"loading-component\":\"DataLoader_loading-component__1zOap\",\"bg-animated\":\"DataLoader_bg-animated__1j4Qa\",\"bg-animation\":\"DataLoader_bg-animation__12elS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loadingOption\":\"CustomChartLoader_loadingOption__1vYQM\",\"disabled\":\"CustomChartLoader_disabled__1vBSV\",\"active\":\"CustomChartLoader_active__2XtZG\",\"dropzone\":\"CustomChartLoader_dropzone__S5GVb\",\"dropin\":\"CustomChartLoader_dropin__1VOM0\",\"reject\":\"CustomChartLoader_reject__8aMxD\",\"accept\":\"CustomChartLoader_accept__J_4Ap\",\"browse-button\":\"CustomChartLoader_browse-button__ZAvJI\"};","const headerItems = [\n  {\n    label: 'About',\n    slug: 'about',\n    href: 'https://rawgraphs.io/about',\n  },\n  // {\n  //   label: 'Gallery',\n  //   slug: 'gallery',\n  //   href: 'https://rawgraphs.io/gallery',\n  // },\n  {\n    label: 'Learning',\n    slug: 'learning',\n    href: 'https://rawgraphs.io/learning',\n  },\n  // {\n  //   label: 'FAQs',\n  //   slug: 'faqs',\n  //   href: 'https://github.com/rawgraphs/raw/wiki/FAQs',\n  // },\n  // {\n  //   label: \"RAWGraphs 1.3\",\n  //   slug: 'rawgraphs-1-3',\n  //   href: 'https://app.rawgraphs.io',\n  // },\n  {\n    label: 'GitHub',\n    slug: 'github',\n    href: 'https://github.com/rawgraphs/rawgraphs-app',\n  },\n]\n\nexport default headerItems\n","import React from 'react'\nimport styles from './Header.module.scss'\nimport { Navbar, Nav } from 'react-bootstrap'\n\nexport default function Header({ menuItems }) {\n  return (\n    <Navbar bg=\"white\" expand=\"lg\" sticky=\"top\" className={styles.navbar}>\n      <Navbar.Brand href=\"/\"><b>RAW</b><span className=\"text-primary\">Graphs</span> 2.0 beta</Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav className=\"ml-auto\">\n          {menuItems.map((d, i) => {\n            return (\n              <Nav.Link key={'item' + i} href={d.href}>\n                {d.label}\n              </Nav.Link>\n            )\n          })}\n          <a\n            role=\"button\"\n            href=\"https://github.com/rawgraphs/rawgraphs-app/issues\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"btn btn-sm btn-primary ml-2 d-flex flex-column align-items-center justify-content-center\"\n          >\n            Report issue\n          </a>\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n  )\n}\n","import React from 'react'\nimport styles from './Section.module.scss'\nimport { Container, Row, Col, Spinner } from 'react-bootstrap'\n\nexport default function Section(props) {\n  return (\n    <Container\n      fluid\n      className={\n        [styles.section, props.className].join(' ')\n      }\n    >\n      <Row>\n        <Col>\n          <div className=\"d-flex align-items-center mb-3\">\n            <h1>{props.title}</h1>\n            { props.loading && <Spinner animation=\"border\" variant=\"primary\" style={{width:'2rem', height:'2rem',borderWidth:'2px',marginLeft:'2rem'}} />}\n          </div>\n          \n          {props.children}\n        </Col>\n      </Row>\n    </Container>\n  )\n}\n","import React from 'react'\nimport styles from './Footer.module.scss'\nimport { Row, Col, Container } from 'react-bootstrap'\nimport { BsFillEnvelopeFill, BsBarChartFill } from 'react-icons/bs'\nimport { FaTwitter, FaGithub } from 'react-icons/fa'\n\n// #TODO add commit hash\n// const commitHash = process.env.REACT_APP_VERSION || 'dev'\n\nexport default function Footer(props) {\n  return (\n    <Container fluid style={{ backgroundColor: 'var(--dark)' }}>\n      <Container className={styles.footer}>\n        <Row>\n          <Col xs={6} sm={{ span: 5, order: 1 }} lg={{ span: 3, order: 1 }}>\n            <p className=\"Xsmall\">\n              RAWGraphs is an open source project designed and developed by{' '}\n              <a\n                href=\"http://densitydesign.org/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                DensityDesign\n              </a>\n              ,{' '}\n              <a\n                href=\"https://calib.ro/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Calibro\n              </a>{' '}\n              and{' '}\n              <a\n                href=\"https://inmagik.com/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Inmagik\n              </a>\n              .\n              <br />© 2013-2021{' '}\n              <a href=\"https://raw.github.com/rawgraphs/rawgraphs-app/master/LICENSE\">\n                (Apache License 2.0)\n              </a>\n            </p>\n          </Col>\n          <Col xs={6} sm={{ span: 5, order: 3 }} lg={{ span: 3, order: 1 }}>\n            <p className=\"Xsmall\"></p>\n          </Col>\n          {/* <Col xs={6} sm={{span:5, order:3}} lg={{span:3,order:1}}><p className=\"Xsmall\">This <span title={commitHash}>version</span> is intended to be available only for the backers of the crowdfunding campaign.</p></Col> */}\n          <Col\n            xs={6}\n            sm={{ span: 6, offset: 1, order: 2 }}\n            md={{ span: 3 }}\n            lg={{ offset: 0 }}\n            xl={{ span: 2, offset: 2 }}\n          >\n            <p>\n              <BsFillEnvelopeFill /> hello at rawgraphs.io\n            </p>\n            <p>\n              <FaTwitter />{' '}\n              <a\n                href=\"https://twitter.com/rawgraphs\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                @rawgraphs\n              </a>\n            </p>\n          </Col>\n          <Col\n            xs={6}\n            sm={{ span: 6, offset: 1, order: 4 }}\n            md={{ span: 2 }}\n            lg={{ offset: 0 }}\n            xl={{ span: 2, offset: 0 }}\n          >\n            <p>\n              <FaGithub />{' '}\n              <a\n                href=\"https://github.com/rawgraphs\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Github\n              </a>\n            </p>\n            <p>\n              <BsBarChartFill />{' '}\n              <a\n                href=\"https://old.rawgraphs.io\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                RAWGraphs v.1\n              </a>\n            </p>\n          </Col>\n        </Row>\n      </Container>\n    </Container>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport useWindowSize from '../../hooks/useWindowSize'\nimport { Modal, Button } from 'react-bootstrap'\nimport { BsEnvelopeFill } from 'react-icons/bs'\n\n// import styles from './ScreenSizeAlert.module.scss'\n\nfunction ScreenSizeAlert() {\n  const size = useWindowSize()\n  const [showModal, setShowModal] = useState(size.width < 992)\n  const [modalWasClosed, setModalWasClosed] = useState(false)\n\n  const handleClose = () => {\n    setShowModal(false)\n    setModalWasClosed(true)\n  }\n\n  useEffect(() => {\n    if (modalWasClosed === false) {\n      setShowModal(size.width < 992)\n    }\n  }, [modalWasClosed, size])\n\n  return (\n    <Modal\n      className=\"raw-modal\"\n      show={showModal}\n      onHide={handleClose}\n      backdrop=\"static\"\n      keyboard={false}\n      // size=\"lg\"\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      centered\n    >\n      <Modal.Header closeButton>\n        <Modal.Title as=\"h5\">\n          <span role=\"img\" aria-label=\"Party icon\">\n            🎉\n          </span>{' '}\n          Welcome to the new RAWGraphs!\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <p className=\"big\">\n          RAWGraphs 2.0 is designed for {size.width >= 768 ? 'slightly ' : ' '}\n          bigger screens!\n        </p>\n        <p>\n          Resize your browser window or{' '}\n          <a href=\"mailto:?subject=Visit+RAWGraphs+2.0&body=Hello%21%0D%0APlease+do+not+forget+to+take+a+look+at+the+new+version+of+RAWGraphs%21%0D%0A%0D%0AVisit%3A+https%3A%2F%2Fdev.rawgraphs.io%2F%0D%0A%0D%0ASee+you+later%2C%0D%0AThe+RAWGraphs+Team\">\n            <BsEnvelopeFill /> send yourself a reminder\n          </a>{' '}\n          to come back at a better time.\n        </p>\n        <p>Touch devices are not fully supported yet.</p>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"primary\" onClick={handleClose}>\n          Got it!\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nexport default ScreenSizeAlert\n","import * as Comlink from 'comlink'\n/* eslint-disable import/no-webpack-loader-syntax */\nimport Worker from 'worker-loader!./worker'\n\nlet parsingWorker // = new Worker()\n\nexport function parseDatasetInWorker(data, dataTypes, parsingOptions) {\n  // TODO: Check lazy loading vs terminate on each time\n  if (!parsingWorker) {\n    parsingWorker = new Worker()\n  }\n  let obj = Comlink.wrap(parsingWorker)\n  let out = obj.parseDataset(data, dataTypes, parsingOptions)\n  return out\n}\n\nlet mappingWorker // = new Worker()\n\nexport function mapDataInWorker(\n  chartName,\n  { data, mapping, visualOptions, dataTypes },\n  customChart\n) {\n  // TODO: Check lazy loading vs terminate on each time\n  if (!mappingWorker) {\n    mappingWorker = new Worker()\n  }\n  let obj = Comlink.wrap(mappingWorker)\n  let out = obj.mapData(\n    chartName,\n    { data, mapping, visualOptions, dataTypes },\n    customChart\n  )\n  return out\n}\n","import { useEffect, useState } from 'react'\n\n// Hook\nexport default function useWindowSize() {\n  // Initialize state with undefined width/height so server and client renders match\n  // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n  const [windowSize, setWindowSize] = useState({\n    width: undefined,\n    height: undefined,\n  });\n\n  useEffect(() => {\n    // Handler to call on window resize\n    function handleResize() {\n      // Set window width/height to state\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      });\n    }\n    \n    // Add event listener\n    window.addEventListener(\"resize\", handleResize);\n    \n    // Call handler right away so state gets updated with initial window size\n    handleResize();\n    \n    // Remove event listener on cleanup\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []); // Empty array ensures that effect is only run on mount\n\n  return windowSize;\n}\n\n","// import React from \"react\"\nimport { BsClock, BsHash, BsType } from 'react-icons/bs'\nimport arEG from 'd3-time-format/locale/ar-EG.json'\nimport caES from 'd3-time-format/locale/ca-ES.json'\nimport csCZ from 'd3-time-format/locale/cs-CZ.json'\nimport daDK from 'd3-time-format/locale/da-DK.json'\nimport deCH from 'd3-time-format/locale/de-CH.json'\nimport deDE from 'd3-time-format/locale/de-DE.json'\nimport enCA from 'd3-time-format/locale/en-CA.json'\nimport enGB from 'd3-time-format/locale/en-GB.json'\nimport enUS from 'd3-time-format/locale/en-US.json'\nimport esES from 'd3-time-format/locale/es-ES.json'\nimport esMX from 'd3-time-format/locale/es-MX.json'\nimport faIR from 'd3-time-format/locale/fa-IR.json'\nimport fiFI from 'd3-time-format/locale/fi-FI.json'\nimport frCA from 'd3-time-format/locale/fr-CA.json'\nimport frFR from 'd3-time-format/locale/fr-FR.json'\nimport heIL from 'd3-time-format/locale/he-IL.json'\nimport huHU from 'd3-time-format/locale/hu-HU.json'\nimport itIT from 'd3-time-format/locale/it-IT.json'\nimport jaJP from 'd3-time-format/locale/ja-JP.json'\nimport koKR from 'd3-time-format/locale/ko-KR.json'\nimport mkMK from 'd3-time-format/locale/mk-MK.json'\nimport nbNO from 'd3-time-format/locale/nb-NO.json'\nimport nlNL from 'd3-time-format/locale/nl-NL.json'\nimport plPL from 'd3-time-format/locale/pl-PL.json'\nimport ptBR from 'd3-time-format/locale/pt-BR.json'\nimport ruRU from 'd3-time-format/locale/ru-RU.json'\nimport svSE from 'd3-time-format/locale/sv-SE.json'\nimport ukUA from 'd3-time-format/locale/uk-UA.json'\nimport zhCN from 'd3-time-format/locale/zh-CN.json'\nimport zhTW from 'd3-time-format/locale/zh-TW.json'\n\n// // creplaced with the following\n// export const DATATYPE_ICONS = {\n//   'date': <BsClock />,\n//   'number': <BsHash />,\n//   'string': <BsType />\n// }\n\nexport const DateIcon = BsClock\nexport const NumberIcon = BsHash\nexport const StringIcon = BsType\n\nexport const dataTypeIcons = {\n  date: DateIcon,\n  number: NumberIcon,\n  string: StringIcon,\n}\n\nexport const localeList = {\n  'ar-EG': arEG,\n  'ca-ES': caES,\n  'cs-CZ': csCZ,\n  'da-DK': daDK,\n  'de-CH': deCH,\n  'de-DE': deDE,\n  'en-CA': enCA,\n  'en-GB': enGB,\n  'en-US': enUS,\n  'es-ES': esES,\n  'es-MX': esMX,\n  'fa-IR': faIR,\n  'fi-FI': fiFI,\n  'fr-CA': frCA,\n  'fr-FR': frFR,\n  'he-IL': heIL,\n  'hu-HU': huHU,\n  'it-IT': itIT,\n  'ja-JP': jaJP,\n  'ko-KR': koKR,\n  'mk-MK': mkMK,\n  'nb-NO': nbNO,\n  'nl-NL': nlNL,\n  'pl-PL': plPL,\n  'pt-BR': ptBR,\n  'ru-RU': ruRU,\n  'sv-SE': svSE,\n  'uk-UA': ukUA,\n  'zh-CN': zhCN,\n  'zh-TW': zhTW,\n}\n\nexport const WEBWORKER_ACTIVE = true\n\nexport const separatorsLabels = {\n  '\\\\t': 'Tab',\n  ';': 'Semicolon',\n  ',': 'Comma',\n  '|': 'Pipe',\n}\n\nexport const separatorsList = Object.keys(separatorsLabels)\n\nexport const DefaultSeparator = \",\"\n\nexport const AGGREGATIONS_LABELS = {\n  \"count\": \"Count\",\n  \"mean\": \"Average\",\n  \"median\": \"Median\",\n  \"max\": \"Max\",\n  \"min\": \"Min\",\n  \"countDistinct\": \"Count unique\",\n  \"sum\": \"Sum\",\n  \"csv\": \"CSV\",\n  \"csvDistinct\": \"CSV (unique)\",\n}\n\nexport const SCALES_LABELS = {\n  \"sequential\": \"Sequential\",\n  \"diverging\": \"Diverging\",\n  \"ordinal\": \"Ordinal\"\n}\n\nexport const COLOR_SCHEMES_LABELS = {\n  \"interpolateBlues\": \"Blue sequential\",\n  \"interpolateGreens\": \"Green sequential\",\n  \"interpolateReds\": \"Red sequential\",\n  \"interpolateRdBu\": \"RdBu diverging\",\n  \"interpolateBrBG\": \"BrBG diverging\",\n  \"interpolatePiYG\": \"PiYG diverging\",\n  \"schemeCategory10\": \"Categorical 10\",\n  \"interpolateTurbo\": \"Turbo discrete\",\n  \"interpolateSpectral\": \"Spectral discrete\"\n}","export default function() {\n  return new Worker(__webpack_public_path__ + \"static/js/worker.62aaeb05.worker.js\");\n}\n","import { dsvFormat } from 'd3'\nimport { DefaultSeparator, separatorsList } from '../../constants'\n\nfunction JsonParser(dataString) {\n  //Removing white lines (useful when pasting from sheets, ecc)\n  const trimmedDataString = dataString\n    .trim()\n    .replace(/^(?=\\n)$|^\\s*|\\s*$|\\n\\n+/gm, '')\n  \n  return [JSON.parse(trimmedDataString), {}]\n}\n\nfunction CsvParser(dataString, opts) {\n  //Removing white lines (useful when pasting from sheets, ecc)\n  const trimmedDataString = dataString\n    .trim()\n    .replace(/^(?=\\n)$|^\\s*|\\s*$|\\n\\n+/gm, '')\n  \n  // Use the separator the user gives me, if any\n  if (opts.separator) {\n    return [\n      dsvFormat(opts.separator).parse(trimmedDataString),\n      {\n        separator: opts.separator,\n      },\n    ]\n  }\n  // Otherwise, try to infer it\n  const candidates = []\n  for (const _separator of separatorsList) {\n    const separator = _separator\n      .replace(/\\\\r/g, '\\r')\n      .replace(/\\\\n/g, '\\n')\n      .replace(/\\\\t/g, '\\t')\n    try {\n      const parser = dsvFormat(separator)\n      const parsed = parser.parse(trimmedDataString)\n      if (\n        (parsed.length > 0 && Object.keys(parsed[0]).length > 1) ||\n        separator === DefaultSeparator\n      ) {\n        candidates.push({\n          separator,\n          score: Object.keys(parsed[0]).length,\n          parsed,\n        })\n      }\n    } catch (e) {}\n  }\n  candidates.sort((a, b) => b.score - a.score)\n  return [candidates[0].parsed, { separator: candidates[0].separator }]\n}\n\nexport const SparqlMarker = Symbol(\"RawgraphsSparqlMarker\")\n\nfunction SparqlParser(data, opts) {\n  if (data[SparqlMarker] === true) {\n    return [data, {}]\n  } \n  throw new Error(\"Not a sparql result\")\n}\n\nconst PARSERS = [\n  { dataType: 'sparql', parse: SparqlParser },\n  { dataType: 'json', parse: JsonParser },\n  { dataType: 'csv', parse: CsvParser },\n]\n\nexport function parseData(data, opts) {\n  for (const parser of PARSERS) {\n    try {\n      const [parsed, extra] = parser.parse(data, opts)\n      return [parser.dataType, parsed, extra]\n    } catch (e) {\n      // console.error('Parsing error', e)\n    }\n  }\n  return [null, null]\n}\n\nexport function parseAndCheckData(dataString, opts) {\n  const [dataType, data, extra] = parseData(dataString, opts)\n  if (dataType === null) {\n    // This should never happen\n    return [\n      dataType,\n      data,\n      'Cannot parse dataset! (This should never happen)',\n      {},\n    ]\n  } else {\n    if (dataType === 'json') {\n      return ['json', data, null, extra]\n    } else if (data.length > 0) {\n      return [dataType, data, null, extra]\n    } else {\n      return [null, null, \"We can't parse your data.\", {}]\n    }\n  }\n}\n\nfunction isScalarType(item) {\n  return ['string', 'number', 'boolean'].includes(typeof item)\n}\n\nexport function normalizeJsonArray(jsonArray) {\n  return jsonArray\n    .map((element) => {\n      let iterateElement = element\n      if (Array.isArray(iterateElement)) {\n        const tmp = {}\n        iterateElement.forEach((item, i) => {\n          tmp[`Column ${i + 1}`] = item\n        })\n        iterateElement = tmp\n      }\n      if (isScalarType(iterateElement) || iterateElement === null) {\n        iterateElement = { value: iterateElement }\n      }\n      const outElement = {}\n      for (const property in iterateElement) {\n        const value = iterateElement[property]\n        const valueType = typeof value\n        if (Array.isArray(value)) {\n          outElement[property] = value.filter(isScalarType).join(' ')\n        } else if (valueType === 'object' && valueType !== null) {\n          for (const nestedProperty in value) {\n            const nestedValue = value[nestedProperty]\n            if (isScalarType(nestedValue)) {\n              outElement[`${property}.${nestedProperty}`] = nestedValue\n            }\n          }\n        } else if (isScalarType(value)) {\n          outElement[property] = value\n        }\n      }\n      return outElement\n    })\n    .filter((item) => item !== null)\n}\n","import { flatMap, omit, map } from 'lodash'\n\nexport function stackData(data, column) {\n  return flatMap(data, (record) => {\n    const key = record[column]\n    const others = omit(record, column)\n    return map(others, (value, prop) => {\n      return {\n        [column]: key,\n        column: prop,\n        value,\n      }\n    })\n  })\n}\n","import { parseDataset } from '@rawgraphs/rawgraphs-core'\nimport { difference, get } from 'lodash'\nimport { useCallback, useState } from 'react'\nimport { DefaultSeparator, localeList, WEBWORKER_ACTIVE } from '../constants'\nimport { parseDatasetInWorker } from '../worker'\nimport {\n  normalizeJsonArray,\n  parseAndCheckData,\n} from './useDataLoaderUtils/parser'\nimport { stackData } from './useDataLoaderUtils/stack'\n\nexport const DATA_LOADER_MODE = {\n  DIRECT: 'direct',\n  REPLACE: 'replace',\n}\n\nconst __cache = {}\n\nexport default function useDataLoader() {\n  /* Data to be plot in the chart */\n  /* First stage: raw user input */\n  const [userInput, setUserInput] = useState('')\n  const [dataSource, setDataSource] = useState(null)\n\n  /* Second stage: parsed data and user data type (i.e. csv, json, ...) */\n  /*\n   * In case user data type is json, userData is not filled immediately.\n   * Instead, a JSON view is first shown asking the user to select an\n   * array inside the JSON tree. The (parsed) content of the array will\n   * be used to fill `userData`. In case of some error during parsing,\n   * the `parseError` state holds the error description\n   */\n  const [userData, setUserData] = useState(null)\n  const [userDataType, setUserDataType] = useState(null)\n  const [parseError, setParserError] = useState(null)\n  const [unstackedInfo, setUnstackedInfo] = useState([null, null])\n\n  /* Data Parsing Options */\n  const [separator, setSeparator] = useState(DefaultSeparator)\n  const [thousandsSeparator, setThousandsSeparator] = useState(',')\n  const [decimalsSeparator, setDecimalsSeparator] = useState('.')\n  const [locale, setLocale] = useState(navigator.language || 'en-US')\n  const [stackDimension, setStackDimension] = useState()\n\n  /* Third stage: data ready to become a chart */\n  const [data, setData] = useState(null)\n\n  /* Stack operations */\n  const [unstackedData, unstackedColumns] = unstackedInfo\n\n  /* Misc */\n  const [loading, setLoading] = useState(false)\n  const [mode, setMode] = useState(DATA_LOADER_MODE.DIRECT)\n  const [\n    replaceRequiresConfirmation,\n    setReplaceRequiresConfirmation,\n  ] = useState(undefined)\n\n  /* Unpacking */\n  const columnsTypes = unstackedColumns ?? data?.dataTypes\n\n  //wrapper for async parse via web worker\n  const parseDatasetAsyncAndSetData = useCallback(\n    (data, dataTypes, parsingOptions) => {\n      setLoading(true)\n      return parseDatasetInWorker(data, dataTypes, {\n        ...parsingOptions,\n        dateLocale: get(localeList, parsingOptions.locale),\n      })\n        .then((resultData) => {\n          return resultData\n        })\n        .catch((err) => {\n          console.log('eee', err)\n        })\n        .finally(() => {\n          setLoading(false)\n        })\n    },\n    [setLoading]\n  )\n\n  const parseDatasetSyncAndSetData = useCallback(\n    (data, dataTypes, parsingOptions) => {\n      setLoading(true)\n      return new Promise((resolve, reject) => {\n        try {\n          const resultData = parseDataset(data, dataTypes, {\n            ...parsingOptions,\n            dateLocale: get(localeList, parsingOptions.locale),\n          })\n          resolve(resultData)\n        } catch (e) {\n          reject(e)\n        } finally {\n          setLoading(false)\n        }\n      })\n    },\n    [setLoading]\n  )\n\n  const parseDatasetAuto = useCallback(\n    (data, dataTypes, parsingOptions) => {\n      const worker = WEBWORKER_ACTIVE\n        ? parseDatasetAsyncAndSetData\n        : parseDatasetSyncAndSetData\n      return worker(data, dataTypes, parsingOptions)\n    },\n    [parseDatasetAsyncAndSetData, parseDatasetSyncAndSetData]\n  )\n\n  const parseDatasetAndSetData = useCallback(\n    (data, dataTypes, parsingOptions) => {\n      return parseDatasetAuto(data, dataTypes, parsingOptions).then((data) =>\n        setData(data)\n      )\n    },\n    [parseDatasetAuto]\n  )\n\n  const reset = useCallback(() => {\n    setData(null)\n    setUserData(null)\n    setUserDataType(null)\n    setUserInput('')\n    setDataSource(null)\n    setParserError(null)\n    setStackDimension(null)\n    setUnstackedInfo([null, null])\n  }, [])\n\n  const hydrateFromSavedProject = useCallback(\n    (project) => {\n      const {\n        userInput,\n        userData,\n        userDataType,\n        parseError,\n        unstackedColumns,\n        unstackedData,\n        dataTypes,\n        separator,\n        thousandsSeparator,\n        decimalsSeparator,\n        locale,\n        stackDimension,\n        dataSource,\n      } = project\n      setUserInput(userInput)\n      setUserDataType(userDataType)\n      setSeparator(separator)\n      setThousandsSeparator(thousandsSeparator)\n      setDecimalsSeparator(decimalsSeparator)\n      setLocale(locale)\n      setStackDimension(stackDimension)\n      setDataSource(dataSource)\n      setUserData(userData)\n      setParserError(parseError)\n      setUnstackedInfo([unstackedData, unstackedColumns])\n      parseDatasetAndSetData(userData, dataTypes, {\n        thousandsSeparator,\n        decimalsSeparator,\n        locale,\n      })\n    },\n    [parseDatasetAndSetData]\n  )\n\n  const handleReplacingData = useCallback(\n    (userData) => {\n      parseDatasetAuto(userData, undefined, {\n        locale,\n        decimal: decimalsSeparator,\n        group: thousandsSeparator,\n      }).then((newDataInferred) => {\n        if (newDataInferred.errors.length > 0) {\n          // Parsing resulted in errors, cannot replace data safely!\n          __cache.replacedData = newDataInferred\n          setReplaceRequiresConfirmation('parse-error')\n        } else {\n          const oldColNames = Object.keys(columnsTypes)\n          const newColNames = Object.keys(newDataInferred.dataTypes)\n          const missingCols = difference(oldColNames, newColNames)\n          if (missingCols.length > 0) {\n            // There is at least one column missing in the new dataset\n            // Replace cannot be safe\n            __cache.replacedData = newDataInferred\n            setReplaceRequiresConfirmation('missing-column:' + missingCols[0])\n          } else {\n            const nextDataTypes = {\n              ...newDataInferred.dataTypes,\n              ...columnsTypes, // Keep eventual overrides in data types\n            }\n            parseDatasetAuto(userData, nextDataTypes, {\n              locale,\n              decimal: decimalsSeparator,\n              group: thousandsSeparator,\n            }).then((newData) => {\n              if (newData.errors.length > 0) {\n                // There was some error in type coercing, data cannot be replaced safely\n                __cache.replacedData = newDataInferred\n                setReplaceRequiresConfirmation('type-mismatch')\n              } else {\n                if (stackDimension) {\n                  setUnstackedInfo([userData, newData.dataTypes])\n                  const stackedData = stackData(userData, stackDimension)\n                  setUserData(stackedData)\n                  parseDatasetAuto(stackedData, data.dataTypes, {\n                    locale,\n                    decimal: decimalsSeparator,\n                    group: thousandsSeparator,\n                  }).then(data => setData(data))\n                } else {\n                  setData(newData)\n                }\n              }\n            })\n          }\n        }\n      })\n    },\n    [\n      columnsTypes,\n      data,\n      decimalsSeparator,\n      locale,\n      parseDatasetAuto,\n      stackDimension,\n      thousandsSeparator,\n    ]\n  )\n\n  const handleNewUserData = useCallback(\n    (nextUserData) => {\n      setUserData(nextUserData)\n      if (mode === DATA_LOADER_MODE.DIRECT) {\n        parseDatasetAndSetData(nextUserData, undefined, {\n          locale,\n          decimal: decimalsSeparator,\n          group: thousandsSeparator,\n        })\n      } else if (mode === DATA_LOADER_MODE.REPLACE) {\n        handleReplacingData(nextUserData)\n      } else {\n        console.error('Unknown data loader mode!')\n      }\n    },\n    [\n      decimalsSeparator,\n      handleReplacingData,\n      locale,\n      mode,\n      parseDatasetAndSetData,\n      thousandsSeparator,\n    ]\n  )\n\n  /*\n   * Callback to handle user injecting data\n   * When user uploads some data (in any possible way), we store the raw user input at first\n   * Then we try to read it using different parsers (notably json and csv)\n   * Finally, if read is successful, we go inferring types using the raw-core library\n   */\n  function setUserDataAndDetect(str, source, options) {\n    const [dataType, parsedUserData, error, extra] = parseAndCheckData(str, {\n      separator: get(options, 'separator', null),\n    })\n    setUserInput(str)\n    setDataSource(source)\n    setUserDataType(dataType)\n    setParserError(error)\n    if (extra && typeof extra === \"object\" && \"separator\" in extra) {\n      setSeparator(extra.separator)\n    }\n    // Data parsed ok set parent data\n    if (dataType !== 'json' && !error) {\n      handleNewUserData(parsedUserData)\n    }\n    const jsonPath = dataSource?.jsonPath ?? undefined\n    if (dataType === 'json' && !error && jsonPath !== undefined) {\n      const jsonData = get(parsedUserData, jsonPath, null)\n      if (Array.isArray(jsonData)) {\n        handleNewUserData(jsonData)\n      }\n    }\n  }\n\n  const setJsonData = useCallback(\n    (data, path) => {\n      const normalized = normalizeJsonArray(data)\n      setUserData(normalized)\n      setDataSource({...dataSource, jsonPath: path })\n      handleNewUserData(normalized)\n    },\n    [dataSource, handleNewUserData]\n  )\n\n  /*\n   * Callback to handle user changing separator\n   * When the separator is changed, a fresh parsing of raw user input is required for proper handling\n   * Steps are very similar with respect to the `setUserInputAndDetect` callback, except for the\n   * fact that we take user input from state instead of from parameters\n   */\n  function handleChangeSeparator(newSeparator) {\n    const [dataType, parsedUserData, error] = parseAndCheckData(userInput, {\n      separator: newSeparator,\n    })\n    setSeparator(newSeparator)\n    setUserDataType(dataType)\n    setParserError(error)\n    if (dataType !== 'json' && !error && newSeparator) {\n      setUserData(parsedUserData)\n      parseDatasetAndSetData(parsedUserData, undefined, {\n        locale,\n        decimal: decimalsSeparator,\n        group: thousandsSeparator,\n      })\n    }\n  }\n\n  function handleChangeLocale(newLocale) {\n    if (!data) {\n      return\n    }\n    parseDatasetAndSetData(data.dataset, data.dataTypes, {\n      locale: newLocale,\n      decimal: decimalsSeparator,\n      group: thousandsSeparator,\n    })\n    setLocale(newLocale)\n  }\n\n  function handleChangeDecimalSeparator(newDecimalSeparator) {\n    const [dataType, parsedUserData, error] = parseAndCheckData(userInput, {\n      separator,\n    })\n    setDecimalsSeparator(newDecimalSeparator)\n    setUserDataType(dataType)\n    setParserError(error)\n    if (dataType !== 'json' && !error) {\n      setUserData(parsedUserData)\n      setLoading(true)\n      parseDatasetAndSetData(parsedUserData, undefined, {\n        locale,\n        decimal: newDecimalSeparator,\n        group: thousandsSeparator,\n      })\n      //setData(parseDataset(parsedUserData, undefined, {locale, decimal: newDecimalSeparator, group:thousandsSeparator}));\n    }\n  }\n\n  function handleChangeThousandsSeparator(newThousandsSeparator) {\n    const [dataType, parsedUserData, error] = parseAndCheckData(userInput, {\n      separator,\n    })\n    setThousandsSeparator(newThousandsSeparator)\n    setUserDataType(dataType)\n    setParserError(error)\n    if (dataType !== 'json' && !error) {\n      setUserData(parsedUserData)\n      parseDatasetAndSetData(parsedUserData, undefined, {\n        locale,\n        decimal: decimalsSeparator,\n        group: newThousandsSeparator,\n      })\n      // setData(parseDataset(parsedUserData, undefined, {locale, decimal: decimalsSeparator, group:newThousandsSeparator}));\n    }\n  }\n\n  /*\n   * Callback to handle user coercing a type of a column\n   * When this happens, we don't need to go through data parsing again, we just invoke\n   * the raw-core library starting from the parsed data (stage-2 data)\n   */\n  function coerceTypes(nextTypes) {\n    parseDatasetAndSetData(userData, nextTypes, {\n      locale,\n      decimal: decimalsSeparator,\n      group: thousandsSeparator,\n    })\n  }\n\n  /*\n   * Callback to handle user selecting a data sample from RawGraphs.io\n   * When this happens, we have data parsed with dsv with a proper separator out of the box\n   *   since in this case data are rigorously checked\n   * So we just take them as good and use the raw-core library to infer types\n   */\n  function loadSample(rawData, sampleSeparator) {\n    setSeparator(sampleSeparator)\n    setUserDataAndDetect(\n      rawData,\n      { type: 'sample' },\n      { separator: sampleSeparator }\n    )\n  }\n\n  function handleInlineEdit(newDataset) {\n    setUserData(newDataset)\n    parseDatasetAndSetData(newDataset, data.dataTypes, {\n      locale,\n      decimal: decimalsSeparator,\n      group: thousandsSeparator,\n    })\n    // setData(parseDataset(newDataset, data.dataTypes, {locale}))\n  }\n\n  function handleStackOperation(column) {\n    setStackDimension(column)\n    if (column !== null) {\n      if (unstackedData === null) {\n        setUnstackedInfo([userData, data.dataTypes])\n      }\n      const stackedData = stackData(unstackedData || userData, column)\n      setUserData(stackedData)\n      parseDatasetAndSetData(stackedData, undefined, {\n        locale,\n        decimal: decimalsSeparator,\n        group: thousandsSeparator,\n      })\n      // setData(parseDataset(stackedData, undefined, { locale }))\n    } else {\n      setUserData(unstackedData)\n      parseDatasetAndSetData(unstackedData, unstackedColumns, {\n        locale,\n        decimal: decimalsSeparator,\n        group: thousandsSeparator,\n      })\n      setUnstackedInfo([null, null])\n    }\n  }\n\n  const startDataReplace = useCallback(() => {\n    setMode(DATA_LOADER_MODE.REPLACE)\n    __cache.userInput = userInput\n    __cache.userDataType = userDataType\n    __cache.dataSource = dataSource\n    __cache.userData = userData\n    setUserInput(null)\n    setUserDataType(null)\n    setDataSource(null)\n    setUserData(null)\n  }, [dataSource, userData, userDataType, userInput])\n\n  const cancelDataReplace = useCallback(() => {\n    setReplaceRequiresConfirmation(false)\n    setMode(DATA_LOADER_MODE.DIRECT)\n    setUserInput(__cache.userInput)\n    setUserDataType(__cache.userDataType)\n    setDataSource(__cache.dataSource)\n    setUserData(__cache.userData)\n  }, [])\n\n  const commitDataReplace = useCallback(() => {\n    setReplaceRequiresConfirmation(false)\n    setData(__cache.replacedData)\n    setParserError(null)\n    setStackDimension(null)\n    setUnstackedInfo([null, null])\n  }, [])\n\n  return {\n    userInput,\n    setUserInput: setUserDataAndDetect,\n    userData,\n    userDataType,\n    parseError,\n    unstackedData,\n    unstackedColumns,\n    separator,\n    setSeparator: handleChangeSeparator,\n    thousandsSeparator,\n    setThousandsSeparator: handleChangeThousandsSeparator,\n    decimalsSeparator,\n    setDecimalsSeparator: handleChangeDecimalSeparator,\n    locale,\n    setLocale: handleChangeLocale,\n    stackDimension,\n    dataSource,\n    data,\n    loading,\n    coerceTypes,\n    loadSample,\n    handleInlineEdit,\n    handleStackOperation,\n    setJsonData,\n    resetDataLoader: reset,\n    hydrateFromSavedProject,\n    dataLoaderMode: mode,\n    startDataReplace,\n    cancelDataReplace,\n    commitDataReplace,\n    replaceRequiresConfirmation,\n  }\n}\n","import React, { useMemo, useRef, useState, useCallback } from 'react'\nimport ReactDataGrid from 'react-data-grid'\nimport { Overlay, OverlayTrigger } from 'react-bootstrap'\nimport classNames from 'classnames'\nimport { getTypeName, dateFormats } from '@rawgraphs/rawgraphs-core'\nimport S from './DataGrid.module.scss'\nimport { keyBy, get, isEqual } from 'lodash'\nimport {\n  dataTypeIcons,\n  DateIcon,\n  StringIcon,\n  NumberIcon,\n} from '../../constants'\nimport { BsFillCaretRightFill } from 'react-icons/bs'\n\nconst DATE_FORMATS = Object.keys(dateFormats)\n\nconst DateFormatSelector = React.forwardRef(\n  ({ currentFormat, onChange, className, ...props }, ref) => {\n    return (\n      <div\n        className={classNames(className, S['date-format-selector'])}\n        ref={ref}\n        {...props}\n      >\n        {DATE_FORMATS.map((dateFmt) => (\n          <div\n            key={dateFmt}\n            className={classNames(S['date-format-selector-entry'], {\n              [S.selected]: get(currentFormat, 'dateFormat', '') === dateFmt,\n            })}\n            onClick={(e) => {\n              e.stopPropagation()\n              e.preventDefault()\n              onChange &&\n                onChange({\n                  type: 'date',\n                  dateFormat: dateFmt,\n                })\n            }}\n          >\n            {dateFmt}\n          </div>\n        ))}\n      </div>\n    )\n  }\n)\n\nfunction DataTypeSelector({\n  currentType: typeDescriptor,\n  onTypeChange,\n  currentTypeComplete,\n}) {\n  const dataTypeIconDomRef = useRef(null)\n  const [showPicker, setShowPicker] = useState(false)\n  const currentType = get(typeDescriptor, 'type', typeDescriptor)\n\n  const handleTypeChange = useCallback(\n    (e) => {\n      e.stopPropagation()\n      e.preventDefault()\n      const newType = e.target.dataset.datatype\n      if (\n        typeof onTypeChange === 'function' &&\n        !isEqual(newType, typeDescriptor)\n      ) {\n        onTypeChange(newType)\n      }\n      setShowPicker(false)\n    },\n    [typeDescriptor, onTypeChange]\n  )\n\n  const handleTypeChangeDate = useCallback(\n    (newType) => {\n      if (\n        typeof onTypeChange === 'function' &&\n        !isEqual(newType, typeDescriptor)\n      ) {\n        onTypeChange(newType)\n      }\n      setShowPicker(false)\n    },\n    [typeDescriptor, onTypeChange]\n  )\n\n  const handleTargetClick = useCallback(\n    (e) => {\n      e.stopPropagation()\n      e.preventDefault()\n      setShowPicker(!showPicker)\n    },\n    [showPicker]\n  )\n\n  const Icon = dataTypeIcons[currentType]\n\n  return (\n    <>\n      <span\n        role=\"button\"\n        className={S['data-type-selector-trigger']}\n        ref={dataTypeIconDomRef}\n        onClick={handleTargetClick}\n      >\n        <Icon />\n      </span>\n      <Overlay\n        target={dataTypeIconDomRef.current}\n        show={showPicker}\n        placement=\"bottom-start\"\n        rootClose={true}\n        rootCloseEvent=\"click\"\n        onHide={() => {\n          setShowPicker(false)\n        }}\n        container={document.body}\n      >\n        {({\n          placement,\n          scheduleUpdate,\n          arrowProps,\n          outOfBoundaries,\n          show: _show,\n          ...props\n        }) => (\n          <div\n            id=\"data-type-selector\"\n            className={S['data-type-selector']}\n            onClick={(e) => e.stopPropagation()}\n            {...props}\n          >\n            <div\n              data-datatype=\"number\"\n              onClick={handleTypeChange}\n              className={classNames(S['data-type-selector-item'], {\n                [S.selected]: currentType === 'number',\n              })}\n            >\n              <NumberIcon /> Number\n            </div>\n            <OverlayTrigger\n              placement=\"right-start\"\n              overlay={\n                <DateFormatSelector\n                  currentType={typeDescriptor}\n                  onChange={handleTypeChangeDate}\n                />\n              }\n              trigger=\"click\"\n            >\n              {({ ref, ...triggerHandler }) => (\n                <div\n                  ref={ref}\n                  data-datatype=\"date\"\n                  {...triggerHandler}\n                  className={classNames(\n                    S['data-type-selector-item'],\n                    S['parent-type-selector'],\n                    { [S.selected]: currentType === 'date' }\n                  )}\n                >\n                  <div>\n                    <DateIcon />\n                    {'Date'}\n                    {currentType === 'date' && (\n                      <span className={S['date-format-preview']}>\n                        {' (' + (currentTypeComplete.dateFormat) + ')  '}\n                      </span>\n                    )}\n                  </div>\n                  <BsFillCaretRightFill\n                    style={{ marginRight: 0, fill: 'var(--gray-700)' }}\n                  />\n                </div>\n              )}\n            </OverlayTrigger>\n            <div\n              data-datatype=\"string\"\n              onClick={handleTypeChange}\n              className={classNames(S['data-type-selector-item'], {\n                [S.selected]: currentType === 'string',\n              })}\n            >\n              <StringIcon /> String\n            </div>\n          </div>\n        )}\n      </Overlay>\n    </>\n  )\n}\n\nfunction HeaderRenderer({ ...props }) {\n  const { column } = props\n  const { key, sortColumn, sortDirection } = column\n  return (\n    <div\n      className={classNames(\n        { [S['raw-col-header']]: true },\n        {\n          [S['unsorted']]:\n            key !== sortColumn ||\n            (key === sortColumn && sortDirection === 'NONE'),\n        },\n        { [S['acs']]: key === sortColumn && sortDirection === 'ASC' },\n        { [S['desc']]: key === sortColumn && sortDirection === 'DESC' }\n      )}\n    >\n      <DataTypeSelector\n        currentType={column._raw_datatype}\n        onTypeChange={column._raw_coerceType}\n        currentTypeComplete={column._raw_datatype}\n      />\n      <span\n        className={classNames(S['column-name'], 'text-truncate', 'd-block')}\n        title={column.name}\n      >\n        {column.name}\n      </span>\n    </div>\n  )\n}\n\nexport default function DataGrid({\n  userDataset,\n  dataset,\n  errors,\n  dataTypes,\n  coerceTypes,\n  onDataUpdate,\n}) {\n  const [[sortColumn, sortDirection], setSort] = useState(['id', 'NONE'])\n\n  const keyedErrors = useMemo(() => keyBy(errors, 'row'), [errors])\n\n  const containerEl = useRef()\n\n  // Make id column just as large as needed\n  // Adjust constants to fit cell padding and font size\n  // (Math.floor(Math.log10(data.dataset.length)) + 1) is the number\n  //   of digits of the highest id\n  const idColumnWidth =\n    24 + 8 * (Math.floor(Math.log10(userDataset.length)) + 1)\n  \n  const equalDinstribution = (containerEl.current?.getBoundingClientRect().width - idColumnWidth - 1) / Object.keys(dataTypes).length\n  const columnWidth = equalDinstribution ? Math.max(equalDinstribution, 170) : 170;\n\n  const columns = useMemo(() => {\n    if (!userDataset || !dataTypes) {\n      return []\n    }\n    return [\n      {\n        key: '_id',\n        name: '',\n        headerRenderer: () => null,\n        frozen: true,\n        width: idColumnWidth,\n        sortable: true,\n      },\n      ...Object.keys(dataTypes).map((k, i) => ({\n        key: k,\n        name: k,\n        sortColumn: sortColumn,\n        sortDirection: sortDirection,\n        headerRenderer: HeaderRenderer,\n        editable: true,\n        formatter: ({ row }) => {\n          return (\n            <div\n              className={classNames({ [S['has-error']]: row?._errors?.[k] })}\n            >\n              {row[k]?.toString()}\n              {/* {row[k]} */}\n            </div>\n          )\n        },\n        _raw_datatype: dataTypes[k],\n        _raw_coerceType: (nextType) =>\n          coerceTypes({ ...dataTypes, [k]: nextType }),\n        sortable: true,\n        resizable: true,\n        width: columnWidth\n      })),\n    ]\n  }, [\n    coerceTypes,\n    dataTypes,\n    userDataset,\n    idColumnWidth,\n    columnWidth,\n    sortColumn,\n    sortDirection,\n  ])\n\n  const sortedDataset = useMemo(() => {\n    let datasetWithIds = userDataset.map((item, i) => ({\n      // Using .map ensures that we are not mutating a property\n      ...item,\n      _id: i + 1, // Give items some id to populate left-most column\n      _stage3: dataset[i], // The dataset parsed by raw lib basing on data types is needed for sorting!\n      _errors: keyedErrors[i]?.error, // Inject errors to format cells with parsing errors\n    }))\n    if (sortDirection === 'NONE') return datasetWithIds\n\n    const sortColumnType = getTypeName(dataTypes[sortColumn])\n\n    if (sortColumnType === 'number') {\n      datasetWithIds = datasetWithIds.sort(\n        (a, b) => a._stage3[sortColumn] - b._stage3[sortColumn]\n      )\n    } else if (sortColumnType === 'date') {\n      datasetWithIds =\n        datasetWithIds.sort(\n          (a, b) =>\n            a._stage3[sortColumn]?.valueOf() ??\n            0 - b._stage3[sortColumn]?.valueOf()\n        ) ?? 0\n    } else {\n      datasetWithIds = datasetWithIds.sort((a, b) =>\n        a._stage3[sortColumn]\n          ?.toString()\n          .localeCompare(b._stage3[sortColumn].toString())\n      )\n    }\n\n    return sortDirection === 'DESC' ? datasetWithIds.reverse() : datasetWithIds\n  }, [userDataset, sortDirection, dataTypes, sortColumn, dataset, keyedErrors])\n\n  const handleSort = useCallback((columnKey, direction) => {\n    setSort([columnKey, direction])\n  }, [])\n\n  return (\n    <div ref={containerEl}>\n      <ReactDataGrid\n        minColumnWidth={idColumnWidth}\n        columns={columns}\n        rows={sortedDataset}\n        rowHeight={48}\n        sortColumn={sortColumn}\n        sortDirection={sortDirection}\n        onSort={handleSort}\n        height={432}\n        onColumnResize={() => {\n          \n        }}\n        onRowsUpdate={(update) => {\n          if (update.action === 'CELL_UPDATE') {\n            const newDataset = [...userDataset]\n            newDataset[update.fromRow] = {\n              ...newDataset[update.fromRow],\n              [update.cellKey]: update.updated[update.cellKey],\n            }\n            onDataUpdate && onDataUpdate(newDataset)\n          }\n        }}\n      />\n    </div>\n  )\n}\n","import React from 'react'\nimport { Row, Col, Card } from 'react-bootstrap'\nimport styles from './DataSamples.module.scss'\n\nconst samplesList = [\n  {\n    name: 'Hate crimes in New York',\n    category: 'Alluvial Diagram',\n    url: './sample-datasets/Alluvial diagram - Hate crimes in New York.tsv',\n    delimiter: '\\t',\n    sourceName: 'NYC Open Data',\n    sourceURL:\n      'https://data.cityofnewyork.us/Public-Safety/NYPD-Hate-Crimes/bqiq-cu78',\n  },\n  {\n    name: 'Lannister vs Starck relationships',\n    category: 'Arc diagrams',\n    url:\n      './sample-datasets/Arc diagrams - Lannister vs Starck relationships.tsv',\n    delimiter: '\\t',\n    sourceName: 'T. Breid via Kaggle',\n    sourceURL: 'https://www.kaggle.com/theobreid/got-data',\n  },\n  {\n    name: 'EU Index of consumer prices',\n    category: 'Horizon Graph',\n    url: './sample-datasets/Horizon Graph - EU Index of consumer prices.tsv',\n    delimiter: '\\t',\n    sourceName: 'Eurostat',\n    sourceURL:\n      'https://ec.europa.eu/eurostat/databrowser/bookmark/d84c6140-ed7e-443e-baf9-918679862d58?lang=en',\n  },\n\n  {\n    name: 'New York mean wage per occupation',\n    category: 'Beeswarm plot',\n    url: './sample-datasets/Beeswarm plot - NY mean wages.tsv',\n    delimiter: '\\t',\n    sourceName: 'NYC Open Data',\n    sourceURL:\n      'https://data.ny.gov/w/gkgz-nw24/caer-yrtv?cur=S3JXBWlXCbs&from=SAa8_R9mOdD',\n  },\n\n  {\n    name: 'Temperature in Paris during the World War II',\n    category: 'Contour plot',\n    url:\n      './sample-datasets/Contour plot - Mean temperature in Paris 1944-1945.tsv',\n    delimiter: '\\t',\n    sourceName: 'NOAA',\n    sourceURL:\n      'https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/world-war-ii-era-data',\n  },\n\n  {\n    name: 'Highest grossing movies in history',\n    category: 'Bubble chart',\n    url: './sample-datasets/Bubble Chart - TOP 50 Groossing Movies.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikipedia',\n    sourceURL:\n      'https://en.wikipedia.org/w/index.php?title=List_of_highest-grossing_films&oldid=1023491946',\n  },\n\n  {\n    name: 'Foreign residents in Milan',\n    category: 'Bumpchart',\n    url: './sample-datasets/Bump chart - Foreign residents in Milan.tsv',\n    delimiter: '\\t',\n    sourceName: 'Comune di Milano',\n    sourceURL:\n      'https://dati.comune.milano.it/dataset/ds74-popolazione-residenti-stranieri-cittadinanza',\n  },\n\n  {\n    name: 'Estimated migration flows between macro-areas from 1960 to 1970',\n    category: 'Chord diagram',\n    url:\n      './sample-datasets/Chord Diagram - Estimated migration flows between macro-areas.csv',\n    delimiter: ',',\n    sourceName: 'Gui J. Abel, via Data to Viz',\n    sourceURL:\n      'https://github.com/holtzy/data_to_viz/tree/master/Example_dataset',\n  },\n\n  {\n    name: 'Most populated cities per continent',\n    category: 'Circle packing',\n    url: './sample-datasets/Circle Packing - Most populated cities.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikidata',\n    sourceURL:\n      'https://query.wikidata.org/#SELECT%20%3Fitem%20%3FitemLabel%20%3Fpopulation%20%3Fcountry%20%3FcountryLabel%20%3Fcontinent%20%3FcontinentLabel%0AWHERE%20%7B%0A%20%20%3Fitem%20wdt%3AP31%20wd%3AQ1637706%20.%20%23%20get%20things%20that%20are%20bands%0A%20%20%3Fitem%20wdt%3AP1082%20%3Fpopulation%20.%0A%20%20%23%3Fitems%20wdt%3AP571%20%3Fdate%20.%20%23%20get%20the%20date%20when%20the%20band%20was%20founded%0A%20%20%3Fitem%20wdt%3AP17%20%3Fcountry%20.%0A%20%20%3Fcountry%20wdt%3AP30%20%3Fcontinent%20.%0A%20%20%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%7D%0A',\n  },\n\n  {\n    name: 'Kobe Bryant shoots',\n    category: 'Hexagonal Binning, Voronoi diagram',\n    url: './sample-datasets/Hexbin - basketball shots.tsv',\n    delimiter: '\\t',\n    sourceName: 'Kaggle',\n    sourceURL: 'https://www.kaggle.com/c/kobe-bryant-shot-selection/',\n  },\n\n  {\n    name: 'Orchestras by musical instrument',\n    category: 'Treemap',\n    url: './sample-datasets/Treemap - Orchestra.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikipedia',\n    sourceURL:\n      'https://en.wikipedia.org/w/index.php?title=Orchestra&oldid=1022472978',\n  },\n\n  {\n    name: 'Italians PMs and Presidents',\n    category: 'Gantt chart',\n    url: './sample-datasets/Gantt chart - Italian PMs and presidents.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikidata',\n    sourceURL:\n      'https://query.wikidata.org/#%23Primi%20ministri%0ASELECT%20%3Fitem%20%3FitemLabel%20%3Fstart%20%3Fend%0AWHERE%20%0A%7B%0A%20%20%3Fitem%20p%3AP39%20%3Fposition.%0A%20%20%3Fposition%20ps%3AP39%20wd%3AQ332711%3B%0A%20%20%20%20%20%20%20%20pq%3AP580%20%3Fstart%3B%0A%20%20%20%20%20%20%20%20pq%3AP582%20%3Fend%0A%20%20%23%3Fstart%20wdt%3AP580%20%3Fitem.%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%7D',\n  },\n\n  {\n    name: 'Revenues per Music format',\n    category: 'Line chart',\n    url: './sample-datasets/Line chart - RIAA Music format revenues.tsv',\n    delimiter: '\\t',\n    sourceName: 'RIAA',\n    sourceURL: 'https://www.riaa.com/u-s-sales-database/',\n  },\n\n  {\n    name: 'Energy flows in UK (2050)',\n    category: 'Sankey diagram',\n    url: './sample-datasets/Sankey diagram - Energy flows.tsv',\n    delimiter: '\\t',\n    sourceName: 'gov.uk',\n    sourceURL:\n      'https://www.gov.uk/government/publications/2050-pathways-calculator-with-costs',\n  },\n\n  {\n    name: 'Aromas of wine and frequency',\n    category: 'Sunburst Diagram',\n    url: './sample-datasets/Sunburst - Wine Aromas.tsv',\n    delimiter: '\\t',\n    sourceName: 'Own work',\n    sourceURL: '',\n  },\n\n  {\n    name: 'Happiness index',\n    category: 'Multiset Barchart',\n    url: './sample-datasets/Multiset Barchart - Happiness Index.tsv',\n    delimiter: '\\t',\n    sourceName: 'World Happiness Report',\n    sourceURL: 'https://worldhappiness.report/',\n  },\n\n  {\n    name: 'GDP sector composition',\n    category: 'Pie chart, Stacked barchart',\n    url: './sample-datasets/Stacked barchart - GDP sector composition.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikipedia',\n    sourceURL:\n      'https://en.wikipedia.org/w/index.php?title=List_of_countries_by_GDP_sector_composition&oldid=1022131842',\n  },\n\n  {\n    name: 'Felidae classification (cats and friends)',\n    category: 'Dendrogram, Circular dendrogram',\n    url: './sample-datasets/Dendrogram - Felidae classification.tsv',\n    delimiter: '\\t',\n    sourceName: 'Special thanks to interns',\n    sourceURL: '',\n  },\n\n  {\n    name: 'Iris flowers',\n    category: 'Convex hull, Parallel Coordinates',\n    url: './sample-datasets/Convex hull - Iris flowers.tsv',\n    delimiter: '\\t',\n    sourceName: 'R. Fisher',\n    sourceURL: 'https://en.wikipedia.org/wiki/Iris_flower_data_set',\n  },\n\n  {\n    name: 'Letter Frequency by Language',\n    category: 'Matrix plot (Heatmap)',\n    url: './sample-datasets/Matrix Plot - Letters frequencies by language.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikipedia',\n    sourceURL: 'https://en.wikipedia.org/wiki/Letter_frequency',\n  },\n\n  {\n    name: 'FIFA players statistics',\n    category: 'Radar Chart',\n    url: './sample-datasets/Radar Chart - Fifa players.tsv',\n    delimiter: '\\t',\n    sourceName: 'K. Gadiya via Kaggle',\n    sourceURL: 'https://www.kaggle.com/karangadiya/fifa19',\n  },\n\n  {\n    name: 'Olympics Medals',\n    category: 'Streamgraph',\n    url: './sample-datasets/Streamgraph - Olympics Medals.tsv',\n    delimiter: '\\t',\n    sourceName: 'D. Agrawal via Kaggle',\n    sourceURL: 'https://www.kaggle.com/divyansh22/summer-olympics-medals',\n  },\n\n  {\n    name: 'Weather in New York, 2012-2015',\n    category: 'Violin plot, Boxplot',\n    url: './sample-datasets/Violin plot - Weather in New York.tsv',\n    delimiter: '\\t',\n    sourceName: 'NOAA via Vega Dataset',\n    sourceURL:\n      'https://github.com/vega/vega-datasets/blob/master/SOURCES.md#seattle-weathercsv',\n  },\n\n  {\n    name: 'Netflix Original Series 2013/2017',\n    category: 'Bar chart',\n    url: './sample-datasets/Bar chart - Netflix Original Series.tsv',\n    delimiter: '\\t',\n    sourceName: 'M. Schroyer via Data World',\n    sourceURL: 'https://data.world/mattschroyer/netflix-original-series',\n  },\n\n  {\n    name: 'Premier League and Serie A points',\n    category: 'Slope chart',\n    url: './sample-datasets/Slope graph - Premier SerieA ranking.tsv',\n    delimiter: '\\t',\n    sourceName: 'Wikipedia',\n    sourceURL: 'https://en.wikipedia.org/wiki/2019%E2%80%9320_Premier_League',\n  },\n\n  // {\n  //   name: '',\n  //   category: '',\n  //   url: './sample-datasets/',\n  //   delimiter: '\\t',\n  //   sourceName: '',\n  //   sourceURL: '',\n  // },\n]\nexport default function DataSamples({ onSampleReady, setLoadingError }) {\n  const select = async (sample) => {\n    const { delimiter, url } = sample\n    let response\n    try {\n      response = await fetch(url)\n    } catch (e) {\n      setLoadingError('Loading error. ' + e.message)\n      return\n    }\n    const text = await response.text()\n    onSampleReady(text, delimiter)\n    setLoadingError(null)\n  }\n  return (\n    <Row>\n      {samplesList\n        // sort by category name\n        .sort((a, b) => a.name.localeCompare(b.name))\n        .map((d, i) => {\n          return (\n            <Col xs={6} lg={4} xl={3} key={i} style={{ marginBottom: 15 }}>\n              <Card className=\"cursor-pointer h-100\">\n                <Card.Body\n                  onClick={() => {\n                    select(d)\n                  }}\n                  className=\"d-flex flex-column\"\n                >\n                  <Card.Title className=\"\">\n                    <h2 className=\"\">{d.name}</h2>\n                    <h4 className=\"m-0\">{d.category}</h4>\n                  </Card.Title>\n                </Card.Body>\n                <a\n                  href={d.sourceURL}\n                  className={[styles['dataset-source']].join(' ')}\n                >\n                  Source: {d.sourceName}\n                </a>\n              </Card>\n            </Col>\n          )\n        })}\n    </Row>\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport { map } from 'lodash'\nimport './JsonViewer.scss'\n\nconst JsonViewerRecursive = ({\n  contextName,\n  nestingLevel,\n  context,\n  selectFilter,\n  onSelect,\n  path\n}) => {\n  const isSelectable = selectFilter(context)\n  const contextType = typeof context\n  const [mouseOver, setMouseOver] = useState(false)\n\n  const classes = [\n    'json-nested',\n    isSelectable ? 'selectable' : null,\n    mouseOver ? 'hover' : null,\n  ]\n    .filter((i) => i !== null)\n    .join(' ')\n\n  const handleSelect = useCallback(\n    (e) => {\n      if (isSelectable) {\n        e.stopPropagation()\n        e.preventDefault()\n        if (onSelect) onSelect(context, path.join(\".\"))\n      }\n    },\n    [context, isSelectable, onSelect, path]\n  )\n\n  const handleMouseOver = useCallback(\n    (e) => {\n      if (isSelectable) {\n        e.stopPropagation()\n        e.preventDefault()\n        setMouseOver(true)\n      }\n    },\n    [isSelectable]\n  )\n\n  const handleMouseOut = useCallback(\n    (e) => {\n      if (isSelectable) {\n        e.stopPropagation()\n        e.preventDefault()\n        setMouseOver(false)\n      }\n    },\n    [isSelectable]\n  )\n\n  if (contextType === 'object' && contextType !== null) {\n    return (\n      <div\n        className={classes}\n        onClick={handleSelect}\n        onMouseOver={handleMouseOver}\n        onMouseOut={handleMouseOut}\n      >\n        {contextName && (\n          <>\n            <span className=\"property-name\">{contextName}</span>\n            <span className=\"colon\">{': '}</span>\n          </>\n        )}\n        {!Array.isArray(context) && (\n          <span className=\"curly-bracket open-bracket\">{'{'}</span>\n        )}\n        {Array.isArray(context) && (\n          <span className=\"square-bracket open-bracket\">{'['}</span>\n        )}\n        {map(context, (value, property) => (\n          <JsonViewerRecursive\n            key={property}\n            contextName={Array.isArray(context) ? null : property}\n            nestingLevel={nestingLevel + 1}\n            context={value}\n            selectFilter={selectFilter}\n            onSelect={onSelect}\n            path={[...path, property]}\n          />\n        ))}\n        {!Array.isArray(context) && (\n          <span className=\"curly-bracket close-bracket\">{'}'}</span>\n        )}\n        {Array.isArray(context) && (\n          <span className=\"square-bracket close-bracket\">{']'}</span>\n        )}\n      </div>\n    )\n  } else {\n    return (\n      <div\n        className={classes}\n        onClick={handleSelect}\n        onMouseOver={handleMouseOver}\n        onMouseOut={handleMouseOut}\n      >\n        {contextName && (\n          <>\n            <span className=\"property-name\">{contextName}</span>\n            <span className=\"colon\">{': '}</span>\n          </>\n        )}\n        {context === null && <span className=\"scalar-value\">null</span>}\n        {context !== null && (\n          <>\n            {(contextType === 'bigint' || contextType === 'number') && (\n              <span className=\"scalar-value scalar-value-numeric\">\n                {context.toString()}\n              </span>\n            )}\n            {contextType === 'string' && (\n              <span className=\"scalar-value scalar-value-string\">\n                \"{context.toString()}\"\n              </span>\n            )}\n            {contextType === 'boolean' && (\n              <span className=\"scalar-value scalar-value-bool\">\n                \"{context ? 'true' : 'false'}\"\n              </span>\n            )}\n            {contextType === 'undefined' && (\n              <span className=\"scalar-value scalar-value-undefined\">\n                undefined\n              </span>\n            )}\n          </>\n        )}\n      </div>\n    )\n  }\n}\n\nconst JsonViewer = ({ context, selectFilter, onSelect }) => {\n  return (\n    <pre className=\"json-viewer\">\n      <JsonViewerRecursive\n        contextName={null}\n        nestingLevel={0}\n        context={context}\n        selectFilter={selectFilter}\n        onSelect={onSelect}\n        path={[]}\n      />\n    </pre>\n  )\n}\n\nexport default JsonViewer\n","import React, { useCallback } from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { separatorsLabels } from '../../constants'\n\nimport styles from './ParsingOptions.module.scss'\n\nexport default function SeparatorSelector({\n  title,\n  value,\n  onChange,\n  ...props\n}) {\n  const inputValue = value\n    .replace(/\\r/g, '\\\\r')\n    .replace(/\\n/g, '\\\\n')\n    .replace(/\\t/g, '\\\\t')\n\n  const handleChange = useCallback(\n    (separator) => {\n      if (onChange) {\n        const nextValue = separator\n          .replace(/\\\\r/g, '\\r')\n          .replace(/\\\\n/g, '\\n')\n          .replace(/\\\\t/g, '\\t')\n        onChange(nextValue)\n      }\n    },\n    [onChange]\n  )\n\n  const formatValue = (value)=>{\n    return (\n      <>\n        <span className={['small',styles['separator-preview']].join(' ')}>{value}</span> <span>{separatorsLabels[value]}</span>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"option\">\n        {title}\n        <Dropdown className=\"d-inline-block raw-dropdown\">\n          <Dropdown.Toggle variant=\"white\" className=\"d-flex justify-content-start align-items-center text-truncate\">\n            { formatValue(inputValue) }\n          </Dropdown.Toggle>\n          <Dropdown.Menu>\n            {Object.keys(separatorsLabels).map(key=>{\n              return <Dropdown.Item key={separatorsLabels[key]} onSelect={() => handleChange(key)}>\n                { formatValue(key) }\n              </Dropdown.Item>\n            })}\n          </Dropdown.Menu>\n        </Dropdown>\n      </div>\n    </>\n  )\n}\n","import React, { useCallback } from 'react'\n\nexport default function ThousandsSeparatorSelector({\n  title,\n  value,\n  onChange,\n  ...props\n}) {\n  const inputValue = value\n  // // Remove?\n  // .replace(/\\r/g, \"\\\\r\")\n  // .replace(/\\n/g, \"\\\\n\")\n  // .replace(/\\t/g, \"\\\\t\")\n\n  const handleChange = useCallback(\n    (e) => {\n      if (onChange) {\n        const nextValue = e.target.value\n        // // Remove?\n        // .replace(/\\\\r/g, \"\\r\")\n        // .replace(/\\\\n/g, \"\\n\")\n        // .replace(/\\\\t/g, \"\\t\")\n\n        onChange(nextValue)\n      }\n    },\n    [onChange]\n  )\n\n  return (\n    <div className=\"option\">\n      {title}\n      <input\n        type=\"text\"\n        className=\"form-control text-field d-inline-block\"\n        value={inputValue}\n        onChange={handleChange}\n        {...props}\n      />\n    </div>\n  )\n}\n","import React, { useCallback } from 'react'\n\nexport default function DecimalsSeparatorSelector({\n  title,\n  value,\n  onChange,\n  ...props\n}) {\n  const inputValue = value\n\n  const handleChange = useCallback(\n    (e) => {\n      if (onChange) {\n        const nextValue = e.target.value\n        onChange(nextValue)\n      }\n    },\n    [onChange]\n  )\n\n  return (\n    <div className=\"option\">\n      {title}\n      <input\n        type=\"text\"\n        className=\"form-control text-field d-inline-block\"\n        value={inputValue}\n        onChange={handleChange}\n        {...props}\n      />\n    </div>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { localeList } from '../../constants'\n\nexport default function DateLocaleSelector({\n  title,\n  value,\n  onChange,\n  ...props\n}) {\n  const handleChange = useCallback(\n    (locale) => {\n      if (onChange) {\n        const nextLocale = locale\n        onChange(nextLocale)\n      }\n    },\n    [onChange]\n  )\n\n  return (\n    <div className=\"option\">\n      {title}\n      <Dropdown className=\"d-inline-block raw-dropdown\">\n        <Dropdown.Toggle variant=\"white\" className=\"\">\n          {value}\n        </Dropdown.Toggle>\n        <Dropdown.Menu>\n          <Dropdown.Header>\n            <span>\n              from{' '}\n              <a\n                href=\"https://github.com/d3/d3-time-format/tree/master/locale\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                d3-time-format\n              </a>\n            </span>\n          </Dropdown.Header>\n          {Object.keys(localeList).map((d) => {\n            return (\n              <Dropdown.Item key={d} onSelect={() => handleChange(d)}>\n                {d}\n              </Dropdown.Item>\n            )\n          })}\n        </Dropdown.Menu>\n      </Dropdown>\n    </div>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { Dropdown } from 'react-bootstrap'\n\nexport default function StackSelector({\n  title,\n  value,\n  list,\n  onChange,\n  ...props\n}) {\n  const handleChange = useCallback(\n    (nextDimension) => {\n      if (onChange) {\n        onChange(nextDimension)\n      }\n    },\n    [onChange]\n  )\n\n  return (\n    <div className=\"option\">\n      {title}\n      <Dropdown className=\"d-inline-block raw-dropdown\">\n        <Dropdown.Toggle\n          variant=\"white\"\n          className=\"truncate-160px\"\n          disabled={list.length === 0}\n        >\n          {value ? value : 'Column'}\n        </Dropdown.Toggle>\n        <Dropdown.Menu>\n          {value && (\n            <Dropdown.Item onSelect={() => handleChange(null)}>\n              {'Do not stack'}\n            </Dropdown.Item>\n          )}\n          {Object.keys(list).map((d) => {\n            return (\n              <Dropdown.Item key={d} onSelect={() => handleChange(d)}>\n                {d}\n              </Dropdown.Item>\n            )\n          })}\n        </Dropdown.Menu>\n      </Dropdown>\n    </div>\n  )\n}\n","import React, { useCallback, useState } from 'react'\nimport classNames from 'classnames'\nimport S from './UrlFetch.module.scss'\n\nexport async function fetchData(source) {\n  const response = await fetch(source.url)\n  const text = await response.text()\n  return text\n}\n\nexport default function UrlFetch({\n  userInput,\n  setUserInput,\n  setLoadingError,\n  initialState = null,\n}) {\n  const [url, setUrl] = useState(initialState?.url)\n\n  const fetchUrl = useCallback(\n    async (url) => {\n      const source = { type: 'url', url }\n      let data\n      try {\n        data = await fetchData(source)\n        setUserInput(data, source)\n        setLoadingError(null)\n      } catch (e) {\n        setLoadingError('Loading error. ' + e.message)\n      }\n    },\n    [setLoadingError, setUserInput]\n  )\n\n  const handleSubmit = useCallback(\n    (e) => {\n      e.stopPropagation()\n      e.preventDefault()\n      fetchUrl(url)\n      return false\n    },\n    [url, fetchUrl]\n  )\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input\n        className={classNames('w-100', S['url-input'])}\n        value={url}\n        onChange={(e) => {\n          setUrl(e.target.value)\n        }}\n      />\n      <div className=\"text-right\">\n        <button\n          className=\"btn btn-sm btn-success mt-3\"\n          disabled={!url}\n          type=\"submit\"\n        >\n          Load data\n        </button>\n      </div>\n    </form>\n  )\n}\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport classNames from 'classnames'\nimport S from './SparqlFetch.module.scss'\nimport { html, render } from 'lit-html'\nimport SimpleClient from 'sparql-http-client/SimpleClient'\nimport { Generator } from 'sparqljs'\nimport '@rdfjs-elements/sparql-editor/sparql-editor.js'\nimport { SparqlMarker } from '../../../hooks/useDataLoaderUtils/parser'\n\nconst DEFAULT_PREFIXES = {\n  wd: 'http://www.wikidata.org/entity/',\n  wds: 'http://www.wikidata.org/entity/statement/',\n  wdv: 'http://www.wikidata.org/value/',\n  wdt: 'http://www.wikidata.org/prop/direct/',\n  wikibase: 'http://wikiba.se/ontology#',\n  p: 'http://www.wikidata.org/prop/',\n  ps: 'http://www.wikidata.org/prop/statement/',\n  pq: 'http://www.wikidata.org/prop/qualifier/',\n  rdfs: 'http://www.w3.org/2000/01/rdf-schema#',\n  bd: 'http://www.bigdata.com/rdf#',\n  wdref: 'http://www.wikidata.org/reference/',\n  psv: 'http://www.wikidata.org/prop/statement/value/',\n  psn: 'http://www.wikidata.org/prop/statement/value-normalized/',\n  pqv: 'http://www.wikidata.org/prop/qualifier/value/',\n  pqn: 'http://www.wikidata.org/prop/qualifier/value-normalized/',\n  pr: 'http://www.wikidata.org/prop/reference/',\n  prv: 'http://www.wikidata.org/prop/reference/value/',\n  prn: 'http://www.wikidata.org/prop/reference/value-normalized/',\n  wdno: 'http://www.wikidata.org/prop/novalue/',\n  wdata: 'http://www.wikidata.org/wiki/Special:EntityData/',\n  schema: 'http://schema.org/',\n  rdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\n  owl: 'http://www.w3.org/2002/07/owl#',\n  skos: 'http://www.w3.org/2004/02/skos/core#',\n  xsd: 'http://www.w3.org/2001/XMLSchema#',\n  prov: 'http://www.w3.org/ns/prov#',\n  bds: 'http://www.bigdata.com/rdf/search#',\n  gas: 'http://www.bigdata.com/rdf/gas#',\n  hint: 'http://www.bigdata.com/queryHints#',\n}\n\nexport async function fetchData(source) {\n  const sparqlGenerator = new Generator()\n  const client = new SimpleClient({\n    endpointUrl: source.url,\n  })\n  const response = await client.query.select(\n    sparqlGenerator.stringify(source.query)\n  )\n  const results = await response.json()\n  const rows = bindingsToJson(results.head.vars, results.results.bindings)\n  rows[SparqlMarker] = true\n  return rows\n}\n\nexport default function SparqlFetch({\n  userInput,\n  setUserInput,\n  setLoadingError,\n  initialState,\n}) {\n  const [url, setUrl] = useState(initialState?.url ?? 'https://query.wikidata.org/sparql')\n  const [parsedQuery, setParsedQuery] = useState(null)\n\n  const editorDomRef = useRef()\n\n  const initialQuery = useMemo(() => {\n    if (initialState?.query) {\n      const sparqlGenerator = new Generator()\n      return sparqlGenerator.stringify(initialState.query)\n    } else {\n      return ''\n    }\n  }, [initialState])\n\n  const onQueryParsed = useCallback((evt) => {\n    const { query } = evt.detail\n    if (query.queryType === 'SELECT') {\n      setParsedQuery(query)\n    } else {\n      setParsedQuery(null)\n    }\n  }, [])\n\n  const onParserFailure = useCallback(() => {\n    console.log('parser failed')\n    setParsedQuery(null)\n  }, [])\n\n  const onSubmit = useCallback(() => {\n    const source = {\n      type: 'sparql',\n      url,\n      query: parsedQuery,\n    }\n    fetchData(source)\n      .then((result) => {\n        setUserInput(result, {\n          type: 'sparql',\n          url,\n          query: parsedQuery,\n        })\n      })\n      .catch((err) => {\n        setLoadingError(\n          'It was not possible to execute the query on the given endpoint'\n        )\n      })\n  }, [parsedQuery, setLoadingError, setUserInput, url])\n\n  useEffect(() => {\n    const node = editorDomRef.current\n    render(\n      html`<sparql-editor\n        auto-parse\n        value=${initialQuery}\n        customPrefixes=${JSON.stringify(DEFAULT_PREFIXES)}\n        @parsed=${onQueryParsed}\n        @parsing-failed=${onParserFailure}\n      ></sparql-editor>`,\n      node\n    )\n  }, [onQueryParsed, onParserFailure, initialQuery])\n\n  return (\n    <>\n      <div className={classNames(S['base-iri-input-here'])}>\n        <span>Write your SPARQL Endpoint here</span>\n      </div>\n      <input\n        className={classNames('w-100', S['url-input'])}\n        value={url}\n        onChange={(e) => {\n          setUrl(e.target.value)\n        }}\n      />\n      <div className={classNames(S['query-input-here'])}>\n        <span>Write your query here</span>\n      </div>\n      <div ref={editorDomRef} />\n      <div className=\"text-right\">\n        <button\n          className=\"btn btn-sm btn-success mt-3\"\n          disabled={!parsedQuery || !url}\n          onClick={onSubmit}\n        >\n          Run query\n        </button>\n      </div>\n    </>\n  )\n}\n\nfunction bindingsToJson(varNames, bindings) {\n  const result = []\n  for (const binding of bindings) {\n    const row = {}\n    for (const variable of varNames) {\n      const term = binding[variable]\n      if (!term) {\n        row[variable] = ''\n      } else {\n        row[variable] = term.value\n      }\n    }\n    result.push(row)\n  }\n  return result\n}\n","import React from 'react'\nimport { Row, Col, Button } from 'react-bootstrap'\nimport SeparatorSelector from './SeparatorSelector'\nimport ThousandsSeparatorSelector from './ThousandsSeparatorSelector'\nimport DecimalsSeparatorSelector from './DecimalsSeparatorSelector'\nimport DateLocaleSelector from './DateLocaleSelector'\nimport StackSelector from './StackSelector'\n\nimport styles from './ParsingOptions.module.scss'\nimport { BsArrowRepeat } from 'react-icons/bs'\nimport { get } from 'lodash'\nimport { fetchData as fetchDataFromUrl } from '../DataLoader/loaders/UrlFetch'\nimport { fetchData as fetchDataFromSparql } from '../DataLoader/loaders/SparqlFetch'\n\nconst dataRefreshWorkers = {\n  \"url\": fetchDataFromUrl,\n  \"sparql\": fetchDataFromSparql\n}\n\nconst dataRefreshCaptions = {\n  \"url\": \"Refresh data from url\",\n  \"sparql\": \"Refresh data from query\"\n}\n\nexport default function ParsingOptions(props) {\n  const refreshData = async () => {\n    const dataRefreshImpl = dataRefreshWorkers[get(props.dataSource, \"type\", \"\")]\n    const data = await dataRefreshImpl(props.dataSource)\n    props.onDataRefreshed(data)\n  }\n\n  return (\n    <Row>\n      <Col className={styles.parsingOptions}>\n        <b>DATA PARSING OPTIONS</b>\n\n        {props.userDataType === 'csv' && (\n          <SeparatorSelector\n            title=\"Column separator\"\n            value={props.separator}\n            onChange={(nextSeparator) => props.setSeparator(nextSeparator)}\n          />\n        )}\n        <ThousandsSeparatorSelector\n          title=\"Thousands separator\"\n          value={props.thousandsSeparator}\n          onChange={(nextSeparator) =>\n            props.setThousandsSeparator(nextSeparator)\n          }\n        />\n        <DecimalsSeparatorSelector\n          title=\"Decimals separator\"\n          value={props.decimalsSeparator}\n          onChange={(nextSeparator) =>\n            props.setDecimalsSeparator(nextSeparator)\n          }\n        />\n\n        <DateLocaleSelector\n          title=\"Date Locale\"\n          value={props.locale}\n          onChange={(nextLocale) => props.setLocale(nextLocale)}\n        />\n\n        {get(dataRefreshWorkers, get(props.dataSource, 'type', ''), null) && (\n          <Button\n            color=\"primary\"\n            className={styles['refresh-button']}\n            onClick={() => refreshData()}\n          >\n            <BsArrowRepeat className=\"mr-2\" />\n            {get(dataRefreshCaptions, get(props.dataSource, 'type', ''), \"Refresh data\")}\n          </Button>\n        )}\n\n        <div className=\"divider mb-3 mt-0\" />\n\n        <b>DATA TRANSFORMATION</b>\n\n        <StackSelector\n          title=\"Stack on\"\n          value={props.stackDimension}\n          list={props.dimensions}\n          onChange={(nextStackDimension) =>\n            props.setStackDimension(nextStackDimension)\n          }\n        />\n      </Col>\n    </Row>\n  )\n}\n","import {\n  alluvialdiagram,\n  arcdiagram,\n  barchart,\n  barchartmultiset,\n  barchartstacked,\n  beeswarm,\n  boxplot,\n  bubblechart,\n  bumpchart,\n  chorddiagram,\n  circlepacking,\n  circularDendrogram,\n  contourPlot,\n  convexHull,\n  dendrogram,\n  ganttChart,\n  hexagonalBinning,\n  horizongraph,\n  linechart,\n  matrixplot,\n  parallelcoordinates,\n  piechart,\n  radarchart,\n  sankeydiagram,\n  slopechart,\n  streamgraph,\n  sunburst,\n  treemap,\n  violinplot,\n  voronoidiagram,\n  voronoitreemap,\n} from '@rawgraphs/rawgraphs-charts'\n\nimport { calendarHeatmap } from '@rawgraphs/rawgraphs-calendar-heatmap'\n\n// New charts, not included into first release.\n// Comment at necessity.\nlet charts = [\n  alluvialdiagram,\n  arcdiagram,\n  barchart,\n  barchartmultiset,\n  barchartstacked,\n  beeswarm,\n  boxplot,\n  bubblechart,\n  bumpchart,\n  calendarHeatmap,\n  chorddiagram,\n  circlepacking,\n  circularDendrogram,\n  contourPlot,\n  convexHull,\n  dendrogram,\n  ganttChart,\n  hexagonalBinning,\n  horizongraph,\n  linechart,\n  matrixplot,\n  parallelcoordinates,\n  piechart,\n  radarchart,\n  sankeydiagram,\n  slopechart,\n  streamgraph,\n  sunburst,\n  treemap,\n  violinplot,\n  voronoidiagram,\n  voronoitreemap,\n]\n\nexport default charts\n","import React, { useCallback } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { useDropzone } from 'react-dropzone'\nimport classNames from 'classnames'\nimport S from './LoadProject.module.scss'\nimport { deserializeProject } from '@rawgraphs/rawgraphs-core'\nimport charts from '../../../charts'\n\n\nexport default function LoadProject({ onProjectSelected, setLoadingError }) {\n  const onDrop = useCallback(\n    (acceptedFiles) => {\n      const reader = new FileReader()\n      reader.addEventListener('load', (e) => {\n        try {\n          const project = deserializeProject(e.target.result, charts)\n          setLoadingError(null)\n          onProjectSelected(project)\n        } catch (e) {\n          setLoadingError(e.message)\n        }\n      })\n      if (acceptedFiles.length) {\n        reader.readAsText(acceptedFiles[0])\n      }\n    },\n    [onProjectSelected, setLoadingError]\n  )\n  const {\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccept,\n  } = useDropzone({\n    onDrop,\n    accept: '.rawgraphs',\n    maxFiles: 1,\n  })\n  return (\n    <div\n      className={classNames(S.dropzone, {\n        [S.reject]: isDragReject,\n        [S.accept]: isDragAccept,\n      })}\n      {...getRootProps()}\n    >\n      <input {...getInputProps()} />\n      <span>Drag a file here or </span>\n      <Button className={S['browse-button']} color=\"primary\">\n        Browse\n      </Button>\n      <span>a file from your computer</span>\n      {isDragAccept && <p>All files will be accepted</p>}\n      {isDragReject && <p>Some files will be rejected</p>}\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function Paste({ userInput, setUserInput, setLoadingError }) {\n  return (\n    <textarea\n      value={userInput}\n      onChange={(e) => {\n        const str = e.target.value\n        setUserInput(str)\n        setLoadingError(null)\n      }}\n      style={{\n        backgroundColor: 'white',\n        border: '1px solid lightgrey',\n        borderRadius: 4,\n        width: '100%',\n        padding: '1rem',\n        minHeight: '250px',\n        height: '40vh',\n      }}\n    />\n  )\n}\n","import React, { useCallback } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { useDropzone } from 'react-dropzone'\nimport classNames from 'classnames'\nimport S from './UploadFile.module.scss'\n\nexport default function UploadFile({\n  setUserInput,\n  setLoadingError,\n}) {\n  const onDrop = useCallback(\n    (acceptedFiles) => {\n      const reader = new FileReader()\n      reader.addEventListener('load', (e) => {\n        setUserInput(e.target.result)\n        setLoadingError(null)\n      })\n      if (acceptedFiles.length) {\n        reader.readAsText(acceptedFiles[0])\n      }\n    },\n    [setLoadingError, setUserInput]\n  )\n  const {\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccept,\n  } = useDropzone({\n    onDrop,\n    accept:\n      'text/csv,text/plain,application/json,application/vnd.ms-excel,text/tsv,text/tab-separated-values',\n    maxFiles: 1,\n  })\n  return (\n    <div\n      className={classNames(S.dropzone, {\n        [S.reject]: isDragReject,\n        [S.accept]: isDragAccept,\n      })}\n      {...getRootProps()}\n    >\n      <input {...getInputProps()} />\n      <span>Drag a file here or </span>\n      <Button className={S['browse-button']} color=\"primary\">\n        Browse\n      </Button>\n      <span>a file from your computer</span>\n      {isDragAccept && <p>All files will be accepted</p>}\n      {isDragReject && <p>Some files will be rejected</p>}\n    </div>\n  )\n}\n","import React from 'react'\nimport styles from './DataLoader.module.scss'\n\nexport default function Loading() {\n  return (\n    <div className={styles['loading-component']}>\n      <div className={styles['bg-animated']}/>\n      <p>loading...</p>\n    </div>\n  )\n}","import React from 'react'\nimport { Alert } from 'react-bootstrap'\n/**\n *\n * @param {string} type The warning type: success, secondary, warning, danger\n * @param {string} error The error message to be displayed\n */\nfunction WarningMessage({\n  variant = 'warning',\n  message = 'A default warning message.',\n  action = null,\n}) {\n  return (\n    <Alert\n      variant={variant}\n      className=\"my-2 d-flex flex-row justify-content-between align-items-center\"\n    >\n      {message}\n      {action}\n    </Alert>\n  )\n}\n\nexport default WarningMessage\n","import React, { useState } from 'react'\nimport { Modal, Button } from 'react-bootstrap'\n\nfunction DataMismatchModal({\n  replaceRequiresConfirmation,\n  commitDataReplace,\n  cancelDataReplace,\n}) {\n  const [showModal, setShowModal] = useState(true)\n\n  const handleClose = () => {\n    setShowModal(false)\n  }\n  return (\n    <Modal\n      className=\"raw-modal\"\n      show={showModal}\n      onHide={handleClose}\n      backdrop=\"static\"\n      keyboard={false}\n      // size=\"lg\"\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      centered\n    >\n      <Modal.Header>\n        <Modal.Title as=\"h5\">\n          Warning:{' '}\n          {replaceRequiresConfirmation === 'parse-error' && <>parsing error</>}\n          {replaceRequiresConfirmation.startsWith('missing-column:') && (\n            <>missing column</>\n          )}\n          {replaceRequiresConfirmation === 'type-mismatch' && (\n            <>data-type mismatch</>\n          )}\n        </Modal.Title>\n      </Modal.Header>\n\n      <Modal.Body>\n        {replaceRequiresConfirmation === 'parse-error' && (\n          <>\n            <p>There was an error while parsing new data.</p>\n            <p>\n              You can load the new data and try to fix the error or return to\n              the data previously loaded.\n            </p>\n          </>\n        )}\n        {replaceRequiresConfirmation.startsWith('missing-column:') && (\n          <>\n            <p>\n              The data mapping of this project requires the dimension{' '}\n              <span className=\"font-weight-bold\">\n                {replaceRequiresConfirmation.split(':')[1]}\n              </span>\n              , that we can't find in the new data.\n            </p>\n            <p>\n              You can create a new data mapping with the new data or return to\n              the data previously loaded.\n            </p>\n          </>\n        )}\n        {replaceRequiresConfirmation === 'type-mismatch' && (\n          <>\n            <p>\n              The data-types previously set for this project can't be applied to\n              the new data.\n            </p>\n            <p>\n              You can use the new data and re-set data-types or return to the\n              data previously loaded.\n            </p>\n          </>\n        )}\n      </Modal.Body>\n      <Modal.Footer>\n        <Button\n          variant=\"warning\"\n          onClick={() => {\n            commitDataReplace()\n          }}\n        >\n          Load new data\n        </Button>\n        <Button\n          variant=\"secondary\"\n          onClick={() => {\n            cancelDataReplace()\n          }}\n        >\n          Cancel\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nexport default DataMismatchModal\n","import React, { useCallback, useState } from 'react'\nimport { Button } from 'react-bootstrap'\nimport { BsClipboard } from 'react-icons/bs'\nimport { IoMdCheckmarkCircle } from 'react-icons/io'\nimport { useCopyToClipboard } from '../../hooks/useCopyToClipboard'\nimport style from './style.module.css'\n\nexport function CopyToClipboardButton({ content }) {\n  const copyToClipboard = useCopyToClipboard()\n  const [pending, setPending] = useState(false)\n\n  const handleCopy = useCallback(() => {\n    if (!pending) {\n      setPending(true)\n      copyToClipboard(content)\n      setTimeout(() => {\n        setPending(false)\n      }, 3000)\n    }\n  }, [content, copyToClipboard, pending])\n\n  return (\n    <Button\n      variant=\"light\"\n      className={style['copy-to-clipboard-button'] + \" d-flex flex-row align-items-center\"}\n      onClick={handleCopy}\n    >\n      {pending && (\n        <>\n          <IoMdCheckmarkCircle className=\"text-success\" />\n          <span className=\"ml-2\">Copied to clipboard</span>\n        </>\n      )}\n      {!pending && (\n        <>\n          <BsClipboard />\n          <span className=\"ml-2\">Copy to clipboard</span>\n        </>\n      )}\n    </Button>\n  )\n}\n","import ClipboardJS from \"clipboard\";\nimport { useCallback } from \"react\";\n\n\nexport function useCopyToClipboard() {\n  return useCallback((str) => {\n    const btn = document.createElement(\"button\")\n    btn.style.display = \"none\"\n    document.body.appendChild(btn)\n    const clipboard = new ClipboardJS(btn, {\n      text: function() {\n        return str\n      }\n    })\n    btn.focus()\n    btn.click()\n    clipboard.destroy()\n    document.body.removeChild(btn)\n  }, [])\n}","import { get } from 'lodash'\nimport React, { useCallback, useState } from 'react'\nimport { Col, Row } from 'react-bootstrap'\nimport {\n  BsArrowCounterclockwise,\n  BsArrowRepeat,\n  BsClipboard,\n  BsCloud,\n  BsFolder,\n  BsGift,\n  BsSearch,\n  BsUpload,\n} from 'react-icons/bs'\nimport { DATA_LOADER_MODE } from '../../hooks/useDataLoader'\nimport DataGrid from '../DataGrid/DataGrid'\nimport DataSamples from '../DataSamples/DataSamples'\nimport JsonViewer from '../JsonViewer'\nimport ParsingOptions from '../ParsingOptions'\nimport styles from './DataLoader.module.scss'\nimport LoadProject from './loaders/LoadProject'\nimport Paste from './loaders/Paste'\nimport UploadFile from './loaders/UploadFile'\nimport UrlFetch from './loaders/UrlFetch'\nimport Loading from './loading'\nimport WarningMessage from '../WarningMessage'\nimport DataMismatchModal from './DataMismatchModal'\nimport SparqlFetch from './loaders/SparqlFetch'\nimport { tsvFormat } from 'd3-dsv'\nimport { CopyToClipboardButton } from '../CopyToClipboardButton'\n\nfunction DataLoader({\n  userInput,\n  setUserInput,\n  userData,\n  userDataType,\n  parseError,\n  unstackedColumns,\n  separator,\n  setSeparator,\n  thousandsSeparator,\n  setThousandsSeparator,\n  decimalsSeparator,\n  setDecimalsSeparator,\n  locale,\n  setLocale,\n  stackDimension,\n  dataSource,\n  data,\n  loading,\n  coerceTypes,\n  loadSample,\n  handleInlineEdit,\n  handleStackOperation,\n  setJsonData,\n  resetDataLoader,\n  dataLoaderMode,\n  startDataReplace,\n  cancelDataReplace,\n  commitDataReplace,\n  replaceRequiresConfirmation,\n  hydrateFromProject,\n}) {\n  const [loadingError, setLoadingError] = useState()\n  const [initialOptionState, setInitialOptionState] = useState(null)\n\n  const options = [\n    {\n      id: 'paste',\n      name: 'Paste your data',\n      loader: (\n        <Paste\n          userInput={userInput}\n          setUserInput={(rawInput) => setUserInput(rawInput, { type: 'paste' })}\n          setLoadingError={setLoadingError}\n        />\n      ),\n      message:\n        'Copy and paste your data from other applications or websites. You can use tabular (TSV, CSV, DSV) or JSON data.',\n      icon: BsClipboard,\n      allowedForReplace: true,\n    },\n    {\n      id: 'upload',\n      name: 'Upload your data',\n      loader: (\n        <UploadFile\n          userInput={userInput}\n          setUserInput={(rawInput) =>\n            setUserInput(rawInput, { type: 'upload' })\n          }\n          setLoadingError={setLoadingError}\n        />\n      ),\n      message: 'You can load tabular (TSV, CSV, DSV) or JSON data.',\n      icon: BsUpload,\n      allowedForReplace: true,\n    },\n    {\n      id: 'sample',\n      name: 'Try our data samples',\n      message: '',\n      loader: (\n        <DataSamples\n          onSampleReady={loadSample}\n          setLoadingError={setLoadingError}\n        />\n      ),\n      icon: BsGift,\n      allowedForReplace: true,\n    },\n    {\n      id: 'sparql',\n      name: 'SPARQL query',\n      message: 'Load data with a SparQL query',\n      loader: (\n        <SparqlFetch\n          userInput={userInput}\n          setUserInput={(rawInput, source) => setUserInput(rawInput, source)}\n          setLoadingError={setLoadingError}\n          initialState={\n            initialOptionState?.type === 'sparql' ? initialOptionState : null\n          }\n        />\n      ),\n      icon: BsCloud,\n      disabled: false,\n      allowedForReplace: true,\n    },\n    {\n      id: 'url',\n      name: 'From URL',\n      message:\n        'Enter a web address (URL) pointing to the data (e.g. a public Dropbox file, a public API, ...). Please, be sure the server is CORS-enabled.',\n      loader: (\n        <UrlFetch\n          userInput={userInput}\n          setUserInput={(rawInput, source) => setUserInput(rawInput, source)}\n          setLoadingError={setLoadingError}\n          initialState={\n            initialOptionState?.type === 'url' ? initialOptionState : null\n          }\n        />\n      ),\n      icon: BsSearch,\n      disabled: false,\n      allowedForReplace: true,\n    },\n    {\n      id: 'project',\n      name: 'Open your project',\n      message: 'Load a .rawgraphs project.',\n      loader: (\n        <LoadProject\n          onProjectSelected={hydrateFromProject}\n          setLoadingError={setLoadingError}\n        />\n      ),\n      icon: BsFolder,\n      allowedForReplace: false,\n    },\n  ]\n  const [optionIndex, setOptionIndex] = useState(0)\n  const selectedOption = options[optionIndex]\n\n  let mainContent\n  if (userData && data) {\n    mainContent = (\n      <DataGrid\n        userDataset={userData}\n        dataset={data.dataset}\n        errors={data.errors}\n        dataTypes={data.dataTypes}\n        coerceTypes={coerceTypes}\n        onDataUpdate={handleInlineEdit}\n      />\n    )\n  } else if (userDataType === 'json' && userData === null) {\n    mainContent = (\n      <JsonViewer\n        context={JSON.parse(userInput)}\n        selectFilter={(ctx) => Array.isArray(ctx)}\n        onSelect={(ctx, path) => {\n          setJsonData(ctx, path)\n        }}\n      />\n    )\n  } else if (loading && !data) {\n    mainContent = <Loading />\n  } else {\n    mainContent = (\n      <>\n        {selectedOption.loader}\n        <p className=\"mt-3\">\n          {selectedOption.message}\n          {/*<a\n            href=\"https://rawgraphs.io/learning\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Check out our guides\n          </a>*/}\n        </p>\n      </>\n    )\n  }\n\n  // #TODO: memoize/move to component?\n  function parsingErrors(data) {\n    const errors = get(data, 'errors', [])\n    const successRows = data.dataset.length - errors.length\n    const row = errors[0].row + 1\n    const column = Object.keys(errors[0].error)[0]\n    return (\n      <span>\n        Ops, please check <span className=\"font-weight-bold\">row {row}</span> at\n        column <span className=\"font-weight-bold\">{column}</span>.{' '}\n        {errors.length === 2 && (\n          <>\n            {' '}\n            There's another issue at row{' '}\n            <span className=\"font-weight-bold\">{errors[1].row + 1}</span>.{' '}\n          </>\n        )}\n        {errors.length > 2 && (\n          <>\n            {' '}\n            There are issues in{' '}\n            <span className=\"font-weight-bold\">{errors.length - 1}</span> more\n            rows.{' '}\n          </>\n        )}\n        {successRows > 0 && (\n          <>\n            The remaining{' '}\n            <span className=\"font-weight-bold\">\n              {successRows} row{successRows > 1 && <>s</>}\n            </span>{' '}\n            look{successRows === 1 && <>s</>} fine.\n          </>\n        )}\n      </span>\n    )\n  }\n\n  const reloadRAW = useCallback(() => {\n    window.location.replace(window.location.pathname)\n  }, [])\n\n  const copyToClipboardButton = !!userData ? (\n    <CopyToClipboardButton content={tsvFormat(userData)} />\n  ) : null\n\n  return (\n    <>\n      <Row>\n        {!userData && (\n          <Col\n            xs={3}\n            lg={2}\n            className=\"d-flex flex-column justify-content-start pl-3 pr-0 options\"\n          >\n            {options\n              .filter((opt) => {\n                return (\n                  dataLoaderMode !== DATA_LOADER_MODE.REPLACE ||\n                  opt.allowedForReplace\n                )\n              })\n              .map((d, i) => {\n                const classnames = [\n                  'w-100',\n                  'd-flex',\n                  'align-items-center',\n                  'user-select-none',\n                  'cursor-pointer',\n                  styles['loading-option'],\n                  d.disabled ? styles['disabled'] : null,\n                  d.id === selectedOption.id && !userDataType\n                    ? styles.active\n                    : null,\n                  userDataType ? styles.disabled : null,\n                ]\n                  .filter((c) => c !== null)\n                  .join(' ')\n                return (\n                  <div\n                    key={d.id}\n                    className={classnames}\n                    onClick={() => {\n                      setOptionIndex(i)\n                    }}\n                  >\n                    <d.icon className=\"w-25\" />\n                    <h4 className=\"m-0 d-inline-block\">{d.name}</h4>\n                  </div>\n                )\n              })}\n\n            {dataLoaderMode === DATA_LOADER_MODE.REPLACE && (\n              <>\n                <div className=\"divider mb-3 mt-0\" />\n                <div\n                  className={`w-100 mb-2 d-flex justify-content-center align-items-center ${styles['start-over']} user-select-none cursor-pointer`}\n                  onClick={reloadRAW}\n                >\n                  <BsArrowRepeat className=\"mr-2\" />\n                  <h4 className=\"m-0 d-inline-block\">{'Reset'}</h4>\n                </div>\n\n                <div\n                  className={`w-100 d-flex justify-content-center align-items-center ${styles['start-over']} ${styles['cancel']} user-select-none cursor-pointer mb-3`}\n                  onClick={() => {\n                    cancelDataReplace()\n                  }}\n                >\n                  <h4 className=\"m-0 d-inline-block\">{'Cancel'}</h4>\n                </div>\n              </>\n            )}\n          </Col>\n        )}\n        {userData && (\n          <Col\n            xs={3}\n            lg={2}\n            className=\"d-flex flex-column justify-content-start pl-3 pr-0 options\"\n          >\n            <ParsingOptions\n              locale={locale}\n              setLocale={setLocale}\n              separator={separator}\n              setSeparator={setSeparator}\n              thousandsSeparator={thousandsSeparator}\n              setThousandsSeparator={setThousandsSeparator}\n              decimalsSeparator={decimalsSeparator}\n              setDecimalsSeparator={setDecimalsSeparator}\n              dimensions={data ? unstackedColumns || data.dataTypes : []}\n              stackDimension={stackDimension}\n              setStackDimension={handleStackOperation}\n              userDataType={userDataType}\n              dataSource={dataSource}\n              onDataRefreshed={(rawInput) => setUserInput(rawInput, dataSource)}\n            />\n\n            <div className=\"divider mb-3 mt-0\" />\n\n            <div\n              className={`w-100 mb-2 d-flex justify-content-center align-items-center ${styles['start-over']} user-select-none cursor-pointer`}\n              onClick={reloadRAW}\n            >\n              <BsArrowRepeat className=\"mr-2\" />\n              <h4 className=\"m-0 d-inline-block\">{'Reset'}</h4>\n            </div>\n\n            <div\n              className={`w-100 d-flex justify-content-center align-items-center ${styles['start-over']} user-select-none cursor-pointer`}\n              onClick={() => {\n                setInitialOptionState(dataSource)\n                const dataSourceIndex = options.findIndex(\n                  (opt) => opt.id === dataSource?.type\n                )\n                setOptionIndex(Math.max(dataSourceIndex, 0))\n                startDataReplace()\n              }}\n            >\n              <BsArrowCounterclockwise className=\"mr-2\" />\n              <h4 className=\"m-0 d-inline-block\">{'Change data'}</h4>\n            </div>\n          </Col>\n        )}\n        <Col>\n          <Row className=\"h-100\">\n            <Col className=\"h-100\">\n              {mainContent}\n\n              {data && !parseError && get(data, 'errors', []).length === 0 && (\n                <WarningMessage\n                  variant=\"success\"\n                  message={\n                    <span>\n                      <span className=\"font-weight-bold\">\n                        {data.dataset.length} rows\n                      </span>{' '}\n                      (\n                      {data.dataset.length * Object.keys(data.dataTypes).length}{' '}\n                      cells) have been successfully parsed, now you can choose a\n                      chart!\n                    </span>\n                  }\n                  action={copyToClipboardButton}\n                />\n              )}\n\n              {parseError && (\n                <WarningMessage\n                  variant=\"danger\"\n                  message={parseError}\n                  action={copyToClipboardButton}\n                />\n              )}\n\n              {get(data, 'errors', []).length > 0 && (\n                <WarningMessage\n                  variant=\"warning\"\n                  message={parsingErrors(data)}\n                  action={copyToClipboardButton}\n                />\n              )}\n\n              {loadingError && (\n                <WarningMessage\n                  variant=\"danger\"\n                  message={loadingError}\n                  action={copyToClipboardButton}\n                />\n              )}\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n      {replaceRequiresConfirmation && (\n        <DataMismatchModal\n          replaceRequiresConfirmation={replaceRequiresConfirmation}\n          commitDataReplace={commitDataReplace}\n          cancelDataReplace={cancelDataReplace}\n        />\n      )}\n    </>\n  )\n}\n\nexport default React.memo(DataLoader)\n","import React, { useState, useMemo, useCallback } from 'react'\nimport classNames from 'classnames'\nimport { Row, Col, Card, Dropdown } from 'react-bootstrap'\nimport { BsLink, BsPlus } from 'react-icons/bs'\nimport uniq from 'lodash/uniq'\nimport styles from './ChartSelector.module.scss'\nimport { BsFillTrashFill } from 'react-icons/bs'\n\nfunction filterCharts(charts, filter) {\n  return filter === 'All charts'\n    ? charts\n    : charts.filter((d) => d.metadata.categories.indexOf(filter) !== -1)\n}\n\nfunction ChartSelector({\n  availableCharts,\n  currentChart,\n  setCurrentChart,\n  onRemoveCustomChart,\n  onAddChartClick,\n}) {\n  const [filter, setFilter] = useState('All charts')\n\n  const charts = useMemo(() => {\n    return filterCharts(availableCharts, filter)\n  }, [availableCharts, filter])\n\n  const handleFilterChange = useCallback(\n    (nextFilter) => {\n      setFilter(nextFilter)\n      const nextCharts = filterCharts(availableCharts, nextFilter)\n      if (nextCharts.indexOf(currentChart) === -1) {\n        setCurrentChart(nextCharts[0])\n      }\n    },\n    [availableCharts, currentChart, setCurrentChart]\n  )\n\n  return (\n    <>\n      <Row>\n        <Col className=\"text-right\">\n          Show\n          <Dropdown className=\"d-inline-block ml-2 raw-dropdown\">\n            <Dropdown.Toggle variant=\"white\" className=\"pr-5\">\n              {filter.charAt(0).toUpperCase() + filter.slice(1)}\n            </Dropdown.Toggle>\n            <Dropdown.Menu>\n              <Dropdown.Item\n                key={'All charts'}\n                onClick={() => handleFilterChange('All charts')}\n              >\n                All charts\n              </Dropdown.Item>\n              {uniq(\n                availableCharts.map((d) => d.metadata.categories).flat()\n              ).map((d) => {\n                return (\n                  <Dropdown.Item key={d} onClick={() => handleFilterChange(d)}>\n                    {d.charAt(0).toUpperCase() + d.slice(1)}\n                  </Dropdown.Item>\n                )\n              })}\n            </Dropdown.Menu>\n          </Dropdown>\n        </Col>\n      </Row>\n      <Row>\n        <Col xs={3} className=\"pt-3\">\n          {currentChart && (\n            <Card className={styles.currentChart}>\n              <Card.Img variant=\"top\" src={currentChart.metadata.thumbnail} />\n              <Card.Body>\n                <Card.Title className=\"m-0\">\n                  <h2 className=\"m-0\">{currentChart.metadata.name}</h2>\n                </Card.Title>\n                <Card.Subtitle className=\"m-0\">\n                  <h4 className=\"mb-2\">{currentChart.metadata.category}</h4>\n                </Card.Subtitle>\n                <Card.Text>{currentChart.metadata.description}</Card.Text>\n                <Card.Link\n                  className={classNames({\n                    [styles.disabled]: !currentChart.metadata.code,\n                    underlined: true,\n                  })}\n                  href={currentChart.metadata.code}\n                  target=\"_blank\"\n                >\n                  <BsLink color=\"black\" /> Code\n                </Card.Link>\n                <Card.Link\n                  className={classNames({\n                    [styles.disabled]: !currentChart.metadata.tutorial,\n                    underlined: true,\n                  })}\n                  href={currentChart.metadata.tutorial}\n                  target=\"_blank\"\n                >\n                  <BsLink color=\"black\" /> Tutorial\n                </Card.Link>\n              </Card.Body>\n            </Card>\n          )}\n        </Col>\n        <Col>\n          <Row>\n            {charts.map((d, i) => {\n              return (\n                <Col xs={4} key={'chart-' + i} className={`p-3`}>\n                  <Card\n                    onClick={() => {\n                      setCurrentChart(d)\n                    }}\n                    className={classNames('flex-row h-100 cursor-pointer', {\n                      active: d === currentChart ? 'active' : '',\n                      [styles.customChart]: !!d.rawCustomChart,\n                    })}\n                  >\n                    <div\n                      className={`h-100 w-25 ${styles.thumbnail}`}\n                      style={{ backgroundImage: `url(\"${d.metadata.icon}\")` }}\n                    ></div>\n                    <Card.Body className=\"w-75 px-2 py-3\">\n                      <Card.Title className=\"m-0\">\n                        <h2 className=\"m-0\" style={{ whiteSpace: 'nowrap' }}>\n                          {d.metadata.name}\n                        </h2>\n                        {d.rawCustomChart && (\n                          <div>\n                            <button\n                              style={{\n                                position: 'absolute',\n                                top: -8,\n                                right: -8,\n                              }}\n                              className=\"btn btn-sm btn-primary\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                onRemoveCustomChart(d)\n                              }}\n                            >\n                              <BsFillTrashFill />\n                            </button>\n                            <small\n                              style={{\n                                maxWidth: '100%',\n                                overflow: 'hidden',\n                                textOverflow: 'ellipsis',\n                                display: 'block',\n                                whiteSpace: 'nowrap',\n                              }}\n                            >\n                              {d.rawCustomChart.source}\n                            </small>\n                          </div>\n                        )}\n                      </Card.Title>\n                      <Card.Subtitle className=\"m-0\">\n                        <h4 className=\"m-0\">\n                          {d.metadata.categories\n                            .join(', ')\n                            .charAt(0)\n                            .toUpperCase() +\n                            d.metadata.categories.join(', ').slice(1)}\n                        </h4>\n                      </Card.Subtitle>\n                    </Card.Body>\n                  </Card>\n                </Col>\n              )\n            })}\n            <Col xs={4} className={`p-3`}>\n              <Card\n                onClick={() => {\n                  onAddChartClick()\n                }}\n                className={classNames('flex-row h-100 cursor-pointer py-2')}\n              >\n                <div className=\"d-flex align-items-center justify-content-center w-25\">\n                  <BsPlus size={50} color=\"var(--primary)\" />\n                </div>\n                <Card.Body className=\"w-75 px-2 py-3\">\n                  <Card.Title className=\"m-0\">\n                    <h2 className=\"m-0\" style={{ whiteSpace: 'nowrap' }}>\n                      Load custom chart\n                    </h2>\n                  </Card.Title>\n                </Card.Body>\n              </Card>\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n    </>\n  )\n}\n\nexport default React.memo(ChartSelector)\n","import React from 'react'\nimport { dataTypeIcons } from '../../constants'\nimport { getTypeName } from '@rawgraphs/rawgraphs-core'\n\nimport { useDrag } from 'react-dnd'\n\nimport styles from './DataMapping.module.scss'\n\nconst ColumnCard = ({\n  dimensionName,\n  dimensionType,\n  commitLocalMapping,\n  rollbackLocalMapping,\n}) => {\n  const [{ isDragging }, drag] = useDrag({\n    item: { id: dimensionName, type: 'column' },\n    collect: (monitor) => ({\n      isDragging: !!monitor.isDragging(),\n    }),\n    end: (dropResult, monitor) => {\n      const didDrop = monitor.didDrop()\n      if (didDrop) {\n        commitLocalMapping()\n      } else {\n        rollbackLocalMapping()\n      }\n      // console.log('DID DROP', didDrop)\n    },\n  })\n\n  const dimType = getTypeName(dimensionType)\n  const DataTypeIcon = dataTypeIcons[dimType]\n\n  return (\n    <div\n      ref={drag}\n      className={`column-card ${styles['column-card']} ${\n        isDragging ? 'is-dragging' : ''\n      }`}\n    >\n      <DataTypeIcon className={styles['data-type-icon']} />\n      <span className={styles['column-title']}>{dimensionName}</span>\n    </div>\n  )\n}\n\nexport default ColumnCard\n","import React from 'react'\nimport { Tooltip, OverlayTrigger } from 'react-bootstrap'\nimport { dataTypeIcons } from '../../constants'\nimport styles from './DataMapping.module.scss'\n\nfunction DataTypeIcon({ type }) {\n  const DataTypeIcon = dataTypeIcons[type]\n  return (\n    <span>\n      <OverlayTrigger\n        key=\"top\"\n        placement=\"top\"\n        overlay={\n          <Tooltip id={`tooltip-top`}>\n            Accepts {type}s\n          </Tooltip>\n        }\n      >\n        <DataTypeIcon className={styles['accepted-type-icon']} />\n      </OverlayTrigger>\n    </span>\n  )\n}\n\nexport default DataTypeIcon\n","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgAsterisk(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"currentColor\",\n    className: \"bi bi-asterisk\",\n    viewBox: \"0 0 16 16\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8 0a1 1 0 0 1 1 1v5.268l4.562-2.634a1 1 0 1 1 1 1.732L10 8l4.562 2.634a1 1 0 1 1-1 1.732L9 9.732V15a1 1 0 1 1-2 0V9.732l-4.562 2.634a1 1 0 1 1-1-1.732L6 8 1.438 5.366a1 1 0 0 1 1-1.732L7 6.268V1a1 1 0 0 1 1-1z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgAsterisk);\nexport default __webpack_public_path__ + \"static/media/asterisk.a0a42b25.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react'\nimport { ReactComponent as Asterisk } from './asterisk.svg'\nimport { Tooltip, OverlayTrigger } from 'react-bootstrap'\n\nfunction RequiredIcon() {\n  return (\n    <OverlayTrigger\n      key=\"top\"\n      placement=\"top\"\n      overlay={<Tooltip id={`tooltip-top`}>Mandatory</Tooltip>}\n    >\n      <Asterisk width=\"1rem\" height=\"1rem\" style={{marginRight:\"2px\"}} />\n    </OverlayTrigger>\n  )\n}\n\nexport default RequiredIcon\n","import React, { useRef } from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport classnames from 'classnames'\nimport styles from './DataMapping.module.scss'\nimport { BsX } from 'react-icons/bs'\nimport { useDrag, useDrop } from 'react-dnd'\nimport get from 'lodash/get'\nimport { AGGREGATIONS_LABELS } from '../../constants'\n\nexport default function ChartDimensionItem({\n  draggingColumn,\n  index,\n  isValid,\n  DataTypeIcon,\n  columnId,\n  dimension,\n  aggregators,\n  relatedAggregation,\n  onMove,\n\n  onChangeAggregation,\n  onDeleteItem,\n  onChangeDimension,\n\n  commitLocalMapping,\n  rollbackLocalMapping,\n  onInsertColumn,\n  replaceDimension,\n\n  localMappding,\n}) {\n  const ref = useRef(null)\n\n  const [{ isOver }, drop] = useDrop({\n    accept: ['column', 'card'],\n    collect: (monitor) => {\n      return {\n        isOver: monitor.isOver() && monitor.getItem().type === 'column',\n      }\n    },\n    hover(item, monitor) {\n      if (!dimension.multiple) {\n        return\n      }\n      if (!ref.current) {\n        return\n      }\n\n      const hoverIndex = index\n\n      //#TODO: for now we allow only dropping on \"drop another dimension here\" in case of multiple dimensions\n      if (false && item.type === 'column') {\n        onInsertColumn(hoverIndex, item)\n        item.type = 'card'\n        item.dimensionId = dimension.id\n        item.index = hoverIndex\n        return\n      } else if (item.dimensionId === dimension.id) {\n        const dragIndex = item.index\n        // Don't replace items with themselves\n        if (dragIndex === hoverIndex) {\n          return\n        }\n        // Determine rectangle on screen\n        const hoverBoundingRect = ref.current?.getBoundingClientRect()\n        // Get vertical middle\n        const hoverMiddleY =\n          (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2\n        // Determine mouse position\n        const clientOffset = monitor.getClientOffset()\n        // Get pixels to the top\n        const hoverClientY = clientOffset.y - hoverBoundingRect.top\n        // Only perform the move when the mouse has crossed half of the items height\n        // When dragging downwards, only move when the cursor is below 50%\n        // When dragging upwards, only move when the cursor is above 50%\n        // Dragging downwards\n        if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n          return\n        }\n        // Dragging upwards\n        if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n          return\n        }\n        onMove(dragIndex, hoverIndex)\n        // Note: we're mutating the monitor item here!\n        // Generally it's better to avoid mutations,\n        // but it's good here for the sake of performance\n        // to avoid expensive index searches.\n        item.index = hoverIndex\n      } else {\n        //#TODO: for now we allow only dropping on \"drop another dimension here\" in case of multiple dimensions\n\n        // replaceDimension(\n        //   item.dimensionId,\n        //   dimension.id,\n        //   item.index,\n        //   index,\n        //   true\n        // )\n        // item.dimensionId = dimension.id\n        // item.index = hoverIndex\n        return\n      }\n    },\n    drop: (item, monitor) => {\n      if (!dimension.multiple) {\n        if (item.type === 'column') {\n          onChangeDimension(index, item.id)\n        } else {\n          replaceDimension(item.dimensionId, dimension.id, item.index, index)\n        }\n      }\n    },\n  })\n\n  const [{ isDragging }, drag] = useDrag({\n    item: { type: 'card', index, id: columnId, dimensionId: dimension.id },\n    collect: (monitor) => ({\n      isDragging: monitor.isDragging(),\n    }),\n    end: (dropResult, monitor) => {\n      const didDrop = monitor.didDrop()\n      if (didDrop) {\n        commitLocalMapping()\n      } else {\n        rollbackLocalMapping()\n      }\n    },\n  })\n\n  drag(drop(ref))\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        opacity: isDragging || draggingColumn ? 0.5 : 1,\n      }}\n      className={classnames(\n        'assigned-column',\n        styles['column-card'],\n        styles['assigned-column'],\n        isValid ? styles['column-valid'] : styles['column-invalid'],\n        {\n          'border border-danger': isOver,\n          // 'border border-warning': isDragging,\n        }\n      )}\n    >\n      <span>\n        {!!DataTypeIcon && (\n          <DataTypeIcon className={styles['data-type-icon']} />\n        )}\n      </span>\n      <span className={styles['column-title']}>{columnId}</span>\n      {dimension.aggregation && (\n        <Dropdown className=\"d-inline-block ml-2 raw-dropdown\">\n          <Dropdown.Toggle\n            variant={isValid ? 'primary' : 'danger'}\n            className=\"pr-5\"\n          >\n            {get(AGGREGATIONS_LABELS, relatedAggregation, relatedAggregation)}\n          </Dropdown.Toggle>\n          <Dropdown.Menu>\n            {aggregators.map((aggregatorName) => (\n              <Dropdown.Item\n                key={aggregatorName}\n                onClick={() => onChangeAggregation(index, aggregatorName)}\n              >\n                {get(AGGREGATIONS_LABELS, aggregatorName, aggregatorName)}\n              </Dropdown.Item>\n            ))}\n          </Dropdown.Menu>\n        </Dropdown>\n      )}\n      <button\n        className={styles['remove-assigned']}\n        type=\"button\"\n        onClick={() => onDeleteItem(index)}\n      >\n        <BsX />\n      </button>\n    </div>\n  )\n}\n","import React, { useCallback } from 'react'\nimport DataTypeIcon from './DataTypeIcon'\nimport RequiredIcon from './RequiredIcon'\nimport { Col } from 'react-bootstrap'\nimport { useDrop } from 'react-dnd'\nimport get from 'lodash/get'\nimport uniqueId from 'lodash/uniqueId'\nimport classnames from 'classnames'\nimport arrayMove from 'array-move'\nimport arrayInsert from 'array-insert'\n\n// import { DATATYPE_ICONS } from \"../../constants\"\nimport { dataTypeIcons } from '../../constants'\nimport {\n  getTypeName,\n  getAggregatorNames,\n  getDefaultDimensionAggregation,\n} from '@rawgraphs/rawgraphs-core'\nimport ChartDimensionItem from './ChartDimensionItem'\n\nimport styles from './DataMapping.module.scss'\nconst aggregators = getAggregatorNames()\nconst emptyList = []\n\nconst ChartDimensionCard = ({\n  dimension,\n  dataTypes,\n  mapping,\n  setMapping,\n  commitLocalMapping,\n  rollbackLocalMapping,\n  draggingId,\n  setDraggingId,\n  replaceDimension,\n  localMappding,\n}) => {\n  const [{ isOver }, drop] = useDrop({\n    accept: ['column', 'card'],\n    collect: (monitor) => ({\n      isOver: monitor.isOver(),\n    }),\n    drop: (item, monitor) => {\n      if (item.type === 'column') {\n        const defaulAggregation = dimension.aggregation\n          ? getDefaultDimensionAggregation(dimension, dataTypes[item.id])\n          : null\n\n        const columnDataType = getTypeName(dataTypes[item.id]);\n        const isValid =\n          dimension.validTypes?.length === 0 ||\n          dimension.validTypes?.includes(columnDataType)\n\n        setMapping({\n          ...mapping,\n          ids: (mapping.ids || []).concat(uniqueId()),\n          value: [...(mapping.value || []), item.id],\n          isValid: isValid,\n          mappedType: columnDataType,\n          config: dimension.aggregation\n            ? {\n                aggregation: [\n                  ...(get(mapping, 'config.aggregation') || []),\n                  defaulAggregation,\n                ],\n              }\n            : undefined,\n        })\n      } else if (item.dimensionId !== dimension.id) {\n        replaceDimension(\n          item.dimensionId,\n          dimension.id,\n          item.index,\n          mapping.value ? mapping.value.length : 0,\n          true\n        )\n      }\n    },\n  })\n\n  // const [collectedProps, drag] = useDrag({\n  //   item: {\n  //     type: 'card',\n\n  //   }\n  // })\n\n  const setAggregation = useCallback(\n    (newAggregations) => {\n      setMapping({\n        ...mapping,\n        config: { aggregation: [...newAggregations] },\n      })\n    },\n    [mapping, setMapping]\n  )\n\n  const idsMappedHere = get(mapping, 'ids', emptyList)\n  const columnsMappedHere = get(mapping, 'value', emptyList)\n  let aggregationsMappedHere = get(mapping, 'config.aggregation', emptyList)\n\n  const onChangeAggregation = useCallback(\n    (i, aggregatorName) => {\n      const newAggregations = [...aggregationsMappedHere]\n      newAggregations[i] = aggregatorName\n      setAggregation(newAggregations)\n    },\n    [aggregationsMappedHere, setAggregation]\n  )\n\n  const onDeleteItem = useCallback(\n    (i) => {\n      let nextConfig\n      if (mapping.config) {\n        nextConfig = {\n          ...mapping.config,\n          aggregation: mapping.config.aggregation.filter((col, j) => j !== i),\n        }\n      }\n\n      setMapping({\n        ...mapping,\n        ids: mapping.ids.filter((col, j) => j !== i),\n        value: mapping.value.filter((col, j) => j !== i),\n        config: nextConfig,\n      })\n    },\n    [mapping, setMapping]\n  )\n\n  const onChangeDimension = useCallback(\n    (i, newCol) => {\n      setMapping({\n        ...mapping,\n        value: mapping.value.map((col, j) => (j === i ? newCol : col)),\n      })\n    },\n    [mapping, setMapping]\n  )\n\n  const onMove = useCallback(\n    (dragIndex, hoverIndex) => {\n      let nextConfig\n      if (mapping.config) {\n        nextConfig = {\n          ...mapping.config,\n          aggregation: arrayMove(\n            mapping.config.aggregation,\n            dragIndex,\n            hoverIndex\n          ),\n        }\n      }\n\n      setMapping(\n        {\n          ...mapping,\n          ids: arrayMove(mapping.ids, dragIndex, hoverIndex),\n          value: arrayMove(mapping.value, dragIndex, hoverIndex),\n          config: nextConfig,\n        },\n        true\n      )\n    },\n    [mapping, setMapping]\n  )\n\n  const onInsertColumn = useCallback(\n    (index, item) => {\n      const defaulAggregation = dimension.aggregation\n        ? getDefaultDimensionAggregation(dimension, dataTypes[item.id])\n        : null\n\n      const nextId = uniqueId()\n      setDraggingId(nextId)\n      setMapping(\n        {\n          ...mapping,\n          ids: arrayInsert(mapping.ids ?? [], index, nextId),\n          value: arrayInsert(mapping.value ?? [], index, item.id),\n          config: dimension.aggregation\n            ? {\n                aggregation: arrayInsert(\n                  get(mapping, 'config.aggregation', []),\n                  index,\n                  defaulAggregation\n                ),\n              }\n            : undefined,\n        },\n        true\n      )\n    },\n    [dataTypes, dimension, mapping, setDraggingId, setMapping]\n  )\n\n  return (\n    // <div\n    //   className=\"Xcard Xp-3 Xm-2 \"\n    //   style={{ minWidth: 250 }}\n    // >\n\n    <Col xs={6} lg={4} xl={4}>\n      <div className={styles['chart-dimension'] + ' user-select-none'}>\n        {/* This is the card header */}\n        <div\n          className={`d-flex flex-row justify-content-between align-items-center ${styles['chart-dimension-header']}`}\n        >\n          <span className=\"text-left\">\n            {dimension.validTypes.map((t) => {\n              return <DataTypeIcon key={t} type={t} />\n              // const DataTypeIcon = dataTypeIcons[t]\n              // return (\n              //   <span key={t}>\n              //     <DataTypeIcon className={styles['accepted-type-icon']} />\n              //   </span>\n              // )\n            })}\n          </span>\n          <span className=\"text-capitalize text-center\">{dimension.name}</span>\n          <span\n            className={styles['dimension-required'] + ' text-right'}\n            style={{ opacity: dimension.required ? 1 : 0 }}\n          >\n            {dimension.required && <RequiredIcon />}\n          </span>\n        </div>\n\n        {/* These are the columns that have been dropped on the current dimension */}\n        {idsMappedHere.map((renderId, i) => {\n          const columnId = columnsMappedHere[i]\n          const columnDataType = getTypeName(dataTypes[columnId])\n          const relatedAggregation = dimension.aggregation\n            ? aggregationsMappedHere[i] ||\n              getDefaultDimensionAggregation(dimension, columnDataType)\n            : undefined\n          const isValid =\n            dimension.validTypes?.length === 0 ||\n            dimension.validTypes?.includes(columnDataType)\n\n          const DataTypeIcon = dataTypeIcons[getTypeName(dataTypes[columnId])]\n\n          return (\n            <ChartDimensionItem\n              id={renderId}\n              key={renderId}\n              index={i}\n              onMove={onMove}\n              onChangeDimension={onChangeDimension}\n              onChangeAggregation={onChangeAggregation}\n              onDeleteItem={onDeleteItem}\n              isValid={isValid}\n              DataTypeIcon={DataTypeIcon}\n              columnId={columnId}\n              dimension={dimension}\n              aggregators={aggregators}\n              relatedAggregation={relatedAggregation}\n              commitLocalMapping={commitLocalMapping}\n              rollbackLocalMapping={rollbackLocalMapping}\n              onInsertColumn={onInsertColumn}\n              draggingColumn={draggingId === renderId}\n              replaceDimension={replaceDimension}\n              localMappding={localMappding}\n            />\n          )\n        })}\n\n        {/* This is the dropzone */}\n        {(dimension.multiple || columnsMappedHere.length === 0) && (\n          <div\n            className={classnames('dropzone', styles['dropzone'], {\n              [styles['active']]: isOver,\n            })}\n            ref={drop}\n          >\n            {!dimension.multiple && 'Drop dimension here'}\n            {dimension.multiple &&\n              columnsMappedHere.length === 0 &&\n              'Drop dimensions here'}\n            {dimension.multiple &&\n              columnsMappedHere.length > 0 &&\n              'Drop another dimension here'}\n          </div>\n        )}\n      </div>\n    </Col>\n  )\n}\n\nexport default ChartDimensionCard\n","import React, {\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react'\nimport { Row, Col } from 'react-bootstrap'\nimport map from 'lodash/map'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\nimport { DndProvider } from 'react-dnd'\nimport ColumnCard from './ColumnCard'\nimport ChartDimensionCard from './ChartDimensionCard'\nimport get from 'lodash/get'\nimport uniqueId from 'lodash/uniqueId'\nimport arrayInsert from 'array-insert'\nimport { getDefaultDimensionAggregation } from '@rawgraphs/rawgraphs-core'\n\nfunction removeIndex(mapping, i) {\n  let nextConfig\n  if (mapping.config) {\n    nextConfig = {\n      ...mapping.config,\n      aggregation: mapping.config.aggregation.filter((col, j) => j !== i),\n    }\n  }\n\n  return {\n    ...mapping,\n    ids: mapping.ids.filter((col, j) => j !== i),\n    value: mapping.value.filter((col, j) => j !== i),\n    config: nextConfig,\n  }\n}\n\nfunction arrayReplace(arr, i, value) {\n  return arr.map((item, j) => (j === i ? value : item))\n}\n\nfunction handleReplaceLocalMapping(\n  nextId,\n  prev,\n  fromDimension,\n  toDimension,\n  fromIndex,\n  toIndex,\n  dimensions,\n  dataTypes,\n  multiple = false\n) {\n  const removedItem = {}\n  removedItem.aggregation =\n    prev[fromDimension]?.config?.aggregation?.[fromIndex]\n  removedItem.value = prev[fromDimension].value[fromIndex]\n\n  let moveFn = multiple ? arrayInsert : arrayReplace\n\n  const prevToMapping = prev[toDimension] || {}\n  const toDimensionMapping = {\n    ...prevToMapping,\n    ids: moveFn(prevToMapping.ids ?? [], toIndex, nextId),\n    value: moveFn(prevToMapping.value ?? [], toIndex, removedItem.value),\n  }\n\n  const dimension = dimensions[toDimension]\n  if (dimensions.aggregation) {\n    let newAggregation\n    if (removedItem.aggregation) {\n      newAggregation = removedItem.aggregation\n    } else {\n      newAggregation = getDefaultDimensionAggregation(\n        dimension,\n        dataTypes[removedItem.value]\n      )\n    }\n    toDimensionMapping.config = {\n      aggregation: moveFn(\n        get(prevToMapping, 'config.aggregation', []),\n        toIndex,\n        newAggregation\n      ),\n    }\n  }\n  const obj = {\n    ...prev,\n    [fromDimension]: removeIndex(prev[fromDimension], fromIndex),\n    [toDimension]: toDimensionMapping,\n  }\n  return obj\n}\n\nfunction DataMapping({ dataTypes, dimensions, mapping, setMapping }, ref) {\n  const [localMappding, setLocalMapping] = useState(mapping)\n\n  const updateMapping = useCallback(\n    (dimension, mappingConf, isLocal) => {\n      // Local\n      setLocalMapping((prev) => ({\n        ...prev,\n        [dimension]: mappingConf,\n      }))\n      if (!isLocal) {\n        // Gloab mapping\n        setMapping((prev) => ({\n          ...prev,\n          [dimension]: mappingConf,\n        }))\n      }\n    },\n    [setMapping]\n  )\n  const replaceDimension = useCallback(\n    (fromDimension, toDimension, fromIndex, toIndex, multiple = false) => {\n      const nextId = uniqueId()\n      if (multiple) {\n        setDraggingId(nextId)\n      }\n      setLocalMapping((prev) => {\n        return handleReplaceLocalMapping(\n          nextId,\n          prev,\n          fromDimension,\n          toDimension,\n          fromIndex,\n          toIndex,\n          dimensions,\n          dataTypes,\n          multiple\n        )\n      })\n      if (!multiple) {\n        setMapping((prev) => {\n          return handleReplaceLocalMapping(\n            nextId,\n            prev,\n            fromDimension,\n            toDimension,\n            fromIndex,\n            toIndex,\n            dimensions,\n            dataTypes\n          )\n        })\n      }\n    },\n    [dataTypes, dimensions, setMapping]\n  )\n\n  const [draggingId, setDraggingId] = useState(null)\n\n  const rollbackLocalMapping = useCallback(() => {\n    setLocalMapping(mapping)\n    setDraggingId(null)\n  }, [mapping])\n\n  // const commitLocalMapping = useCallback(() => {\n  //   console.log('COMMIT!', localMappding)\n  //   setMapping(localMappding)\n  //   setDraggingId(null)\n  // }, [localMappding, setMapping])\n  const commitLocalMapping = () => {\n    // setMapping()\n    setMapping(lastMapping.current)\n    setDraggingId(null)\n  }\n\n  const lastMapping = useRef()\n  useEffect(() => {\n    lastMapping.current = localMappding\n  })\n\n  useImperativeHandle(ref, () => ({\n    clearLocalMapping: () => {\n      setLocalMapping({})\n    },\n  }))\n\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <Row>\n        <Col xs={3}>\n          <h5 className=\"text-uppercase\">Dimensions</h5>\n          {map(dataTypes, (dataType, columnName) => {\n            return (\n              <ColumnCard\n                key={columnName}\n                dimensionName={columnName}\n                dimensionType={dataType}\n                commitLocalMapping={commitLocalMapping}\n                rollbackLocalMapping={rollbackLocalMapping}\n              />\n            )\n          })}\n        </Col>\n        <Col>\n          <h5 className=\"text-uppercase\">Chart Variables</h5>\n          <Row\n            className=\"sticky-top\"\n            style={{ top: 'calc(var(--header-height) + 16px)' }}\n          >\n            {dimensions.map((d) => {\n              return (\n                <ChartDimensionCard\n                  key={d.id}\n                  dimension={d}\n                  dataTypes={dataTypes}\n                  // mapping={mapping[d.id] || {}}\n                  mapping={localMappding[d.id] || {}}\n                  setMapping={(mappingConf, isLocal = false) =>\n                    updateMapping(d.id, mappingConf, isLocal)\n                  }\n                  commitLocalMapping={commitLocalMapping}\n                  rollbackLocalMapping={rollbackLocalMapping}\n                  draggingId={draggingId}\n                  setDraggingId={setDraggingId}\n                  replaceDimension={replaceDimension}\n                  localMappding={localMappding}\n                />\n              )\n            })}\n          </Row>\n        </Col>\n      </Row>\n    </DndProvider>\n  )\n}\n\nexport default React.memo(React.forwardRef(DataMapping))\n","import React from 'react'\nimport { Row, Col } from 'react-bootstrap'\nimport isObject from 'lodash/isObject'\n\nconst ChartOptionSelect = ({\n  options = [],\n  value,\n  error,\n  onChange,\n  default: defaultValue,\n  label,\n  ...props\n}) => {\n  return (\n    <Row className={props.className}>\n      <Col xs={6} className=\"d-flex align-items-center nowrap\">{label}</Col>\n      <Col xs={6}>\n        <select\n          className=\"custom-select raw-select\"\n          value={value ?? defaultValue}\n          onChange={(e) => {\n            const stringValue = e.target.value\n            const value =\n              props.type === 'number' ? Number(stringValue) : stringValue\n            onChange(value)\n          }}\n        >\n          {options.map((option) =>\n            isObject(option) ? (\n              <option key={option.value} value={option.value}>\n                {option.label}\n              </option>\n            ) : (\n              <option key={option} value={option}>\n                {option}\n              </option>\n            )\n          )}\n        </select>\n        {error && (\n          <small>\n            <i>{error}</i>\n          </small>\n        )}\n      </Col>\n    </Row>\n  )\n}\n\nexport default React.memo(ChartOptionSelect)\n","import React from 'react'\nimport { Row, Col } from 'react-bootstrap'\nimport ChartOptionSelect from './ChartOptionSelect'\n\nconst ChartOptionNumber = ({\n  value,\n  error,\n  onChange,\n  default: defaultValue,\n  label,\n  isEnabled,\n  ...props\n}) => {\n  if (props.options) {\n    return (\n      <ChartOptionSelect\n        value={value}\n        error={error}\n        onChange={onChange}\n        default={defaultValue}\n        disabled={!isEnabled}\n        label={label}\n        {...props}\n      />\n    )\n  }\n  return (\n    <Row className={props.className}>\n      <Col xs={6} className=\"d-flex align-items-center nowrap\">{label}</Col>\n      <Col xs={6}>\n        <input\n          className=\"w-100 form-control text-field\"\n          type=\"number\"\n          value={value ?? ''}\n          step={props.step}\n          min={props.min}\n          max={props.max}\n          disabled={!isEnabled}\n          onChange={(e) => {\n            const str = e.target.value\n            if (str === '') {\n              onChange(undefined)\n            } else {\n              const n = parseFloat(str)\n              if (!isNaN(n)) {\n                onChange(n)\n              } else {\n                onChange(undefined)\n              }\n            }\n          }}\n          placeholder={defaultValue}\n        />\n      </Col>\n      {error && (\n        <small>\n          <i>{error}</i>\n        </small>\n      )}\n    </Row>\n  )\n}\n\nexport default React.memo(ChartOptionNumber)\n","import React from 'react'\nimport ChartOptionSelect from './ChartOptionSelect'\n\nconst ChartOptionText = ({\n  value,\n  error,\n  onChange,\n  default: defaultValue,\n  label,\n  isEnabled,\n  ...props\n}) => {\n  if (props.options) {\n    return (\n      <ChartOptionSelect\n        value={value}\n        error={error}\n        onChange={onChange}\n        default={defaultValue}\n        label={label}\n        {...props}\n      />\n    )\n  }\n  return (\n    <label className=\"d-block\">\n      <b>{label}</b>\n      <br />\n      <input\n        type=\"text\"\n        value={value ?? ''}\n        step={props.step}\n        disabled={!isEnabled}\n        onChange={(e) => {\n          onChange(e.target.value)\n        }}\n        placeholder={defaultValue}\n      />\n      {error && (\n        <small>\n          <i>{error}</i>\n        </small>\n      )}\n    </label>\n  )\n}\n\nexport default React.memo(ChartOptionText)\n","import React, { useState } from 'react'\nimport styles from './InlineColorPicker.module.scss'\nimport { SketchPicker } from 'react-color'\n\nexport default function InlineColorPicker({ color: maybeColor, onChange, disabled }) {\n  const [displayColorPicker, setDisplayColorPicker] = useState(false)\n  const color = maybeColor ?? '#000000' // Same as <input type='color' />\n\n  return (\n    <>\n      <div\n        className={styles.swatch}\n        onClick={() => setDisplayColorPicker(true)}\n      >\n        <div className={styles.color} style={{ background: color }} />\n        {color.toUpperCase()}\n      </div>\n      {displayColorPicker && (\n        <div className={styles.popover}>\n          <div\n            className={styles.cover}\n            onClick={() => setDisplayColorPicker(false)}\n          />\n          <SketchPicker\n            disabled={disabled}\n            disableAlpha\n            color={color}\n            onChangeComplete={(color) => onChange(color.hex)}\n          />\n        </div>\n      )}\n    </>\n  )\n}\n","import React from 'react'\nimport { Col } from 'react-bootstrap'\nimport InilineColorPicker from '../../InlineColorPicker'\nimport ChartOptionSelect from './ChartOptionSelect'\n\nconst ChartOptionColor = ({\n  value,\n  error,\n  onChange,\n  default: defaultValue,\n  label,\n  isEnabled,\n  ...props\n}) => {\n  if (props.options) {\n    return (\n      <ChartOptionSelect\n        value={value}\n        error={error}\n        onChange={onChange}\n        default={defaultValue}\n        label={label}\n        {...props}\n      />\n    )\n  }\n\n  return (\n    <label className={props.className+\" row\"}>\n      <Col xs={6} className=\"d-flex align-items-center\">{label}</Col>\n      <Col xs={6}>\n        <InilineColorPicker disabled={!isEnabled} color={value} onChange={onChange} />\n      </Col>\n      {error && (\n        <small>\n          <i>{error}</i>\n        </small>\n      )}\n    </label>\n  )\n}\n\nexport default React.memo(ChartOptionColor)\n","import React from 'react'\nimport styles from '../ChartOptions.module.scss'\nimport { COLOR_SCHEMES_LABELS } from '../../../constants'\nimport get from 'lodash/get'\n\nconst ColorSchemePreview = ({ label, scale, numSamples=150 }) => {\n  let samples\n  if (scale.ticks) {\n    samples = scale.ticks(numSamples)\n  } else {\n    if(scale.domain){\n      samples = scale.domain()\n    } else {\n      samples = []\n    }\n    \n  }\n  return (\n    <div className={styles['scheme-preview']}>\n      {label && <div style={{marginBottom:2}}>{get(COLOR_SCHEMES_LABELS, label, label)}</div>}\n      <div className=\"d-flex\">\n        {samples.map((sample) => (\n          <div\n            key={'sample-'+sample}\n            style={{ flex: 1, height: 10, background: scale(sample) }}\n          ></div>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default React.memo(ColorSchemePreview)","import React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport ColorSchemePreview from './ColorSchemePreview'\nimport {\n  colorPresets,\n  getColorDomain,\n  getPresetScale\n} from '@rawgraphs/rawgraphs-core'\nimport styles from '../ChartOptions.module.scss'\n\nconst ColorSchemesDropDown = ({\n    interpolators,\n    interpolator,\n    setInterpolator,\n    // To display color-scale preview\n    colorDataset,\n    colorDataType,\n    scaleType,\n    currentFinalScale\n}) => {\n\n  return (\n    <Dropdown className=\"d-inline-block raw-dropdown w-100\">\n      <Dropdown.Toggle variant=\"white\" className=\"w-100\" style={{paddingRight:24}} disabled={!colorDataType}>\n        { currentFinalScale && <ColorSchemePreview\n          scale={currentFinalScale}\n        />}\n      </Dropdown.Toggle>\n      {colorDataType && <Dropdown.Menu className=\"w-100\">\n      {interpolators.map(\n        (intrplr) => {\n          return (\n            <Dropdown.Item key={intrplr} onClick={()=>setInterpolator(intrplr)} className={styles[\"color-scheme-dropdown-item\"]}>\n              { colorDataset[0] && colorPresets[scaleType][interpolator] && \n                <ColorSchemePreview\n                  scale={\n                    getPresetScale(scaleType, getColorDomain(colorDataset, colorDataType, scaleType), intrplr)\n                  }\n                  label={intrplr}\n                />\n              }\n            </Dropdown.Item>\n          )\n        }\n      )}\n      </Dropdown.Menu>}\n    </Dropdown>\n  )\n}\n\nexport default React.memo(ColorSchemesDropDown)","import React from 'react'\nimport { Tooltip, OverlayTrigger } from 'react-bootstrap'\nimport {\n  BsArrowCounterclockwise,\n  BsArrowLeftRight,\n  BsLockFill,\n  BsUnlockFill,\n} from 'react-icons/bs'\n\nfunction ResetBtn({ resetScale }) {\n  return (\n    <OverlayTrigger\n      key=\"bottom\"\n      placement=\"bottom\"\n      overlay={<Tooltip id={`tooltip-top`}>Reset domain</Tooltip>}\n    >\n      <span type=\"button\" className=\"btn\" onClick={resetScale}>\n        <BsArrowCounterclockwise width=\"16\" height=\"16\" />\n      </span>\n    </OverlayTrigger>\n  )\n}\n\nfunction InvertBtn({ invertScale }) {\n  return (\n    <OverlayTrigger\n      key=\"bottom\"\n      placement=\"bottom\"\n      overlay={<Tooltip id={`tooltip-top`}>Invert</Tooltip>}\n    >\n      <span type=\"button\" className=\"btn\" onClick={invertScale}>\n        <BsArrowLeftRight width=\"16\" height=\"16\" />\n      </span>\n    </OverlayTrigger>\n  )\n}\n\nfunction LockBtn({ handleChangeLocked, locked }) {\n  return (\n    <OverlayTrigger\n      key=\"bottom\"\n      placement=\"bottom\"\n      overlay={<Tooltip id={`tooltip-top`}>{locked ? 'Unlock' : 'Lock'} scale</Tooltip>}\n    >\n      <span\n        type=\"button\"\n        className={`btn ${locked ? 'Xbtn-primary' : ''}`}\n        onClick={() => handleChangeLocked(!locked)}\n      >\n        {locked ? <BsUnlockFill width=\"16\" height=\"16\" /> : <BsLockFill width=\"16\" height=\"16\" />}\n      </span>\n    </OverlayTrigger>\n  )\n}\n\nexport { ResetBtn, InvertBtn, LockBtn }\n","import { useRef, useEffect } from 'react'\nexport default function usePrevious(value) {\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef()\n\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value\n  }, [value]) // Only re-run if value changes\n\n  // Return previous value (happens before update in useEffect above)\n  return ref.current\n}\n","import React, { useState, useMemo, useEffect, useCallback, useRef } from 'react'\nimport InilineColorPicker from '../../InlineColorPicker'\nimport ColorSchemesDropDown from './ColorSchemesDropDown'\nimport { Row, Col, Dropdown } from 'react-bootstrap'\nimport { ResetBtn, InvertBtn, LockBtn } from './ColorScaleUtils'\nimport { SCALES_LABELS } from '../../../constants'\nimport get from 'lodash/get'\nimport keyBy from 'lodash/keyBy'\nimport {\n  getInitialScaleValues,\n  getColorScale,\n  getDefaultColorScale,\n  getColorDomain,\n  colorPresets,\n  getAvailableScaleTypes,\n  getValueType,\n} from '@rawgraphs/rawgraphs-core'\nimport styles from '../ChartOptions.module.scss'\nimport usePrevious from '../../../hooks/usePrevious'\n\nfunction getDatePickerValue(userValue) {\n  if (userValue.userDomain === 0) {\n    return 0\n  }\n  if (!userValue.userDomain) {\n    return ''\n  }\n\n  if (getValueType(userValue.userDomain) === 'date') {\n    return userValue.userDomain.toISOString().substring(0, 10)\n  }\n\n  return userValue.userDomain\n}\n\nconst ChartOptionColorScale = ({\n  value,\n  error,\n  onChange,\n  defaultValue,\n  label,\n  dimension,\n  dataset,\n  mapping,\n  dataTypes,\n  chart,\n  mappedData,\n  mappingValue,\n  colorDataset,\n  colorDataType,\n  hasAnyMapping,\n  ...props\n}) => {\n\n  // here we leverage injection of the __loaded prop in the color scale, see App.js\n  const initialValue = useRef(!!value.__loaded)\n  \n  const [scaleType, setScaleType] = useState(get(value, 'scaleType'))\n\n  const defaultColor = useMemo(() => {\n    const colorFromDefault = get(defaultValue, 'defaultColor', '#cccccc')\n    return get(value, 'defaultColor', colorFromDefault)\n  }, [defaultValue, value])\n\n  const [locked, setLocked] = useState(get(value, 'locked'))\n\n  const availableScaleTypes = useMemo(() => {\n    const nextTypes = getAvailableScaleTypes(colorDataType, colorDataset)\n    return nextTypes\n  }, [colorDataType, colorDataset])\n\n  const [interpolators, setInterpolators] = useState(\n    get(value, 'scaleType')\n      ? Object.keys(colorPresets[get(value, 'scaleType')])\n      : []\n  )\n\n  const [interpolator, setInterpolator] = useState(get(value, 'interpolator'))\n  const [userValues, setUserValues] = useState(\n    get(value, 'userScaleValues', []).map((userValue) => ({\n      ...userValue,\n      userDomain: userValue.domain,\n      userRange: userValue.range,\n    }))\n  )\n\n  const getCurrentFinalScale = useCallback(\n    (interpolator, scaleType, userValuesForFinalScale, defaultColor) => {\n      if (\n        !scaleType ||\n        !interpolator ||\n        !colorPresets[scaleType][interpolator] ||\n        !userValuesForFinalScale ||\n        !userValuesForFinalScale.length\n      ) {\n        return\n      }\n\n      const domains = userValuesForFinalScale\n        .map((x) => x.domain)\n        .filter((x) => x !== undefined)\n      if (!domains.length) {\n        return\n      }\n\n      const previewScale = getColorScale(\n        colorDataset, //the array of values of the dataset mapped on the color dimension\n        colorDataType,\n        scaleType, //\n        interpolator,\n        userValuesForFinalScale,\n      )\n\n      return previewScale\n    },\n    [colorDataType, colorDataset]\n  )\n\n  const getDefaultUserValues = useCallback(\n    (interpolator, scaleType) => {\n      if (!colorDataset.length || !colorDataType || !scaleType) {\n        return []\n      }\n      if (!colorPresets[scaleType][interpolator]) {\n        return []\n      }\n\n      const domain = getColorDomain(colorDataset, colorDataType, scaleType)\n\n      return getInitialScaleValues(domain, scaleType, interpolator).map(\n        (userValue) => ({\n          ...userValue,\n          userRange: userValue.range,\n          userDomain: userValue.domain,\n        })\n      )\n    },\n    [colorDataType, colorDataset]\n  )\n\n  const getUserValuesForFinalScale = useCallback(\n    (values) => {\n      return values.map((value) => ({\n        range: value.userRange,\n        domain:\n          colorDataType === 'date'\n            ? value.userDomain?.toString()\n            : value.userDomain,\n        // domain: value.userDomain,\n      }))\n    },\n    [colorDataType]\n  )\n\n  const currentFinalScale = useMemo(() => {\n\n    if (scaleType && interpolator) {\n      const currentUserValues =\n        userValues && userValues.length\n          ? userValues\n          : getDefaultUserValues(interpolator, scaleType)\n      const valuesForFinalScale = getUserValuesForFinalScale(currentUserValues)\n      return getCurrentFinalScale(interpolator, scaleType, valuesForFinalScale)\n    }\n    return getDefaultColorScale()\n  }, [\n    getCurrentFinalScale,\n    getDefaultUserValues,\n    getUserValuesForFinalScale,\n    interpolator,\n    scaleType,\n    userValues,\n  ])\n\n  const handleChangeValues = useCallback(\n    (nextUserValues) => {\n      let valuesForFinalScale = getUserValuesForFinalScale(nextUserValues)\n\n      //notify ui\n      const outScaleParams = {\n        scaleType,\n        interpolator: interpolator,\n        userScaleValues: valuesForFinalScale,\n        defaultColor,\n        locked,\n      }\n      onChange(outScaleParams)\n    },\n    [getUserValuesForFinalScale, scaleType, interpolator, defaultColor, locked, onChange]\n  )\n\n  const setUserValueRange = useCallback(\n    (index, value) => {\n      const newUserValues = [...userValues]\n      newUserValues[index].userRange = value\n      setUserValues(newUserValues)\n      handleChangeValues(newUserValues)\n    },\n    [handleChangeValues, userValues]\n  )\n\n  const setUserValueDomain = useCallback(\n    (index, value) => {\n      const newUserValues = [...userValues]\n      newUserValues[index].userDomain = value\n      setUserValues(newUserValues)\n      handleChangeValues(newUserValues)\n    },\n    [handleChangeValues, userValues]\n  )\n\n\n  const handleChangeScaleType = useCallback(\n    (nextScaleType) => {\n\n      setScaleType(nextScaleType)\n\n      //update interpolators\n      const nextInterpolators = colorPresets[nextScaleType]\n        ? Object.keys(colorPresets[nextScaleType])\n        : []\n      setInterpolators(nextInterpolators)\n\n      //set first interpolator\n      const nextInterpolator = nextInterpolators[0]\n      setInterpolator(nextInterpolator)\n\n      //user values\n      const nextUserValues = getDefaultUserValues(\n        nextInterpolator,\n        nextScaleType,\n      )\n      setUserValues(nextUserValues)\n      const valuesForFinalScale = getUserValuesForFinalScale(nextUserValues)\n\n      //notify ui\n      const outScaleParams = {\n        scaleType: nextScaleType,\n        interpolator: nextInterpolator,\n        userScaleValues: valuesForFinalScale,\n        defaultColor,\n        locked,\n      }\n      onChange(outScaleParams)\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [getDefaultUserValues, getUserValuesForFinalScale, defaultColor, onChange, locked]\n  )\n\n  const handleSetInterpolator = useCallback(\n    (nextInterpolator, customUserValues) => {\n      setInterpolator(nextInterpolator)\n\n      //user values\n      const nextUserValues = getDefaultUserValues(nextInterpolator, scaleType)\n      setUserValues(nextUserValues)\n      let valuesForFinalScale = getUserValuesForFinalScale(nextUserValues)\n      \n      if(customUserValues){\n        const byDomain = keyBy(customUserValues, 'domain')\n        valuesForFinalScale = valuesForFinalScale.map(v => ({\n          ...v,\n          range: byDomain[v.domain.toString()] ? byDomain[v.domain.toString()].userRange : v.range\n        }))\n      }\n      //notify ui\n      const outScaleParams = {\n        scaleType,\n        interpolator: nextInterpolator,\n        userScaleValues: valuesForFinalScale,\n        defaultColor,\n        locked,\n      }\n      onChange(outScaleParams)\n    },\n    [getDefaultUserValues, getUserValuesForFinalScale, onChange, scaleType, defaultColor, locked,]\n  )\n\n  const handleChangeLocked = useCallback(\n    (nextLocked) => {\n      setLocked(nextLocked)\n      //this is needed for disabiling automatic scale reset\n      initialValue.current = true\n\n      const outScaleParams = {\n        scaleType,\n        interpolator,\n        userScaleValues: userValues,\n        defaultColor,\n        locked: nextLocked,\n      }\n      onChange(outScaleParams)\n    },\n    [scaleType, interpolator, userValues, defaultColor, onChange]\n  )\n\n\n\n  const resetScale = useCallback(() => {\n    handleSetInterpolator(interpolator, userValues)\n  }, [handleSetInterpolator, interpolator, userValues])\n\n  const invertScale = useCallback(() => {\n\n    let reversedValues = [...userValues]\n    reversedValues.reverse()\n\n    const invertedValues = userValues.map((v, i) => ({\n      ...v,\n      userRange: reversedValues[i].userRange,\n      range: reversedValues[i].range,\n\n    }))\n\n    setUserValues(invertedValues)\n    handleChangeValues(invertedValues)\n  }, [handleChangeValues, userValues])\n\n\n\n  const prevMappingValue = usePrevious(mappingValue)\n\n  useEffect(() => {\n    if (prevMappingValue && mappingValue !== prevMappingValue) {\n      initialValue.current = false\n    }\n  }, [mappingValue, prevMappingValue])\n\n  useEffect(() => {\n    if (!initialValue.current && !locked) {\n      const nextScaleType = availableScaleTypes[0]\n      handleChangeScaleType(nextScaleType)\n    }\n\n  }, [availableScaleTypes, handleChangeScaleType, locked])\n\n  // update scale on dataset update.\n  // #TODO: fixme\n\n  // const prevDataset = usePrevious(colorDataset)\n  // const prevScaleType = usePrevious(colorDataset)\n\n  // useEffect(() => {\n  //   if (!locked && colorDataset !== prevDataset && prevScaleType === scaleType) {\n  //     console.info(\"dddd resetting scope\")\n  //     const nextUserValues = getDefaultUserValues(\n  //       interpolator,\n  //       scaleType,\n  //     )\n  //     setUserValues(nextUserValues)\n  //     const valuesForFinalScale = getUserValuesForFinalScale(nextUserValues)\n  //     //notify ui\n  //     const outScaleParams = {\n  //       scaleType,\n  //       interpolator,\n  //       userScaleValues: valuesForFinalScale,\n  //       defaultColor,\n  //       locked,\n  //     }\n  //     onChange(outScaleParams)\n  //   }\n  // }, [colorDataset, defaultColor, getDefaultUserValues, getUserValuesForFinalScale, interpolator, locked, onChange, prevDataset, prevScaleType, scaleType])\n\n\n  return hasAnyMapping ? (\n    <>\n      <Row className={props.className} style={{marginTop:'8px', marginBottom:'8px'}}>\n        <Col xs={5} className=\"d-flex align-items-center nowrap\">\n          Color scale\n        </Col>\n        <Col xs={7}>\n          <Dropdown className=\"d-inline-block raw-dropdown w-100\">\n            <Dropdown.Toggle variant=\"white\" className=\"w-100\" style={{paddingRight:24}} disabled={!colorDataType}>\n              {get(SCALES_LABELS, scaleType, scaleType)}\n            </Dropdown.Toggle>\n            <Dropdown.Menu className=\"w-100\">\n            {availableScaleTypes.map(\n              (s) => {\n                return (\n                  <Dropdown.Item key={s} onClick={()=>handleChangeScaleType(s)}>\n                    {get(SCALES_LABELS, s, s)}\n                  </Dropdown.Item>\n                )\n              }\n            )}\n            </Dropdown.Menu>\n          </Dropdown>\n        </Col>\n      </Row>\n\n      {/* Color scheme */}\n      <Row className={[props.className].join(' ')} style={{marginTop:'8px', marginBottom:'8px'}}>\n        <Col xs={5} className=\"d-flex align-items-center nowrap\">\n          Color scheme\n        </Col>\n        <Col xs={7}>\n          <ColorSchemesDropDown\n            interpolators={interpolators}\n            interpolator={interpolator}\n            setInterpolator={handleSetInterpolator}\n            // To display color-scale preview\n            colorDataset={colorDataset}\n            colorDataType={colorDataType}\n            scaleType={scaleType}\n            currentFinalScale={currentFinalScale}\n          />\n        </Col>\n      </Row>\n\n      {/* Scale color swatches */}\n      {colorDataType && userValues && (\n        <div className={styles['color-swatches-list']}>\n          {userValues.map((userValue, i) => (\n            <Row\n              key={i}\n              className={[\n                styles['chart-option'],\n                styles['color-swatch'],\n                scaleType !== 'ordinal'\n                  ? styles['not-ordinal']\n                  : styles['ordinal'],\n              ].join(' ')}\n            >\n              <Col xs={12}>\n                <div className={styles['color-scale-item']}>\n                  {scaleType === 'ordinal' &&\n                    get(userValue, 'domain') !== undefined && (\n                      <span\n                        className=\"nowrap text-truncate pr-2\"\n                        title={userValue.domain && userValue.domain.toString()}\n                      >\n                        {userValue.domain === ''\n                          ? '[empty string]'\n                          : userValue.domain.toString()}\n                      </span>\n                    )}\n                  {scaleType !== 'ordinal' && (\n                    <>\n                      <span className=\"nowrap\">\n                        {i === 0\n                          ? 'Start'\n                          : i === userValues.length - 1\n                            ? 'End'\n                            : 'Middle'}\n                      </span>\n                      <input\n                        disabled={locked}\n                        type={getValueType(userValue.userDomain)}\n                        className=\"form-control text-field\"\n                        value={getDatePickerValue(userValue)}\n                        onChange={(e) => {\n                          if (colorDataType === 'date') {\n                            setUserValueDomain(i, new Date(e.target.value))\n                          } else {\n                            setUserValueDomain(i, e.target.value)\n                          }\n                        }}\n                      ></input>\n                    </>\n                  )}\n                  <InilineColorPicker\n                    color={userValue.userRange}\n                    onChange={(color) => {\n                      setUserValueRange(i, color)\n                    }}\n                  />\n                </div>\n              </Col>\n            </Row>\n          ))}\n          <Row>\n            <Col className=\"d-flex justify-content-end\">\n              <ResetBtn resetScale={resetScale} />\n              <InvertBtn invertScale={invertScale} />\n              {\n                scaleType !== 'ordinal' && (\n                  <LockBtn locked={locked} handleChangeLocked={handleChangeLocked} />\n                )\n              }\n\n            </Col>\n          </Row>\n\n        </div>\n      )}\n\n    </>\n  ) : null\n}\n\nexport default ChartOptionColorScale\n","import React, { useState, useMemo, useEffect, useCallback } from 'react'\nimport InilineColorPicker from '../../InlineColorPicker'\nimport { Col } from 'react-bootstrap'\nimport get from 'lodash/get'\nimport style from '../ChartOptions.module.scss'\n\nconst ChartOptionColorScaleDefault = ({\n  value,\n  error,\n  onChange,\n  default: defaultValue,\n  label,\n  dimension,\n  dataset,\n  mapping,\n  dataTypes,\n  chart,\n  mappedData,\n  mappingValue,\n  colorDataType,\n  colorDataset,\n  ...props\n}) => {\n  const colorFromValue = useMemo(() => {\n    const colorFromDefault = get(defaultValue, 'defaultColor', '#cccccc')\n    return get(value, 'defaultColor', colorFromDefault)\n  }, [defaultValue, value])\n\n  const [defaultColor, setDefaultColor] = useState(colorFromValue)\n\n  const handleChangeDefaultColor = useCallback(\n    (nextDefaultColor) => {\n      setDefaultColor(nextDefaultColor)\n      const outScaleParams = {\n        ...value,\n        defaultColor: nextDefaultColor,\n      }\n      onChange(outScaleParams)\n    },\n    [value, onChange]\n  )\n\n  useEffect(() => {\n    if (defaultValue && defaultValue.defaultColor !== defaultColor) {\n      handleChangeDefaultColor(defaultValue.defaultColor)\n    }\n  }, [defaultColor, defaultValue, handleChangeDefaultColor])\n\n  return (\n    <>\n      <label className={[style['chart-option'], 'row'].join(' ')}>\n        <Col xs={6} className=\"d-flex align-items-center\">\n          Default\n        </Col>\n        <Col xs={6}>\n          <InilineColorPicker\n            color={defaultColor}\n            onChange={handleChangeDefaultColor}\n          />\n        </Col>\n      </label>\n    </>\n  )\n}\n\nexport default ChartOptionColorScaleDefault\n","import React, { useMemo } from 'react'\nimport ChartOptionColorScale from './ChartOptionColorScale'\nimport ChartOptionColorScaleDefault from './ChartOptionColorScaleDefault'\n\nconst ChartOptionColorScaleWrapper = ({\n  value,\n  onChange,\n  default: defaultValue,\n  mappingValue,\n  colorDataType,\n  colorDataset,\n\n}) => {\n\n  const hasAnyMapping = useMemo(() => {\n    return colorDataset && colorDataset.length > 0\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [colorDataset])\n\n  return <>\n    {!hasAnyMapping && <ChartOptionColorScaleDefault onChange={onChange} defaultValue={defaultValue} value={value} />}\n    {hasAnyMapping &&  <ChartOptionColorScale hasAnyMapping={hasAnyMapping} mappingValue={mappingValue} defaultValue={defaultValue} value={value} colorDataType={colorDataType} colorDataset={colorDataset} onChange={onChange} />}\n  </>\n}\n\nexport default ChartOptionColorScaleWrapper\n","import React from 'react'\nimport { Row, Col, Form } from 'react-bootstrap'\n\nconst ChartOptionBoolean = ({ optionId, label, value, error, onChange, className, isEnabled }) => {\n  return (\n    <Row className={className}>\n      <Col xs={6} className=\"d-flex align-items-center nowrap\">{label}</Col>\n      <Form className=\"col-6 d-flex align-items-center\">\n        <Form.Check\n          type=\"switch\"\n          checked={!!value}\n          disabled={!isEnabled}\n          onChange={(e) => {\n            onChange(e.target.checked)\n          }}\n          id={optionId}\n          label={value ? 'Yes' : 'No'}\n        />\n      </Form>\n      {error && (\n        <div className=\"col-12\">\n          <small>\n            <i>{error}</i>\n          </small>\n        </div>\n      )}\n    </Row>\n  )\n}\n\nexport default React.memo(ChartOptionBoolean)\n","import React, { useCallback, useState, useMemo } from 'react'\nimport { Row, Col } from 'react-bootstrap'\nimport {\n  getOptionsConfig,\n  getContainerOptions,\n  getDefaultOptionsValues,\n  getEnabledOptions,\n  getTypeName,\n} from '@rawgraphs/rawgraphs-core'\nimport ChartOptionNumber from './ChartOptionTypes/ChartOptionNumber'\nimport ChartOptionText from './ChartOptionTypes/ChartOptionText'\nimport ChartOptionColor from './ChartOptionTypes/ChartOptionColor'\nimport ChartOptionColorScaleWrapper from './ChartOptionTypes/ChartOptionColorScaleWrapper'\nimport ChartOptionBoolean from './ChartOptionTypes/ChartOptionBoolean'\nimport get from 'lodash/get'\nimport map from 'lodash/map'\nimport styles from './ChartOptions.module.scss'\nimport omit from 'lodash/omit'\n\nconst CHART_OPTION_COMPONENTS = {\n  number: ChartOptionNumber,\n  text: ChartOptionText,\n  color: ChartOptionColor,\n  colorScale: ChartOptionColorScaleWrapper,\n  boolean: ChartOptionBoolean,\n}\n\nfunction getPartialMapping(mapping, dimension, repeatIndex) {\n  const nv = get(mapping[dimension], `value[${repeatIndex}]`)\n  return {\n    ...mapping,\n    [dimension]: {\n      ...mapping[dimension],\n      value: [nv],\n    },\n  }\n}\n\nfunction getPartialMappedData(mappedData, dimension, repeatIndex) {\n  return Array.isArray(mappedData)\n    ? mappedData.map((datum) => {\n        const value = get(datum[dimension], `[${repeatIndex}]`)\n        return {\n          ...datum,\n          [dimension]: value,\n        }\n      })\n    : mappedData\n}\n\nfunction getDefaultForRepeat(def, index) {\n  if (Array.isArray(def.repeatDefault)) {\n    return get(def.repeatDefault, `[${index}]`, def.default)\n  }\n  return def.default\n}\n\nfunction WrapControlComponent({\n  type,\n  optionId,\n  setVisualOptions,\n  label,\n  repeatIndex,\n  ...props\n}) {\n  const Component = CHART_OPTION_COMPONENTS[type]\n\n  const remainingOptions = useMemo(() => {\n    if (type !== 'colorScale') {\n      return null\n    }\n\n    return Object.keys(omit(props.visualOptions, optionId))\n      .map((k) => JSON.stringify(get(props.visualOptions, k, '')))\n      .join('-')\n  }, [type, props.visualOptions, optionId])\n\n  const domainFromChart = useMemo(() => {\n    if (type !== 'colorScale') {\n      return null\n    }\n    if (props.domain && props.chart[props.domain]) {\n      //as sometimes the current chart is not in synch with current options (chart is set before options, we just handle an exception)\n      //everything should be ok on the next render.\n      try {\n        const domain = props.chart[props.domain](\n          props.mappedData,\n          props.mapping,\n          props.visualOptions\n        )\n        return domain\n      } catch (e) {\n        return null\n      }\n    } else {\n      return null\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    type,\n    props.chart,\n    props.domain,\n    props.mappedData,\n    props.mapping,\n    remainingOptions,\n  ])\n\n  const mappingValue = useMemo(() => {\n    if (type !== 'colorScale') {\n      return null\n    }\n    return domainFromChart\n      ? '__custom__'\n      : get(props.mapping, `[${props.dimension}].value`)\n  }, [domainFromChart, props.dimension, props.mapping, type])\n\n  const colorDataType = useMemo(() => {\n    if (type !== 'colorScale') {\n      return null\n    }\n    if (domainFromChart) {\n      return domainFromChart.type\n    }\n    return props.dataTypes[mappingValue]\n      ? getTypeName(props.dataTypes[mappingValue])\n      : 'string'\n  }, [type, props.dataTypes, domainFromChart, mappingValue])\n\n  const colorDataset = useMemo(() => {\n    if (type !== 'colorScale') {\n      return null\n    }\n    if (domainFromChart) {\n      return domainFromChart.domain\n    }\n\n    if (props.mappedData) {\n      return props.mappedData\n        .map((d) => get(d, props.dimension))\n        .filter(\n          (item) => item !== undefined && !(Array.isArray(item) && !item.length)\n        )\n    } else {\n      return []\n    }\n  }, [type, props.dimension, domainFromChart, props.mappedData])\n\n  const handleControlChange = useCallback(\n    (nextValue) => {\n      setVisualOptions((visualOptions) => {\n        let newValue = nextValue\n        if (repeatIndex !== undefined) {\n          newValue = visualOptions[optionId] || []\n          newValue[repeatIndex] = nextValue\n        }\n        return {\n          ...visualOptions,\n          [optionId]: newValue,\n        }\n      })\n    },\n    [optionId, repeatIndex, setVisualOptions]\n  )\n\n  return (\n    <Component\n      type={type}\n      domainFromChart={domainFromChart}\n      mappingValue={mappingValue}\n      colorDataType={colorDataType}\n      colorDataset={colorDataset}\n      optionId={optionId}\n      label={\n        repeatIndex !== undefined ? (\n          <React.Fragment>\n            {label} ({repeatIndex + 1})\n          </React.Fragment>\n        ) : (\n          label\n        )\n      }\n      {...omit(props, [\n        'mapping',\n        'visualOptions',\n        'chart',\n        'dataset',\n        'dataTypes',\n        'mappedData',\n      ])}\n      onChange={handleControlChange}\n    />\n  )\n}\n\nconst ChartOptions = ({\n  chart,\n  dataset,\n  mapping,\n  dataTypes,\n  visualOptions,\n  setVisualOptions,\n  error,\n  mappedData,\n}) => {\n  const optionsConfig = useMemo(() => {\n    return getOptionsConfig(chart?.visualOptions)\n  }, [chart])\n\n  const [collapseStatus, setCollapseStatus] = useState(() => {\n    const groups = {}\n    for (const option in optionsConfig) {\n      const group = optionsConfig[option].group\n      if (!groups.hasOwnProperty(group)) {\n        groups[group] = true\n      }\n    }\n    return groups\n  })\n\n  const enabledOptions = useMemo(() => {\n    return getEnabledOptions(optionsConfig, visualOptions, mapping)\n  }, [optionsConfig, visualOptions, mapping])\n\n  // const enabledGroupsByName = useMemo(() => {\n  //   const enabledGroupsNames = Object.keys(optionsConfig).map(optionName => enabledOptions[optionName] ? optionsConfig[optionName].group : null).filter(x => !!x)\n  //   return mapValues(keyBy(enabledGroupsNames), x => true)\n  // }, [enabledOptions, optionsConfig])\n  // // #TODO we can use enabledGroupsByName to disable the group\n\n  const optionsDefinitionsByGroup = useMemo(() => {\n    // update \"collapseStatus\" state\n    // add/remove options groups when selected charts changes\n    const groups = {}\n    for (const option in optionsConfig) {\n      const group = optionsConfig[option].group\n      if (!groups.hasOwnProperty(group)) {\n        groups[group] = group === 'artboard' ? false : true\n      }\n    }\n    setCollapseStatus(groups)\n    return Object.keys(optionsConfig).reduce((acc, optionId) => {\n      const option = optionsConfig[optionId]\n      const group = option?.group || ''\n      if (!acc[group]) {\n        acc[group] = {}\n      }\n      acc[group][optionId] = option\n      return acc\n    }, {})\n  }, [optionsConfig])\n\n  const containerOptions = useMemo(() => {\n    const defaultOptionsValues = getDefaultOptionsValues(optionsConfig, mapping)\n    const opts = {\n      ...defaultOptionsValues,\n      ...visualOptions,\n    }\n    return getContainerOptions(optionsConfig, opts)\n  }, [mapping, optionsConfig, visualOptions])\n\n  return (\n    <div className={[styles['chart-options'], 'col-4', 'col-xl-3'].join(' ')}>\n      {map(optionsDefinitionsByGroup, (options, groupName) => {\n        return (\n          <div\n            key={groupName}\n            groupname={groupName}\n            className={[\n              styles['options-group'],\n              collapseStatus[groupName] ? styles['collapsed'] : '',\n            ].join(' ')}\n          >\n            <Row className=\"sticky-top\">\n              <Col\n                className={`d-flex justify-content-between align-items-center ${styles['group-header']}`}\n              >\n                <h5 className=\"text-uppercase m-0\">{groupName}</h5>\n                <span\n                  className={[styles['collapse-button'], 'cursor-pointer'].join(\n                    ' '\n                  )}\n                  onClick={() =>\n                    setCollapseStatus({\n                      ...collapseStatus,\n                      [groupName]: !collapseStatus[groupName],\n                    })\n                  }\n                ></span>\n              </Col>\n            </Row>\n            {map(options, (def, optionId) => {\n              // repeated options: notice that value is set to a default if undefined\n              // this is caused by changes in shapes of the mapping object\n              // (when a new value is dragged to the dimension that repeats the option)\n              // the same approach is applied in option validation by the raw core lib\n              return def.repeatFor ? (\n                get(\n                  mapping,\n                  `[${def.repeatFor}].value`,\n                  []\n                ).map((v, repeatIndex) => (\n                  <WrapControlComponent\n                    className={styles['chart-option']}\n                    key={optionId + repeatIndex}\n                    repeatIndex={repeatIndex}\n                    {...def}\n                    optionId={optionId}\n                    error={error?.errors?.[optionId + repeatIndex]}\n                    value={\n                      visualOptions?.[optionId]?.[repeatIndex] ??\n                      getDefaultForRepeat(def, repeatIndex)\n                    }\n                    mapping={\n                      def.type === 'colorScale'\n                        ? getPartialMapping(mapping, def.repeatFor, repeatIndex)\n                        : undefined\n                    }\n                    chart={def.type === 'colorScale' ? chart : undefined}\n                    dataset={def.type === 'colorScale' ? dataset : undefined}\n                    dataTypes={\n                      def.type === 'colorScale' ? dataTypes : undefined\n                    }\n                    visualOptions={\n                      def.type === 'colorScale' ? visualOptions : undefined\n                    }\n                    mappedData={getPartialMappedData(\n                      mappedData,\n                      def.repeatFor,\n                      repeatIndex\n                    )}\n                    setVisualOptions={setVisualOptions}\n                    isEnabled={enabledOptions[optionId]}\n                  />\n                ))\n              ) : (\n                <WrapControlComponent\n                  className={styles['chart-option']}\n                  key={optionId}\n                  {...def}\n                  optionId={optionId}\n                  error={error?.errors?.[optionId]}\n                  value={visualOptions?.[optionId]}\n                  mapping={def.type === 'colorScale' ? mapping : undefined}\n                  chart={def.type === 'colorScale' ? chart : undefined}\n                  dataset={def.type === 'colorScale' ? dataset : undefined}\n                  dataTypes={def.type === 'colorScale' ? dataTypes : undefined}\n                  visualOptions={\n                    def.type === 'colorScale' ? visualOptions : undefined\n                  }\n                  mappedData={mappedData}\n                  setVisualOptions={setVisualOptions}\n                  isEnabled={enabledOptions[optionId]}\n                />\n              )\n            })}\n            {groupName === 'artboard' && visualOptions.showLegend && (\n              <p className=\"small\">\n                The final output will be {containerOptions?.width}px *{' '}\n                {containerOptions?.height}px including the legend.\n              </p>\n            )}\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport default ChartOptions\n","/**\n * @typedef {{\n *  name: string\n *  id: string\n *  description: string\n *  code: string\n *  categories: string[]\n *  tutorial?: string\n * }} chartMetadata\n */\n\n/**\n * @type string | null\n */\nlet prevChartIdRendered = null\n\n/**\n * @param {ChartMetada} chartMetadata\n */\nexport function onChartRendered(chartMetadata) {\n  if (prevChartIdRendered === chartMetadata.id) {\n    // Nothing to report the chart still the same\n    return\n  }\n  prevChartIdRendered = chartMetadata.id\n\n  if (typeof window.gtag === 'function') {\n    window.gtag('event', 'chart-render', {\n      event_category: chartMetadata.id,\n    })\n  }\n}\n\n/**\n * @param {chartMetadata} chartMetadata\n * @param {string} format\n */\nexport function onChartExported(chartMetadata, format) {\n  if (typeof window.gtag === 'function') {\n    window.gtag('event', 'chart-export', {\n      event_category: chartMetadata.id,\n      event_label: format,\n    })\n  }\n}\n","import React, { useRef, useEffect } from 'react'\nimport { chart as rawChart } from '@rawgraphs/rawgraphs-core'\nimport useDebounce from '../../hooks/useDebounce'\nimport WarningMessage from '../WarningMessage'\nimport { onChartRendered } from '../../gaEvents'\n\nconst ChartPreview = ({\n  chart,\n  dataset: data,\n  dataTypes,\n  mapping,\n  visualOptions,\n  error,\n  setError,\n  setRawViz,\n  mappedData,\n}) => {\n  const domRef = useRef(null)\n\n  const vizOptionsDebounced = useDebounce(visualOptions, 200)\n\n  useEffect(() => {\n    setError(null)\n\n    // control required variables\n    // need to create this array because the prop mapping does not return to {} when data is inserted and removed\n    const currentlyMapped = []\n    for (let variable in mapping) {\n      if (mapping[variable].ids && mapping[variable].ids.length > 0) {\n        currentlyMapped.push(variable)\n      }\n    }\n\n    let requiredVariables = chart.dimensions.filter(\n      (d) => d.required && currentlyMapped.indexOf(d.id) === -1\n    )\n\n    if (requiredVariables.length > 0) {\n      let errorMessage = (\n        <span>\n          Required chart variables: you need to map{' '}\n          {requiredVariables\n            .map((d, i) => <span key={i} className=\"font-weight-bold\">{d.name}</span>)\n            .reduce((prev, curr) => [prev, ' and ', curr])}\n        </span>\n      )\n      setError({ variant: 'secondary', message: errorMessage })\n      setRawViz(null)\n      while (domRef.current.firstChild) {\n        domRef.current.removeChild(domRef.current.firstChild)\n      }\n      return\n    }\n\n    // control multiple required variables\n    const multivaluesVariables = chart.dimensions.filter(\n      (d) =>\n        d.multiple &&\n        d.required &&\n        d.minValues &&\n        mapping[d.id].ids.length < d.minValues\n    )\n    if (multivaluesVariables.length > 0) {\n      let errorMessage = (\n        <span>\n          Please map{' '}\n          {multivaluesVariables\n            .map((d) => (\n              <>\n                at least <span className=\"font-weight-bold\">{d.minValues}</span>{' '}\n                dimensions on <span className=\"font-weight-bold\">{d.name}</span>\n              </>\n            ))\n            .reduce((prev, curr) => [prev, ' and ', curr])}\n          .\n        </span>\n      )\n      setError({ variant: 'secondary', message: errorMessage })\n      setRawViz(null)\n      while (domRef.current.firstChild) {\n        domRef.current.removeChild(domRef.current.firstChild)\n      }\n      return\n    }\n\n    // control data-types mismatches\n    for (let variable in mapping) {\n      if (\n        mapping[variable].ids &&\n        mapping[variable].ids.length > 0 &&\n        !mapping[variable].isValid\n      ) {\n        const variableObj = chart.dimensions.find((d) => d.id === variable)\n        const errorMessage = `Data-type mismatch: you can’t map ${mapping[variable].mappedType}s on ${variableObj.name}.`\n        setError({ variant: 'danger', message: errorMessage })\n        setRawViz(null)\n        while (domRef.current.firstChild) {\n          domRef.current.removeChild(domRef.current.firstChild)\n        }\n        return\n      }\n    }\n\n    if (!mappedData) {\n      // console.info('Clearing viz')\n      setRawViz(null)\n      while (domRef.current.firstChild) {\n        domRef.current.removeChild(domRef.current.firstChild)\n      }\n      return\n    }\n    // console.info('Updating viz')\n    try {\n      const viz = rawChart(chart, {\n        data,\n        mapping: mapping,\n        dataTypes,\n        visualOptions: vizOptionsDebounced,\n      })\n      try {\n        const rawViz = viz.renderToDOM(domRef.current, mappedData)\n        setRawViz(rawViz)\n        setError(null)\n        onChartRendered(chart.metadata)\n      } catch (e) {\n        console.log(\"chart error\", e)\n        setError({ variant: 'danger', message: 'Chart error. ' + e.message })\n        setRawViz(null)\n      }\n    } catch (e) {\n      while (domRef.current.firstChild) {\n        domRef.current.removeChild(domRef.current.firstChild)\n      }\n      console.log({ e })\n      setError({ variant: 'danger', message: 'Chart error. ' + e.message })\n      setRawViz(null)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setError, vizOptionsDebounced, setRawViz, mappedData, chart, mapping])\n\n  return (\n    <div className={'col-8 col-xl-9'}>\n      <div\n        className={['overflow-auto', 'position-sticky'].join(' ')}\n        style={{ top: 'calc(15px + var(--header-height))' }}\n      >\n        {error && (\n          <WarningMessage variant={error.variant} message={error.message} />\n        )}\n        <div ref={domRef}>{/* Don't put content in this <div /> */}</div>\n      </div>\n    </div>\n  )\n}\n\nexport default React.memo(ChartPreview)\n","import { useEffect, useState } from 'react'\n\nexport default function useDebounce(value, delay) {\n  // State and setters for debounced value\n  const [debouncedValue, setDebouncedValue] = useState(value)\n\n  useEffect(\n    () => {\n      // Update debounced value after delay\n      const handler = setTimeout(() => {\n        setDebouncedValue(value)\n      }, delay)\n\n      // Cancel the timeout if value changes (also on delay change or unmount)\n      // This is how we prevent debounced value from updating if value is changed ...\n      // .. within the delay period. Timeout gets cleared and restarted.\n      return () => {\n        clearTimeout(handler)\n      }\n    },\n    [value, delay] // Only re-call effect if value or delay changes\n  )\n\n  return debouncedValue\n}\n","import React, { useState, useEffect } from 'react'\nimport { Row } from 'react-bootstrap'\nimport ChartOptions from '../ChartOptions'\nimport ChartPreview from '../ChartPreview'\nimport { chart as rawChart } from '@rawgraphs/rawgraphs-core'\nimport { mapDataInWorker } from '../../worker'\nimport { WEBWORKER_ACTIVE } from '../../constants'\n\nconst ChartPreviewWithOptions = ({\n  chart,\n  dataset,\n  dataTypes,\n  mapping,\n  visualOptions,\n  setVisualOptions,\n  setRawViz,\n  setMappingLoading,\n}) => {\n  const [error, setError] = useState({variant: \"secondary\", message: \"Required chart variables\"})\n  const [mappedData, setMappedData] = useState(null)\n\n  useEffect(() => {\n    // console.info('Updating mapped dataset')\n    try {\n      setMappingLoading(true)\n\n      if (WEBWORKER_ACTIVE) {\n        mapDataInWorker(chart.metadata.name, {\n          data: dataset,\n          mapping: mapping,\n          dataTypes,\n        }, chart.rawCustomChart)\n          .then((mappedData) => {\n            setMappingLoading(false)\n            setMappedData(mappedData)\n          })\n          .catch((err) => {\n            console.error(err)\n            setMappingLoading(false)\n            setMappedData(null)\n          })\n      } else {\n        const viz = rawChart(chart, {\n          data: dataset,\n          mapping: mapping,\n          dataTypes,\n        })\n        const vizData = viz._getVizData()\n        setMappingLoading(false)\n        setMappedData(vizData)\n      }\n    } catch (e) {\n      console.error(e)\n      setMappingLoading(false)\n      setMappedData(null)\n    }\n  }, [\n    chart,\n    mapping,\n    dataTypes,\n    setError,\n    setRawViz,\n    setMappingLoading,\n    dataset,\n  ])\n\n  return (\n    <Row>\n        <ChartOptions\n          chart={chart}\n          dataset={dataset}\n          mapping={mapping}\n          dataTypes={dataTypes}\n          visualOptions={visualOptions}\n          setVisualOptions={setVisualOptions}\n          error={error}\n          mappedData={mappedData}\n        />\n        <ChartPreview\n          chart={chart}\n          dataset={dataset}\n          dataTypes={dataTypes}\n          mapping={mapping}\n          visualOptions={visualOptions}\n          error={error}\n          setError={setError}\n          setRawViz={setRawViz}\n          mappedData={mappedData}\n        />\n    </Row>\n  )\n}\n\nexport default ChartPreviewWithOptions\n","import React, { useCallback, useState } from 'react'\nimport { InputGroup, DropdownButton, Dropdown } from 'react-bootstrap'\nimport { onChartExported } from '../../gaEvents'\n\nfunction downloadBlob(url, filename) {\n  // Create a new anchor element\n  const a = document.createElement('a')\n  a.href = url\n  a.download = filename || 'download'\n  a.click()\n  return a\n}\n\nexport default function Exporter({ rawViz, exportProject }) {\n  const downloadSvg = useCallback(\n    (filename) => {\n      var svgString = new XMLSerializer().serializeToString(\n        rawViz._node.firstChild\n      )\n      var DOMURL = window.URL || window.webkitURL || window\n      var svg = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' })\n      var url = DOMURL.createObjectURL(svg)\n      downloadBlob(url, filename)\n      DOMURL.revokeObjectURL(svg)\n    },\n    [rawViz]\n  )\n\n  const downloadImage = useCallback(\n    (format, filename) => {\n      var svgString = new XMLSerializer().serializeToString(\n        rawViz._node.firstChild\n      )\n      var DOMURL = window.URL || window.webkitURL || window\n      var svg = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' })\n      var url = DOMURL.createObjectURL(svg)\n      var canvas = document.createElement('canvas')\n      canvas.height = rawViz._node.firstChild.clientHeight\n      canvas.width = rawViz._node.firstChild.clientWidth\n      var ctx = canvas.getContext('2d')\n      var img = new Image()\n      img.onload = function () {\n        ctx.drawImage(img, 0, 0)\n        var dataUrl = canvas.toDataURL(format)\n        downloadBlob(dataUrl, filename)\n        DOMURL.revokeObjectURL(svg)\n      }\n      img.src = url\n    },\n    [rawViz]\n  )\n\n  const downloadProject = useCallback(\n    async (filename) => {\n      const project = await exportProject()\n      const str = JSON.stringify(project)\n      const blob = new Blob([str], { type: 'application/json' })\n      const DOMURL = window.URL || window.webkitURL || window\n      const url = DOMURL.createObjectURL(blob)\n      downloadBlob(url, filename)\n      DOMURL.revokeObjectURL(url)\n    },\n    [exportProject]\n  )\n\n  const exportFormats = ['svg', 'png', 'jpg', 'rawgraphs']\n\n  const [currentFormat, setCurrentFormat] = useState('svg')\n  const [currentFile, setCurrentFile] = useState('viz')\n\n  const downloadViz = useCallback(() => {\n    switch (currentFormat) {\n      case 'svg':\n        downloadSvg(`${currentFile}.svg`)\n        break\n      case 'png':\n        downloadImage('image/png', `${currentFile}.png`)\n        break\n      case 'jpg':\n        downloadImage('image/jpeg', `${currentFile}.jpg`)\n        break\n      case 'rawgraphs':\n        downloadProject(`${currentFile}.rawgraphs`)\n        break\n      default:\n        break\n    }\n    // TODO: Make a getter for _chartImplementation\n    onChartExported(rawViz._chartImplementation.metadata, currentFormat)\n  }, [\n    currentFile,\n    currentFormat,\n    downloadImage,\n    downloadProject,\n    downloadSvg,\n    rawViz,\n  ])\n\n  return (\n    <div className=\"row\">\n      <div className=\"col col-sm-3\">\n        <InputGroup className=\"mb-3 raw-input-group\">\n          <input\n            type=\"text\"\n            className=\"form-control text-field\"\n            value={currentFile}\n            onChange={(e) => setCurrentFile(e.target.value)}\n          ></input>\n          <DropdownButton\n            as={InputGroup.Append}\n            title={`.${currentFormat}`}\n            id=\"input-group-dropdown-1\"\n            className=\"raw-dropdown\"\n          >\n            {exportFormats.map((d) => {\n              return (\n                <Dropdown.Item key={d} onClick={() => setCurrentFormat(d)}>\n                  .{d}\n                </Dropdown.Item>\n              )\n            })}\n          </DropdownButton>\n        </InputGroup>\n      </div>\n\n      <div className=\"col col-sm-2\">\n        <button\n          className=\"btn btn-primary btn-block raw-btn\"\n          onClick={downloadViz}\n        >\n          Download\n        </button>\n      </div>\n    </div>\n  )\n}\n","/* eslint-disable no-restricted-globals */\nimport * as d3 from 'd3'\nimport * as rawgraphsCore from '@rawgraphs/rawgraphs-core'\nimport LRU from 'lru-cache'\n\nexport const NPM_CDN = 'https://cdn.jsdelivr.net/npm/'\n\n/**\n * NOTE: In a perfect we got type definition from core\n *\n * @typedef {{\n *  metadata: { id: string }\n * }} ChartContract\n */\n\nconst queue = []\nconst cacheChartsPkg = new LRU(50)\nconst cacheDependenciesTree = new LRU(400)\n\nconst DEPENDENCIES_ALIAS = {\n  d3,\n  '@rawgraphs/rawgraphs-core': rawgraphsCore,\n}\n\n/**\n * Reauire a dependency in the DOM Context and cache it\n *\n * @param {string} name\n */\nasync function requireDependency(name) {\n  if (DEPENDENCIES_ALIAS[name]) {\n    return DEPENDENCIES_ALIAS[name]\n  }\n  let url\n  try {\n    url = new URL(name)\n  } catch (e) {\n    url = new URL(`${NPM_CDN}${name}`)\n  }\n  const sUrl = url.toString()\n  if (cacheDependenciesTree.has(sUrl)) {\n    return cacheDependenciesTree.get(sUrl)\n  }\n  const v = await requireFromUrl(sUrl.toString())\n  if (v) {\n    cacheDependenciesTree.set(sUrl, v)\n  }\n  return v\n}\n\n/**\n * AMD Define for the DOM Context\n */\nfunction defineDOM(...params) {\n  /**\n   * @type {(dependencies: string[]) void}\n   */\n  let factory\n  /**\n   * @type string[]\n   */\n  let dependencies\n  // Adjust various AMD callding patterhns\n  if (params.length < 2) {\n    factory = params[0]\n    dependencies = []\n  } else {\n    if (params.length >= 3) {\n      params = params.slice(1)\n    }\n    dependencies = params[0]\n    factory = params[1]\n  }\n  // Instance dependencies\n  const exports = {}\n  const module = { exports }\n  const rutimeDepenciesPromises = dependencies.map((dep) =>\n    dep === 'exports'\n      ? Promise.resolve(exports)\n      : dep === 'module'\n      ? Promise.resolve(module)\n      : requireDependency(dep)\n  )\n  queue.push(\n    Promise.all(rutimeDepenciesPromises).then((rutimeDepencies) => {\n      // Run factory ... This will (maybe) write into exports\n      const outFactory = factory(...rutimeDepencies)\n      if (\n        !dependencies.includes('exports') &&\n        !dependencies.includes('module') &&\n        outFactory\n      ) {\n        // NOTE: In this case the factory return module\n        return outFactory\n      }\n      // Push filled exports\n      return exports\n    })\n  )\n}\n\ndefineDOM.amd = {}\n\n/**\n * Reauire a dependency in Web Worker Context\n *\n * @param {string} name\n */\nfunction requireDependencyWebWorker(name) {\n  if (DEPENDENCIES_ALIAS[name]) {\n    return DEPENDENCIES_ALIAS[name]\n  }\n  let url\n  try {\n    url = new URL(name)\n  } catch (e) {\n    url = new URL(`${NPM_CDN}${name}`)\n  }\n  const sUrl = url.toString()\n  if (cacheDependenciesTree.has(sUrl)) {\n    return cacheDependenciesTree.get(sUrl)\n  }\n  const v = requireFromUrlWebWorker(sUrl.toString())\n  if (v) {\n    cacheDependenciesTree.set(sUrl, v)\n  }\n  return v\n}\n\n/**\n * AMD Define for the WebWorker Context\n */\nfunction defineWebWorker(...params) {\n  /**\n   * @type {(dependencies: string[]) void}\n   */\n  let factory\n  /**\n   * @type string[]\n   */\n  let dependencies\n  // Adjust various AMD callding patterhns\n  if (params.length < 2) {\n    factory = params[0]\n    dependencies = []\n  } else {\n    if (params.length >= 3) {\n      params = params.slice(1)\n    }\n    dependencies = params[0]\n    factory = params[1]\n  }\n  // Instance dependencies\n  const exports = {}\n  const module = { exports }\n  const rutimeDepencies = dependencies.map((dep) =>\n    dep === 'exports'\n      ? exports\n      : dep === 'module'\n      ? module\n      : requireDependencyWebWorker(dep)\n  )\n  // Run factory ... This will (maybe) write into exports\n  const outFactory = factory(...rutimeDepencies)\n  if (\n    !dependencies.includes('exports') &&\n    !dependencies.includes('module') &&\n    outFactory\n  ) {\n    // NOTE: In this case the factory return module\n    queue.push(outFactory)\n  } else {\n    queue.push(exports)\n  }\n}\ndefineWebWorker.amd = {}\n\n/**\n * Require from URL in the DOM\n *\n * @param {string} url\n */\nfunction requireFromUrl(url) {\n  return new Promise((resolve, reject) => {\n    window.define = defineDOM\n    const scriptTag = document.createElement('script')\n    scriptTag.src = url\n    scriptTag.async = true\n    scriptTag.addEventListener(\n      'load',\n      () => {\n        // Pop last exports\n        const promiseFinalExports = queue.pop()\n        if (!promiseFinalExports) {\n          reject(`Problem during the execution of ${url}`)\n          return\n        }\n        return promiseFinalExports\n          .then(() => {\n            scriptTag.remove()\n            resolve(promiseFinalExports)\n          })\n          .catch((err) => {\n            scriptTag.remove()\n            reject(err)\n          })\n      },\n      {\n        once: true,\n      }\n    )\n    scriptTag.addEventListener(\n      'error',\n      () => {\n        scriptTag.remove()\n        reject(`Cannot import url ${url}`)\n      },\n      {\n        once: true,\n      }\n    )\n    document.head.append(scriptTag)\n  })\n}\n\nfunction isRawChartLike(obj) {\n  if (typeof obj === 'object' && obj !== null) {\n    return (\n      typeof obj.render === 'function' && typeof obj.metadata.id === 'string'\n    )\n  }\n  return false\n}\n\n/**\n * @param {string} url\n * @returns {Promise<ChartContract[]>}\n */\nexport async function requireRawChartsFromUrl(url) {\n  if (cacheChartsPkg.get(url)) {\n    return Promise.resolve(cacheChartsPkg.get(url))\n  }\n  const daExports = await requireFromUrl(url)\n  if (!daExports) {\n    return []\n  }\n  const charts = Object.values(daExports).filter(isRawChartLike)\n  // NOTE: Cache only relevant exports ...\n  if (charts.length > 0) {\n    cacheChartsPkg.set(url, charts)\n  }\n  return charts\n}\n\n/**\n * @param {string} url\n * @returns {ChartContract[]}\n */\nexport function requireRawChartsFromUrlWebWorker(url) {\n  if (cacheChartsPkg.get(url)) {\n    return cacheChartsPkg.get(url)\n  }\n  const daExports = requireFromUrlWebWorker(url)\n  if (!daExports) {\n    return []\n  }\n  const charts = Object.values(daExports).filter(isRawChartLike)\n  // NOTE: Cache only relevant exports ...\n  if (charts.length > 0) {\n    cacheChartsPkg.set(url, charts)\n  }\n  return charts\n}\n\n/**\n * Require from url in WebWorker context\n *\n * @param {string} url\n */\nfunction requireFromUrlWebWorker(url) {\n  self.define = defineWebWorker\n  self.importScripts(url)\n  const finalExports = queue.pop()\n  return finalExports\n}\n","import { useCallback, useEffect, useState } from 'react'\nimport { sha3_512 } from 'js-sha3'\nimport difference from 'lodash/difference'\nimport uniq from 'lodash/uniq'\nimport find from 'lodash/find'\nimport { requireRawChartsFromUrl, NPM_CDN } from './rawRequire'\nimport './chart-types'\n\nconst STORE_NS = 'rawCustomCharts'\n\n/**\n * @param {CustomChartContract[]} prevCharts\n * @param {CustomChartContract[]} newChartsToInject\n * @returns {[CustomChartContract[],CustomChartContract[]]}\n */\nfunction getNextCustomChartsAndReleased(prevCharts, newChartsToInject) {\n  const newIds = newChartsToInject.map((c) => c.metadata.id)\n  const releasedCustomCharts = []\n  const nextCustomCharts = prevCharts\n    .filter((prevChart) => {\n      const shouldBeReleased = newIds.includes(prevChart.metadata.id)\n      if (shouldBeReleased) {\n        releasedCustomCharts.push(prevChart)\n      }\n      return !shouldBeReleased\n    })\n    .concat(newChartsToInject)\n  return [nextCustomCharts, releasedCustomCharts]\n}\n\n/**\n * @param {CustomChartContract[]} nextCustomCharts\n */\nasync function storeCustomCharts(nextCustomCharts) {\n  const toStoreCustomCharts = nextCustomCharts.map((chart) => ({\n    id: chart.metadata.id,\n    source: chart.rawCustomChart.source,\n  }))\n  localStorage.setItem(STORE_NS, JSON.stringify(toStoreCustomCharts))\n  const cache = await window.caches.open(STORE_NS)\n  const nextHashses = toStoreCustomCharts\n    .map((chart) =>\n      chart.source.indexOf('file:') === 0\n        ? chart.source.replace('file:', '')\n        : null\n    )\n    .filter(Boolean)\n  const cacheKeys = await cache.keys()\n  const currentHashses = cacheKeys.map((k) => k.url.split('/').slice(-1)[0])\n  const toRemoveHashes = difference(currentHashses, nextHashses)\n  await Promise.all(toRemoveHashes.map((hash) => cache.delete('/' + hash)))\n}\n\n/**\n * @param {File} file\n * @returns {Promise<string>}\n */\nfunction makeFileHash(file) {\n  return new Promise((resolve) => {\n    const reader = new FileReader()\n    reader.onload = function (event) {\n      resolve(sha3_512(event.target.result))\n    }\n    reader.readAsArrayBuffer(file)\n  })\n}\n\nasync function loadStoredCustomCharts() {\n  /**\n   * @type {StoredCustomChart[]}\n   */\n  const storedCustomCharts = JSON.parse(localStorage.getItem(STORE_NS) ?? '[]')\n  const cache = await window.caches.open(STORE_NS)\n\n  // Calculate an unique list of sources to load\n  // It also read caches storage and create a browser url for file sources\n  const packsToLoad = await Promise.all(\n    uniq(storedCustomCharts.map((chart) => chart.source)).map(\n      /**\n       * @param {string} source\n       * @returns {Promise<{ source: string, url: string } | null>}\n       */\n      (source) => {\n        if (source.indexOf('file:') === 0) {\n          return cache.match('/' + source.replace('file:', '')).then((m) => {\n            if (!m) {\n              return Promise.resolve(null)\n            }\n            return m.blob().then((b) => ({\n              source,\n              url: URL.createObjectURL(b),\n            }))\n          })\n        }\n        if (source.indexOf('url:') === 0) {\n          return Promise.resolve({\n            source,\n            url: source.replace('url:', ''),\n          })\n        }\n        if (source.indexOf('npm:') === 0) {\n          return Promise.resolve({\n            source,\n            url: NPM_CDN + source.replace('npm:', ''),\n          })\n        }\n        return Promise.resolve(null)\n      }\n    )\n  ).then((packs) => packs.filter(Boolean))\n\n  const loadedChartsById = await Promise.all(\n    packsToLoad.map((p) =>\n      requireRawChartsFromUrl(p.url).then((charts) =>\n        charts.map((chart) => ({\n          ...chart,\n          rawCustomChart: p,\n        }))\n      )\n    )\n  ).then((nChars) => {\n    /**\n     * @type {Record<string, CustomChartContract>}\n     */\n    const by = {}\n    return nChars.reduce((o, charts) => {\n      charts.forEach((c) => {\n        o[c.metadata.id] = c\n      })\n      return o\n    }, by)\n  })\n\n  return storedCustomCharts.map((c) => loadedChartsById[c.id]).filter(Boolean)\n}\n\nasync function exportCustomChart(chart) {\n  if (!chart.rawCustomChart) {\n    // Not a custom chart\n    return null\n  }\n  const { source } = chart.rawCustomChart\n  if (source.indexOf('file:') === 0) {\n    const cache = await window.caches.open(STORE_NS)\n    const hash = source.replace('file:', '')\n    const result = await cache.match(`/${hash}`)\n    if (!result) {\n      throw new Error(`File not found: ${hash}`)\n    }\n    const content = await result.text()\n    return {\n      source,\n      content,\n    }\n  }\n  return {\n    source,\n  }\n}\n\n/**\n * This hook handle the custom user charts.\n * It's business is to load custom charts from some `source`:\n *  - `file:hash` File source we hash the file content to identify \"which\" file\n *  - `url:cdn_url` An url that point to a js file bundled as UMD | AMD\n *  - `npm:name` A valid package name on npm registry bundled also as UMD | AMD\n *\n * It loads the current custom charts on mount from user storage and sync\n * them when you call its methods.\n *\n * @param {{ storage: boolean }}\n * @returns {[CustomChartContract[], {\n *  uploadCustomCharts: (file?: File, mode?:  'replace' | 'add') => Promise<CustomChartContract[]>\n *  loadCustomChartsFromUrl: (url: string) => Promise<CustomChartContract[]>\n *  loadCustomChartsFromNpm: (name: string) => Promise<CustomChartContract[]>\n *  importCustomChartFromProject: (projectChart: CustomChartContract) => Promise<CustomChartContract>\n *  removeCustomChart: (chart: CustomChartContract) => Promise<CustomChartContract[]>\n *  exportCustomChart: (chart: CustomChartContract) => Promise<{ source: string, content: string | null }>\n * }]}\n */\nexport default function useCustomCharts({ storage = true } = { storage: true }) {\n  const [customCharts, setCustomCharts] = useState([])\n\n  // Loads custom charts saved in user storage\n  useEffect(() => {\n    if (storage) {\n      loadStoredCustomCharts().then(setCustomCharts)\n    }\n  }, [storage])\n\n  const loadCustomChartsFromUrlAsSource = useCallback(\n    async (source, url) => {\n      let newChartsToInject = await requireRawChartsFromUrl(url)\n      if (newChartsToInject.length === 0) {\n        return\n      }\n      newChartsToInject = newChartsToInject.map((chart) => ({\n        ...chart,\n        rawCustomChart: {\n          source,\n          url,\n        },\n      }))\n      const [\n        nextCustomCharts,\n        releasedCustomCharts,\n      ] = getNextCustomChartsAndReleased(customCharts, newChartsToInject)\n      releasedCustomCharts.forEach((c) => {\n        URL.revokeObjectURL(c.rawCustomChart.url)\n      })\n      setCustomCharts(nextCustomCharts)\n      if (storage) {\n        await storeCustomCharts(nextCustomCharts)\n      }\n      return nextCustomCharts\n    },\n    [customCharts, storage]\n  )\n\n  const loadCustomChartsFromUrl = useCallback(\n    async (url) => {\n      const source = `url:${url}`\n      return loadCustomChartsFromUrlAsSource(source, url)\n    },\n    [loadCustomChartsFromUrlAsSource]\n  )\n\n  const loadCustomChartsFromNpm = useCallback(\n    async (name) => {\n      const source = `npm:${name}`\n      const url = NPM_CDN + name\n      return loadCustomChartsFromUrlAsSource(source, url)\n    },\n    [loadCustomChartsFromUrlAsSource]\n  )\n\n  const uploadCustomCharts = useCallback(\n    async (file, mode = 'add') => {\n      if (!file) {\n        return []\n      }\n      const url = URL.createObjectURL(file)\n      let newChartsToInject = await requireRawChartsFromUrl(url)\n      if (newChartsToInject.length === 0) {\n        return\n      }\n      const fileHash = await makeFileHash(file)\n      const source = `file:${fileHash}`\n      newChartsToInject = newChartsToInject.map((chart) => ({\n        ...chart,\n        rawCustomChart: {\n          source,\n          url,\n        },\n      }))\n      const [nextCustomCharts, releasedCustomCharts] =\n        mode === 'replace'\n          ? [newChartsToInject, customCharts]\n          : getNextCustomChartsAndReleased(customCharts, newChartsToInject)\n      releasedCustomCharts.forEach((c) => {\n        URL.revokeObjectURL(c.rawCustomChart.url)\n      })\n      setCustomCharts(nextCustomCharts)\n      if (storage) {\n        const cache = await window.caches.open(STORE_NS)\n        await cache.put(fileHash, new Response(file))\n        await storeCustomCharts(nextCustomCharts)\n      }\n      return nextCustomCharts\n    },\n    [customCharts, storage]\n  )\n\n  const importCustomChartFromProject = useCallback(\n    async (projectChart) => {\n      const { source, content } = projectChart.rawCustomChart\n      let url, file, fileHash\n      if (source.indexOf('url:') === 0) {\n        url = source.replace('url:', '')\n      } else if (source.indexOf('npm:') === 0) {\n        url = NPM_CDN + source.replace('npm:', '')\n      } else if (source.indexOf('file:') === 0) {\n        fileHash = source.replace('file:', '')\n        file = new File([content], `${fileHash}.js`, {\n          type: 'application/json',\n        })\n        url = URL.createObjectURL(file)\n      } else {\n        throw new Error(`Try to import invalid source ${source}`)\n      }\n      const newChartsToInject = await requireRawChartsFromUrl(url)\n      let newChart = find(\n        newChartsToInject,\n        (c) => c.metadata.id === projectChart.metadata.id\n      )\n      if (!newChart) {\n        throw new Error(\n          `Can't find chart ${projectChart.metadata.id} from ${source}`\n        )\n      }\n      newChart = {\n        ...newChart,\n        rawCustomChart: {\n          source,\n          url,\n        },\n      }\n      const [\n        nextCustomCharts,\n        releasedCustomCharts,\n      ] = getNextCustomChartsAndReleased(customCharts, [newChart])\n      releasedCustomCharts.forEach((c) => {\n        URL.revokeObjectURL(c.rawCustomChart.url)\n      })\n      setCustomCharts(nextCustomCharts)\n      if (storage) {\n        if (file) {\n          const cache = await window.caches.open(STORE_NS)\n          await cache.put(fileHash, new Response(file))\n        }\n        await storeCustomCharts(nextCustomCharts)\n      }\n      return newChart\n    },\n    [customCharts, storage]\n  )\n\n  const removeCustomChart = useCallback(\n    async (chart) => {\n      const nextCustomCharts = customCharts.filter(\n        (c) => c.metadata.id !== chart.metadata.id\n      )\n      setCustomCharts(nextCustomCharts)\n      if (storage) {\n        await storeCustomCharts(nextCustomCharts)\n      }\n      return nextCustomCharts\n    },\n    [customCharts, storage]\n  )\n\n  return [\n    customCharts,\n    {\n      uploadCustomCharts,\n      removeCustomChart,\n      loadCustomChartsFromUrl,\n      loadCustomChartsFromNpm,\n      exportCustomChart,\n      importCustomChartFromProject,\n    },\n  ]\n}\n","import { useCallback, useState } from 'react'\nimport useCustomCharts from './useCustomCharts'\nimport './chart-types'\n\n// NOTE: ... FUTURE PALCE 2 RAW APPROVED CHARTS FROM USERS <3\n// At this point we can mark some npm accounts or special cdn hosts to have secure\n// and quailty raw charts ... so we can then skip the security advisor\n\nconst HOSTS_WHITELIST = ['localhost']\n\n/**\n * @param {URL} url\n */\nfunction isUrlAllowed(url) {\n  if (HOSTS_WHITELIST.includes(url.hostname)) {\n    return true\n  }\n  return false\n}\n\n/**\n * @param {string} name\n */\nfunction isNpmPkgAllowed(name) {\n  return false\n}\n\nclass UserAbortError extends Error {\n  constructor(...args) {\n    super(...args)\n    this.isAbortByUser = true\n  }\n}\n\n/**\n * @returns {[CustomChartContract[], {\n *  toConfirmCustomChart: null\n *  | { type: 'npm', value: string }\n *  | { type: 'url', value: url }\n *  | { type: 'file', value: File }\n *  | { type: 'project', value: CustomChartContract }\n *  uploadCustomCharts: (file?: File) => Promise<CustomChartContract[]>\n *  loadCustomChartsFromUrl: (url: string) => Promise<CustomChartContract[]>\n *  loadCustomChartsFromNpm: (name: string) => Promise<CustomChartContract[]>\n *  importCustomChartFromProject: (projectChart: CustomChartContract) => Promise<CustomChartContract>\n *  removeCustomChart: (chart: CustomChartContract) => Promise<CustomChartContract[]>\n *  exportCustomChart: (chart: CustomChartContract) => Promise<{ source: string, content: string | null }>\n *  confirmCustomChartLoad: () => void\n *  abortCustomChartLoad: () => void\n * }]}\n */\nexport default function useSafeCustomCharts() {\n  const [\n    customCharts,\n    {\n      uploadCustomCharts: unsafeUploadCustomCharts,\n      loadCustomChartsFromNpm: unsafeLoadCustomChartsFromNpm,\n      loadCustomChartsFromUrl: unsafeLoadCustomChartsFromUrl,\n      importCustomChartFromProject: unsafeImportCustomChartFromProject,\n      ...methods\n    },\n  ] = useCustomCharts()\n\n  const [toConfirmCustomChart, setToConfirmCustomChartLoad] = useState(null)\n\n  const loadCustomChartsFromUrl = useCallback(\n    (url) => {\n      let parsedUrl\n      try {\n        parsedUrl = new URL(url)\n      } catch (err) {\n        // Invalid url\n        return Promise.resolve([])\n      }\n      if (isUrlAllowed(parsedUrl)) {\n        return unsafeLoadCustomChartsFromUrl(String(parsedUrl))\n      } else {\n        return new Promise((resolve, reject) => {\n          setToConfirmCustomChartLoad({\n            type: 'url',\n            value: String(parsedUrl),\n            resolve,\n            reject,\n          })\n        })\n      }\n    },\n    [unsafeLoadCustomChartsFromUrl]\n  )\n\n  const loadCustomChartsFromNpm = useCallback(\n    (inputName) => {\n      const name = inputName.trim()\n      if (name.trim() === '') {\n        return\n      }\n      if (isNpmPkgAllowed(name)) {\n        unsafeLoadCustomChartsFromNpm(name)\n      } else {\n        return new Promise((resolve, reject) => {\n          setToConfirmCustomChartLoad({\n            type: 'npm',\n            value: name,\n            resolve,\n            reject,\n          })\n        })\n      }\n    },\n    [unsafeLoadCustomChartsFromNpm]\n  )\n\n  const uploadCustomCharts = useCallback((file) => {\n    return new Promise((resolve, reject) => {\n      setToConfirmCustomChartLoad({\n        type: 'file',\n        value: file,\n        resolve,\n        reject,\n      })\n    })\n  }, [])\n\n  const importCustomChartFromProject = useCallback(\n    (projectChart) => {\n      const { source } = projectChart.rawCustomChart\n      let askConfirm = false\n      if (source.indexOf('url:') === 0) {\n        if (!isUrlAllowed(new URL(source.replace('url:', '')))) {\n          askConfirm = true\n        }\n      } else if (source.indexOf('npm:') === 0) {\n        if (!isNpmPkgAllowed(source.replace('npm:', ''))) {\n          askConfirm = true\n        }\n      } else if (source.indexOf('file:') === 0) {\n        askConfirm = true\n      }\n      if (askConfirm) {\n        return new Promise((resolve, reject) => {\n          setToConfirmCustomChartLoad({\n            type: 'project',\n            value: projectChart,\n            resolve,\n            reject,\n          })\n        })\n      } else {\n        return unsafeImportCustomChartFromProject(projectChart)\n      }\n    },\n    [unsafeImportCustomChartFromProject]\n  )\n\n  const confirmCustomChartLoad = useCallback(() => {\n    const { type, value, resolve, reject } = toConfirmCustomChart\n    if (type === 'file') {\n      unsafeUploadCustomCharts(value).then(resolve, reject)\n    } else if (type === 'url') {\n      unsafeLoadCustomChartsFromUrl(value).then(resolve, reject)\n    } else if (type === 'npm') {\n      unsafeLoadCustomChartsFromNpm(value).then(resolve, reject)\n    } else if (type === 'project') {\n      unsafeImportCustomChartFromProject(value).then(resolve, reject)\n    }\n    setToConfirmCustomChartLoad(null)\n  }, [\n    toConfirmCustomChart,\n    unsafeImportCustomChartFromProject,\n    unsafeLoadCustomChartsFromNpm,\n    unsafeLoadCustomChartsFromUrl,\n    unsafeUploadCustomCharts,\n  ])\n\n  const abortCustomChartLoad = useCallback(() => {\n    if (toConfirmCustomChart) {\n      toConfirmCustomChart.reject(new UserAbortError())\n    }\n    setToConfirmCustomChartLoad(null)\n  }, [toConfirmCustomChart])\n\n  return [\n    customCharts,\n    {\n      toConfirmCustomChart,\n      abortCustomChartLoad,\n      confirmCustomChartLoad,\n      uploadCustomCharts,\n      loadCustomChartsFromUrl,\n      loadCustomChartsFromNpm,\n      importCustomChartFromProject,\n      ...methods,\n    },\n  ]\n}\n","import classNames from 'classnames'\nimport React, { memo, useState } from 'react'\nimport { Button, Modal } from 'react-bootstrap'\nimport { useDropzone } from 'react-dropzone'\nimport { BsCloud, BsUpload } from 'react-icons/bs'\nimport styles from './CustomChartLoader.module.scss'\n\nfunction LoadFromFile({ loading, load }) {\n  function onDrop(acceptedFiles) {\n    if (acceptedFiles.length) {\n      load(acceptedFiles[0])\n    }\n  }\n  const {\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccept,\n  } = useDropzone({\n    disabled: loading,\n    onDrop,\n    accept: 'text/plain,text/javascript,.js',\n    maxFiles: 1,\n  })\n  return (\n    <div\n      className={classNames(styles.dropzone, {\n        [styles.reject]: isDragReject,\n        [styles.accept]: isDragAccept,\n      })}\n      {...getRootProps()}\n    >\n      <input {...getInputProps()} />\n      <span>Drag a file here or </span>\n      <Button className={styles['browse-button']} color=\"primary\">\n        Browse\n      </Button>\n      <span>a file from your computer</span>\n      <div className={styles.dropin}>\n        {isDragAccept && <p>All files will be accepted</p>}\n        {isDragReject && <p>Some files will be rejected</p>}\n      </div>\n    </div>\n  )\n}\n\nfunction LoadFromString({ load, loading, placeholder }) {\n  const [value, setValue] = useState('')\n  return (\n    <form\n      onSubmit={(e) => {\n        e.preventDefault()\n        load(value)\n      }}\n    >\n      <input\n        disabled={loading}\n        className=\"form-control mb-2\"\n        placeholder={placeholder}\n        type=\"text\"\n        value={value}\n        onChange={(e) => setValue(e.target.value)}\n      />\n      <div className=\"text-right\">\n        <button\n          type=\"submit\"\n          disabled={value.trim() === '' || loading}\n          className=\"btn btn-primary\"\n          onClick={() => {}}\n        >\n          Load your chart\n        </button>\n      </div>\n    </form>\n  )\n}\n\nfunction CustomChartLoaderForm({\n  uploadCustomCharts,\n  loadCustomChartsFromUrl,\n  loadCustomChartsFromNpm,\n  onClose,\n}) {\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(null)\n  const [type, setType] = useState('file')\n\n  function handleError(e) {\n    setLoading(false)\n    if (e.isAbortByUser) {\n      return\n    }\n    console.log(e)\n    setError(e)\n  }\n\n  function changeImportType(type) {\n    setError(null)\n    setType(type)\n  }\n\n  return (\n    <div className=\"row\" style={{ minHeight: 300 }}>\n      <div className=\"col-md-4\">\n        <div\n          onClick={() => {\n            changeImportType('file')\n          }}\n          className={classNames(\n            'd-flex align-items-center cursor-pointer',\n            styles.loadingOption,\n            {\n              [styles.active]: type === 'file',\n            }\n          )}\n        >\n          <BsUpload className=\"w-25\" />\n          <h4 className=\"m-0 d-inline-block\">Load from file</h4>\n        </div>\n        <div\n          onClick={() => changeImportType('url')}\n          className={classNames(\n            'd-flex align-items-center cursor-pointer',\n            styles.loadingOption,\n            {\n              [styles.active]: type === 'url',\n            }\n          )}\n        >\n          <BsCloud className=\"w-25\" />\n          <h4 className=\"m-0 d-inline-block\">Import from URL</h4>\n        </div>\n        <div\n          onClick={() => changeImportType('npm')}\n          className={classNames(\n            'd-flex align-items-center cursor-pointer',\n            styles.loadingOption,\n            {\n              [styles.active]: type === 'npm',\n            }\n          )}\n        >\n          <BsCloud className=\"w-25\" />\n          <h4 className=\"m-0 d-inline-block\">Import from NPM</h4>\n        </div>\n      </div>\n      <div className=\"col-md-8\">\n        {type === 'npm' && (\n          <LoadFromString\n            loading={loading}\n            load={(pkg) => {\n              setError(null)\n              setLoading(true)\n              loadCustomChartsFromNpm(pkg).then(onClose, handleError)\n            }}\n            key=\"npm\"\n            placeholder={'Load UMD or AMD JS File from NPM'}\n          />\n        )}\n        {type === 'url' && (\n          <LoadFromString\n            loading={loading}\n            load={(url) => {\n              setError(null)\n              setLoading(true)\n              loadCustomChartsFromUrl(url).then(onClose, handleError)\n            }}\n            key=\"url\"\n            placeholder={'Load UMD or AMD JS File from URL'}\n          />\n        )}\n        {type === 'file' && (\n          <LoadFromFile\n            loading={loading}\n            load={(url) => {\n              setError(null)\n              setLoading(true)\n              uploadCustomCharts(url).then(onClose, handleError)\n            }}\n            key=\"url\"\n            placeholder={'Load UMD or AMD JS File from URL'}\n          />\n        )}\n        {error && (\n          <div className=\"alert alert-danger mt-2\">\n            Error during custom chart import\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction CustomChartLoader({ isOpen, onClose, ...props }) {\n  return (\n    <Modal\n      show={isOpen}\n      onHide={onClose}\n      backdrop=\"static\"\n      centered\n      size=\"lg\"\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      className=\"raw-modal\"\n      contentClassName=\"bg-white\"\n    >\n      <Modal.Header closeButton>\n        <Modal.Title>Load custom chart</Modal.Title>\n      </Modal.Header>\n\n      <Modal.Body>\n        <CustomChartLoaderForm {...props} onClose={onClose} />\n      </Modal.Body>\n      <Modal.Footer>\n        <div className='text-center w-100'>\n          Do you want to know how to create a custom chart?{' '}\n          <a href=\"https://rawgraphs.io\" target=\"_blank\" rel=\"noreferrer\">\n            Check our documentation\n          </a>\n        </div>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nexport default memo(CustomChartLoader)\n","import { Modal, Button } from 'react-bootstrap'\n\nexport default function CustomChartWarnModal({\n  toConfirmCustomChart,\n  abortCustomChartLoad,\n  confirmCustomChartLoad,\n}) {\n  return (\n    <Modal\n      show={toConfirmCustomChart !== null}\n      onHide={() => abortCustomChartLoad(null)}\n      backdrop=\"static\"\n      centered\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      className=\"raw-modal\"\n      contentClassName='border'\n    >\n      <Modal.Header closeButton>\n        <Modal.Title>Warning!</Modal.Title>\n      </Modal.Header>\n\n      <Modal.Body>\n        <p>\n          You are about to execute third party JavaScript continue at your own\n          risk.\n        </p>\n        {toConfirmCustomChart && toConfirmCustomChart.type === 'project' && (\n          <div\n            title={toConfirmCustomChart.value.rawCustomChart.source}\n            style={{\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              width: '100%',\n            }}\n          >\n            {toConfirmCustomChart.value.rawCustomChart.source}\n          </div>\n        )}\n      </Modal.Body>\n\n      <Modal.Footer className=\"d-flex justify-content-between\">\n        <Button\n          variant=\"light\"\n          onClick={() => {\n            abortCustomChartLoad()\n          }}\n        >\n          Don't execute\n        </Button>\n        <Button\n          variant=\"primary\"\n          onClick={() => {\n            confirmCustomChartLoad()\n          }}\n        >\n          Continue\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n","import React, { useState, useCallback, useMemo, useEffect, useRef } from 'react'\nimport {\n  getOptionsConfig,\n  getDefaultOptionsValues,\n  deserializeProject,\n} from '@rawgraphs/rawgraphs-core'\nimport HeaderItems from './HeaderItems'\nimport Header from './components/Header'\nimport Section from './components/Section'\nimport Footer from './components/Footer'\nimport ScreenSizeAlert from './components/ScreenSizeAlert'\nimport DataLoader from './components/DataLoader'\nimport ChartSelector from './components/ChartSelector'\nimport DataMapping from './components/DataMapping'\nimport ChartPreviewWithOptions from './components/ChartPreviewWIthOptions'\nimport Exporter from './components/Exporter'\nimport get from 'lodash/get'\nimport find from 'lodash/find'\nimport usePrevious from './hooks/usePrevious'\nimport { serializeProject } from '@rawgraphs/rawgraphs-core'\nimport baseCharts from './charts'\nimport useSafeCustomCharts from './hooks/useSafeCustomCharts'\nimport useDataLoader from './hooks/useDataLoader'\nimport isPlainObject from 'lodash/isPlainObject'\nimport CookieConsent from 'react-cookie-consent'\nimport CustomChartLoader from './components/CustomChartLoader'\nimport CustomChartWarnModal from './components/CustomChartWarnModal'\n\n// #TODO: i18n\n\nfunction App() {\n  const [\n    customCharts,\n    {\n      toConfirmCustomChart,\n      confirmCustomChartLoad,\n      abortCustomChartLoad,\n      uploadCustomCharts,\n      loadCustomChartsFromUrl,\n      loadCustomChartsFromNpm,\n      importCustomChartFromProject,\n      removeCustomChart,\n      exportCustomChart,\n    },\n  ] = useSafeCustomCharts()\n  const charts = useMemo(() => baseCharts.concat(customCharts), [customCharts])\n\n  const dataLoader = useDataLoader()\n  const {\n    userInput,\n    userData,\n    userDataType,\n    parseError,\n    unstackedData,\n    unstackedColumns,\n    data,\n    separator,\n    thousandsSeparator,\n    decimalsSeparator,\n    locale,\n    stackDimension,\n    dataSource,\n    loading,\n    hydrateFromSavedProject,\n  } = dataLoader\n\n  /* From here on, we deal with viz state */\n  const [currentChart, setCurrentChart] = useState(charts[0])\n  const [mapping, setMapping] = useState({})\n  const [visualOptions, setVisualOptions] = useState(() => {\n    const options = getOptionsConfig(charts[0]?.visualOptions)\n    return getDefaultOptionsValues(options)\n  })\n  const [rawViz, setRawViz] = useState(null)\n  const [mappingLoading, setMappingLoading] = useState(false)\n  const dataMappingRef = useRef(null)\n\n  const columnNames = useMemo(() => {\n    if (get(data, 'dataTypes')) {\n      return Object.keys(data.dataTypes)\n    }\n  }, [data])\n\n  const prevColumnNames = usePrevious(columnNames)\n  const clearLocalMapping = useCallback(() => {\n    if (dataMappingRef.current) {\n      dataMappingRef.current.clearLocalMapping()\n    }\n  }, [])\n\n  // NOTE: When we run the import we want to use the \"last\"\n  // version of importProject callback\n  const lasImportProjectRef = useRef()\n  useEffect(() => {\n    lasImportProjectRef.current = importProject\n  })\n  useEffect(() => {\n    const projectUrlStr = new URLSearchParams(window.location.search).get('url')\n    let projectUrl\n    try {\n      projectUrl = new URL(projectUrlStr)\n    } catch (e) {\n      // BAD URL\n      return\n    }\n    fetch(projectUrl)\n      .then((r) => (r.ok ? r.text() : Promise.reject(r)))\n      .then(\n        (projectStr) => {\n          const project = deserializeProject(projectStr, baseCharts)\n          const lastImportProject = lasImportProjectRef.current\n          if (lastImportProject) {\n            lastImportProject(project, true)\n          }\n        },\n        (err) => {\n          console.log(`Can't load ${projectUrl}`, err)\n        }\n      )\n  }, [])\n\n  //resetting mapping when column names changes (ex: separator change in parsing)\n  useEffect(() => {\n    if (prevColumnNames) {\n      if (!columnNames) {\n        setMapping({})\n        clearLocalMapping()\n      } else {\n        const prevCols = prevColumnNames.join('.')\n        const currentCols = columnNames.join('.')\n        if (prevCols !== currentCols) {\n          setMapping({})\n          clearLocalMapping()\n        }\n      }\n    }\n  }, [columnNames, prevColumnNames, clearLocalMapping])\n\n  // update current chart when the related custom charts change under the hood\n  // if the related custom chart is removed set the first chart\n  useEffect(() => {\n    if (currentChart.rawCustomChart) {\n      const currentCustom = find(\n        customCharts,\n        (c) => c.metadata.id === currentChart.metadata.id\n      )\n      if (!currentCustom) {\n        setCurrentChart(baseCharts[0])\n        return\n      }\n      if (\n        currentCustom.rawCustomChart.source !==\n        currentChart.rawCustomChart.source\n      ) {\n        setCurrentChart(currentCustom)\n      }\n    }\n  }, [customCharts, currentChart])\n\n  const handleChartChange = useCallback(\n    (nextChart) => {\n      setMapping({})\n      clearLocalMapping()\n      setCurrentChart(nextChart)\n      const options = getOptionsConfig(nextChart?.visualOptions)\n      setVisualOptions(getDefaultOptionsValues(options))\n      setRawViz(null)\n    },\n    [clearLocalMapping]\n  )\n\n  const exportProject = useCallback(async () => {\n    const customChart = await exportCustomChart(currentChart)\n    return serializeProject({\n      userInput,\n      userData,\n      userDataType,\n      parseError,\n      unstackedData,\n      unstackedColumns,\n      data,\n      separator,\n      thousandsSeparator,\n      decimalsSeparator,\n      locale,\n      stackDimension,\n      dataSource,\n      currentChart,\n      mapping,\n      visualOptions,\n      customChart,\n    })\n  }, [\n    currentChart,\n    data,\n    dataSource,\n    decimalsSeparator,\n    locale,\n    mapping,\n    parseError,\n    separator,\n    stackDimension,\n    thousandsSeparator,\n    userData,\n    userDataType,\n    userInput,\n    visualOptions,\n    unstackedColumns,\n    unstackedData,\n    exportCustomChart,\n  ])\n\n  // project import\n  const importProject = useCallback(\n    async (project, fromUrl) => {\n      let nextCurrentChart\n      if (project.currentChart.rawCustomChart) {\n        try {\n          nextCurrentChart = await importCustomChartFromProject(\n            project.currentChart\n          )\n        } catch (err) {\n          if (err.isAbortByUser) {\n            if (fromUrl) {\n              // NOTE: clean the url when the user abort loading custom js\n              window.history.replaceState(null, null, '/')\n            }\n            return\n          }\n          throw err\n        }\n      } else {\n        nextCurrentChart = project.currentChart\n      }\n      hydrateFromSavedProject(project)\n      setCurrentChart(nextCurrentChart)\n      setMapping(project.mapping)\n      // adding \"annotations\" for color scale:\n      // we annotate the incoming options values (complex ones such as color scales)\n      // to le the ui know they are coming from a loaded project\n      // so we don't have to re-evaluate defaults\n      // this is due to the current implementation of the color scale\n      const patchedOptions = { ...project.visualOptions }\n      Object.keys(patchedOptions).forEach((k) => {\n        if (isPlainObject(patchedOptions[k])) {\n          patchedOptions[k].__loaded = true\n        }\n      })\n      setVisualOptions(project.visualOptions)\n    },\n    [hydrateFromSavedProject, importCustomChartFromProject]\n  )\n\n  const [isModalCustomChartOpen, setModalCustomChartOpen] = useState(false)\n  const toggleModalCustomChart = useCallback(\n    () => setModalCustomChartOpen((o) => !o),\n    []\n  )\n\n  return (\n    <div className=\"App\">\n      <Header menuItems={HeaderItems} />\n      <CustomChartWarnModal\n        toConfirmCustomChart={toConfirmCustomChart}\n        confirmCustomChartLoad={confirmCustomChartLoad}\n        abortCustomChartLoad={abortCustomChartLoad}\n      />\n      <div className=\"app-sections\">\n        <Section title={`1. Load your data`} loading={loading}>\n          <DataLoader {...dataLoader} hydrateFromProject={importProject} />\n        </Section>\n        {data && (\n          <Section title=\"2. Choose a chart\">\n            <CustomChartLoader\n              isOpen={isModalCustomChartOpen}\n              onClose={toggleModalCustomChart}\n              loadCustomChartsFromNpm={loadCustomChartsFromNpm}\n              loadCustomChartsFromUrl={loadCustomChartsFromUrl}\n              uploadCustomCharts={uploadCustomCharts}\n            />\n            <ChartSelector\n              onAddChartClick={toggleModalCustomChart}\n              onRemoveCustomChart={removeCustomChart}\n              availableCharts={charts}\n              currentChart={currentChart}\n              setCurrentChart={handleChartChange}\n            />\n          </Section>\n        )}\n        {data && currentChart && (\n          <Section title={`3. Mapping`} loading={mappingLoading}>\n            <DataMapping\n              ref={dataMappingRef}\n              dimensions={currentChart.dimensions}\n              dataTypes={data.dataTypes}\n              mapping={mapping}\n              setMapping={setMapping}\n            />\n          </Section>\n        )}\n        {data && currentChart && (\n          <Section title=\"4. Customize\">\n            <ChartPreviewWithOptions\n              chart={currentChart}\n              dataset={data.dataset}\n              dataTypes={data.dataTypes}\n              mapping={mapping}\n              visualOptions={visualOptions}\n              setVisualOptions={setVisualOptions}\n              setRawViz={setRawViz}\n              setMappingLoading={setMappingLoading}\n            />\n          </Section>\n        )}\n        {data && currentChart && rawViz && (\n          <Section title=\"5. Export\">\n            <Exporter rawViz={rawViz} exportProject={exportProject} />\n          </Section>\n        )}\n        <Footer />\n        <CookieConsent\n          location=\"bottom\"\n          buttonText=\"Got it!\"\n          style={{ background: '#f5f5f5', color: '#646467' }}\n          buttonStyle={{\n            background: '#646467',\n            color: 'white',\n            fontSize: '13px',\n            borderRadius: '3px',\n            padding: '5px 20px',\n          }}\n          buttonClasses=\"btn btn-default btn-grey\"\n          acceptOnScroll={true}\n        >\n          This website uses Google Analytics to anonymously collect browsing\n          data.{' '}\n          <a\n            href=\"https://rawgraphs.io/privacy/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"ml-2 text-body border-bottom border-dark\"\n          >\n            Learn More\n          </a>\n        </CookieConsent>\n      </div>\n      <ScreenSizeAlert />\n    </div>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister()\n      })\n      .catch((error) => {\n        console.error(error.message)\n      })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.scss'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}